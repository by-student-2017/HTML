GULP potential parameter fitting&nbsp;<br />
(e.g., Mg2NiH4, C2/c, No.15) (test case)<br />
------------------------------------------------------------------------------<br />
Å° Nelder-Mead method<br />
<br />
1. nm.py<br />
----------<br />
from scipy import optimize<br />
import numpy as np<br />
import commands<br />
import sys<br />
<br />
file_tmp = &#39;mg2nih4_tmp.gin&#39;<br />
file_inp = &#39;mg2nih4_nm.gin&#39;<br />
file_out = &#39;mg2nih4_nm.got&#39;<br />
<br />
gulp_adress = &quot;$HOME/gulp-5.1/Src/gulp&quot;<br />
timeout_s &nbsp; = &quot;timeout -s 9 5s&quot; # kill command after 5 s<br />
<br />
output_file_name = &quot;nm_files&quot;<br />
commands.getoutput(&quot;rm -f -r &quot;+output_file_name)<br />
commands.getoutput(&quot;mkdir &quot;+output_file_name)<br />
count = 0<br />
<br />
select_limit_y = 1000<br />
#limit = 0.001<br />
<br />
keyword1 = &quot;Final&quot;<br />
keyword2 = &quot;cell&quot;<br />
target = [7.8827, 7.8827, 6.5006, 68.6808, 111.3192, 131.9938, 0.00001, 0.00001, 0.00001, 0.00001, 0.00001, 0.00001]<br />
y_str = [0,0,0,0,0,0,0,0,0,0,0,0] # initial data<br />
<br />
# fitting parameters<br />
x0 = [1.7583, 2.963, -1.044, 1079.8, 918.2, 5420.3, 0.25037, 0.24428, 0.24337, 5.04, 5.36, 38.78, 22.9] # initial data<br />
b1 = np.array([[1.5,2.2],[2.5,3.2],[-0.85,-1.43],[1000,1200],[800,1400],[5400,5500],[0.2,0.3],[0.2,0.3],[0.2,0.3],[0.2,0.3],[0,50],[0,50],[0,50],[0,50]]) # boundary<br />
<br />
def f(x):<br />
<br />
&nbsp; print &quot;------------------------&quot;<br />
&nbsp; global count<br />
&nbsp; count += 1<br />
&nbsp; print count<br />
<br />
&nbsp; global no_flag<br />
&nbsp; no_flag = 0<br />
<br />
&nbsp; fi = open(file_tmp,&#39;r&#39;)<br />
&nbsp; text = fi.read().replace(&#39;XXX0&#39;,str(x[0]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XXX1&#39;,str(x[1]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XXX2&#39;,str(x[2]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; xc3 = (-(x[0]*3*2/3+x[1]) - x[2]*4) / 4<br />
&nbsp; text = text.replace(&#39;XXX3&#39;,str(xc3).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XXX4&#39;,str(x[3]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XXX5&#39;,str(x[4]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XXX6&#39;,str(x[5]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XXX7&#39;,str(x[6]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XXX8&#39;,str(x[7]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XXX9&#39;,str(x[8]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XX10&#39;,str(x[9]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XX11&#39;,str(x[10]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XX12&#39;,str(x[11]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; #text = text.replace(&#39;XX12&#39;,&#39;0.0&#39;)<br />
&nbsp; text = text.replace(&#39;XX13&#39;,str(x[12]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; fi.close<br />
<br />
&nbsp; with open(file_inp,&#39;w&#39;) as f:<br />
&nbsp; &nbsp; print &gt;&gt; f, text<br />
<br />
&nbsp; commands.getoutput(timeout_s+&quot; &quot;+gulp_adress+&quot; &lt; &quot;+file_inp+&quot; &gt; &quot;+file_out)<br />
&nbsp; #commands.getoutput(&quot;cp -p &quot;+file_inp+&quot; ./&quot;+output_file_name+&quot;/&quot;+file_inp+&quot;.&quot;+str(count))<br />
&nbsp; #commands.getoutput(&quot;cp -p &quot;+file_out+&quot; ./&quot;+output_file_name+&quot;/&quot;+file_out+&quot;.&quot;+str(count))<br />
&nbsp; #commands.getoutput(&quot;cp -p &quot;+file_inp+&quot; ./&quot;+output_file_name+file_inp+&quot;.`date \&quot;+%Y%m%d_%H%M%S\&quot;`&quot;)<br />
&nbsp; #commands.getoutput(&quot;cp -p &quot;+file_out+&quot; ./&quot;+output_file_name+file_out+&quot;.`date \&quot;+%Y%m%d_%H%M%S\&quot;`&quot;)<br />
<br />
&nbsp; get_line = &quot;awk &#39;{if($1==\&quot;&quot;+keyword1+&quot;\&quot; &amp;&amp; $2==\&quot;&quot;+keyword2+&quot;\&quot;){printf \&quot;%i \&quot;,NR }else{}}&#39; &quot;+file_out<br />
&nbsp; line = commands.getoutput(get_line)<br />
&nbsp; #print line<br />
&nbsp; if (line == &quot;&quot;):<br />
&nbsp; &nbsp; #y_str[0] = 99.9<br />
&nbsp; &nbsp; #y_str[1] = 99.9<br />
&nbsp; &nbsp; #y_str[2] = 99.9<br />
&nbsp; &nbsp; #y_str[3] = 99.9<br />
&nbsp; &nbsp; #y_str[4] = 99.9<br />
&nbsp; &nbsp; #y_str[5] = 99.9<br />
&nbsp; &nbsp; #y_str[6] = 99.9<br />
&nbsp; &nbsp; #y_str[7] = 99.9<br />
&nbsp; &nbsp; #y_str[8] = 99.9<br />
&nbsp; &nbsp; #y_str[9] = 99.9<br />
&nbsp; &nbsp; #y_str[10] = 99.9<br />
&nbsp; &nbsp; #y_str[11] = 99.9<br />
&nbsp; &nbsp; y = 99999.9<br />
&nbsp; &nbsp; print &quot;time out or bad condition range&quot;<br />
&nbsp; else:<br />
&nbsp; &nbsp; commands.getoutput(&quot;cp -p &quot;+file_inp+&quot; ./&quot;+output_file_name+&quot;/&quot;+file_inp+&quot;.&quot;+str(count))<br />
&nbsp; &nbsp; commands.getoutput(&quot;cp -p &quot;+file_out+&quot; ./&quot;+output_file_name+&quot;/&quot;+file_out+&quot;.&quot;+str(count))<br />
&nbsp; &nbsp; line_list = line.rstrip().split(&quot; &quot;)<br />
&nbsp; &nbsp; #print line_list, len(line_list)<br />
&nbsp; &nbsp; a_line = int(line_list[0]) + 3<br />
&nbsp; &nbsp; b_line = int(line_list[0]) + 4<br />
&nbsp; &nbsp; c_line = int(line_list[0]) + 5<br />
&nbsp; &nbsp; alpha_line = int(line_list[0]) + 6<br />
&nbsp; &nbsp; beta_line &nbsp;= int(line_list[0]) + 7<br />
&nbsp; &nbsp; gamma_line = int(line_list[0]) + 8<br />
<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;a\&quot; &amp;&amp; NR==&quot;+str(a_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[0] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[0] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[0] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;b\&quot; &amp;&amp; NR==&quot;+str(b_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[1] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[1] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[1] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;c\&quot; &amp;&amp; NR==&quot;+str(c_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[2] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[2] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[2] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; #<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;alpha\&quot; &amp;&amp; NR==&quot;+str(alpha_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[3] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[3] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[3] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;beta\&quot; &amp;&amp; NR==&quot;+str(beta_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[4] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[4] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[4] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;gamma\&quot; &amp;&amp; NR==&quot;+str(gamma_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[5] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[5] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[5] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; #<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;a\&quot; &amp;&amp; NR==&quot;+str(a_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[6] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[6] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[6] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;b\&quot; &amp;&amp; NR==&quot;+str(b_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[7] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[7] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[7] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;c\&quot; &amp;&amp; NR==&quot;+str(c_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[8] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[8] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[8] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; #<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;alpha\&quot; &amp;&amp; NR==&quot;+str(alpha_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[9] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[9] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[9] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;beta\&quot; &amp;&amp; NR==&quot;+str(beta_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[10] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[10] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[10] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;gamma\&quot; &amp;&amp; NR==&quot;+str(gamma_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[11] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; print y_str<br />
&nbsp; &nbsp; if (y_str[11] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[11] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
<br />
&nbsp; &nbsp; y = 500*((float(y_str[0])-target[0])/target[0])**2 + 500*((float(y_str[1])-target[1])/target[1])**2 \<br />
&nbsp; &nbsp; + 500*((float(y_str[2])-target[2])/target[2])**2 + 50*((float(y_str[3])-target[3])/target[3])**2 \<br />
&nbsp; &nbsp; + 50*((float(y_str[4])-target[4])/target[4])**2 + 50*((float(y_str[5])-target[5])/target[5])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[6])-target[6])/target[6])**2 + ((float(y_str[7])-target[7])/target[7])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[8])-target[8])/target[7])**2 + ((float(y_str[9])-target[9])/target[9])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[10])-target[10])/target[8])**2 + ((float(y_str[11])-target[11])/target[11])**2<br />
<br />
&nbsp; &nbsp; if (y &lt; select_limit_y and no_flag == 0):<br />
&nbsp; &nbsp; &nbsp; commands.getoutput(&quot;cp - p &quot;+file_inp+&quot; ./&quot;+output_file_name+&quot;/&quot;+file_inp+&quot;.&quot;+str(count))<br />
&nbsp; &nbsp; &nbsp; commands.getoutput(&quot;cp - p &quot;+file_out+&quot; ./&quot;+output_file_name+&quot;/&quot;+file_out+&quot;.&quot;+str(count))<br />
<br />
&nbsp; print y, x<br />
&nbsp; print &quot;------------------------&quot;<br />
<br />
&nbsp; #if (y &lt; limit):<br />
&nbsp; # &nbsp;sys.exit()<br />
<br />
&nbsp; return y<br />
<br />
res = optimize.minimize(f,x0,method=&#39;Nelder-Mead&#39;,bounds=b1)<br />
#res = optimize.minimize(f,x0,method=&#39;TNC&#39;,bounds=b1)<br />
#res = optimize.minimize(f,x0,method=&#39;Powell&#39;,bounds=b1)<br />
#res = optimize.minimize(f,x0,method=&#39;BFGS&#39;,bounds=b1)<br />
----------<br />
2. sed -i &#39;s/\r//g&#39; nm.py<br />
&nbsp; (sudo apt install nkf)<br />
&nbsp; (nkf -Lu --in-place nm.py)<br />
3. python nm.py<br />
<br />
Åû Result<br />
------------------------<br />
------------------------<br />
1169<br />
[&#39;7.758624&#39;, &#39;7.758624&#39;, &#39;6.428473&#39;, &#39;65.514807&#39;, &#39;114.485193&#39;, &#39;129.054046&#39;, &#39;0.000001&#39;, &#39;0.000052&#39;, &#39;0.000004&#39;, &#39;0.000000&#39;, &#39;-0.000022&#39;, &#39;0.000000&#39;]<br />
31.5308042723 [ 1.75896425e+00 &nbsp;2.96068989e+00 -1.09385772e+00 &nbsp;1.08075177e+03<br />
&nbsp; 9.18068462e+02 &nbsp;5.42100704e+03 &nbsp;2.50644629e-01 &nbsp;2.44427695e-01<br />
&nbsp; 2.43457357e-01 &nbsp;5.04422367e+00 &nbsp;5.36111623e+00 &nbsp;3.87798335e+01<br />
&nbsp; 2.29198211e+01]<br />
------------------------<br />
------------------------<br />
-----(mg2nih4.gin)<br />
opti conp prop phon inten noden dispersion<br />
cell<br />
14.40202 6.41312 6.50056 90.0 113.4519 90.0<br />
frac<br />
Mg1 core &nbsp;0.234204 &nbsp; 0.015970 &nbsp; 0.411120 &nbsp;1.7589642503433833<br />
Mg2 core &nbsp;0.000000 &nbsp; 0.028663 &nbsp; 0.750000 &nbsp;1.7589642503433833<br />
Mg3 core &nbsp;0.000000 &nbsp; 0.468702 &nbsp; 0.250000 &nbsp;1.7589642503433833<br />
Ni1 core &nbsp;0.120511 &nbsp; 0.227824 &nbsp; 0.576894 &nbsp;2.960689891044044<br />
H1 &nbsp;core &nbsp;0.013040 &nbsp; 0.292296 &nbsp; 0.559006 &nbsp;-1.093857717396642<br />
H1 &nbsp;shel &nbsp;0.013040 &nbsp; 0.292296 &nbsp; 0.559006 &nbsp;-0.5257968805360607<br />
H2 &nbsp;core &nbsp;0.124405 &nbsp; 0.012577 &nbsp; 0.066741 &nbsp;-1.093857717396642<br />
H2 &nbsp;shel &nbsp;0.124405 &nbsp; 0.012577 &nbsp; 0.066741 &nbsp;-0.5257968805360607<br />
H3 &nbsp;core &nbsp;0.139242 &nbsp; 0.323081 &nbsp; 0.377111 &nbsp;-1.093857717396642<br />
H3 &nbsp;shel &nbsp;0.139242 &nbsp; 0.323081 &nbsp; 0.377111 &nbsp;-0.5257968805360607<br />
H4 &nbsp;core &nbsp;0.209100 &nbsp; 0.301371 &nbsp; 0.800247 &nbsp;-1.093857717396642<br />
H4 &nbsp;shel &nbsp;0.209100 &nbsp; 0.301371 &nbsp; 0.800247 &nbsp;-0.5257968805360607<br />
space<br />
15<br />
buck<br />
H1 shel Mg1 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H1 core Mg1 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H1 shel Mg2 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H1 core Mg2 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H1 shel Mg3 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H1 core Mg3 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
buck<br />
H2 shel Mg1 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H2 core Mg1 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H2 shel Mg2 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H2 core Mg2 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H2 shel Mg3 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H2 core Mg3 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
buck<br />
H3 shel Mg1 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H3 core Mg1 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H3 shel Mg2 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H3 core Mg2 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H3 shel Mg3 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H3 core Mg3 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
buck<br />
H4 shel Mg1 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H4 core Mg1 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H4 shel Mg2 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H4 core Mg2 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H4 shel Mg3 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
H4 core Mg3 core 1080.7517728128475 0.2506446287333741 &nbsp;5.044223666812158 0.0 12.800<br />
buck<br />
H1 shel Ni1 core 918.0684622310289 0.2444276951942239 &nbsp;5.361116228056132 0.0 12.800<br />
H1 core Ni1 core 918.0684622310289 0.2444276951942239 &nbsp;5.361116228056132 0.0 12.800<br />
H2 shel Ni1 core 918.0684622310289 0.2444276951942239 &nbsp;5.361116228056132 0.0 12.800<br />
H2 core Ni1 core 918.0684622310289 0.2444276951942239 &nbsp;5.361116228056132 0.0 12.800<br />
H3 shel Ni1 core 918.0684622310289 0.2444276951942239 &nbsp;5.361116228056132 0.0 12.800<br />
H3 core Ni1 core 918.0684622310289 0.2444276951942239 &nbsp;5.361116228056132 0.0 12.800<br />
H4 shel Ni1 core 918.0684622310289 0.2444276951942239 &nbsp;5.361116228056132 0.0 12.800<br />
H4 core Ni1 core 918.0684622310289 0.2444276951942239 &nbsp;5.361116228056132 0.0 12.800<br />
buck<br />
H1 shel H1 &nbsp;shel 5421.007044348081 0.24345735727422738 &nbsp;38.77983352045163 0.0 12.800<br />
H2 shel H2 &nbsp;shel 5421.007044348081 0.24345735727422738 &nbsp;38.77983352045163 0.0 12.800<br />
H3 shel H3 &nbsp;shel 5421.007044348081 0.24345735727422738 &nbsp;38.77983352045163 0.0 12.800<br />
H4 shel H4 &nbsp;shel 5421.007044348081 0.24345735727422738 &nbsp;38.77983352045163 0.0 12.800<br />
spring<br />
H1 &nbsp;22.919821099641606 0<br />
H2 &nbsp;22.919821099641606 0<br />
H3 &nbsp;22.919821099641606 0<br />
H4 &nbsp;22.919821099641606 0<br />
Ni1 999999.0 0<br />
Mg1 999999.0 0<br />
Mg2 999999.0 0<br />
Mg3 999999.0 0<br />
shrink<br />
4 4 4<br />
kpoints<br />
8 8 8<br />
dispersion 1 500<br />
0.0 0.0 0.0 to 0.5 0.5 0.5 to 0.0 0.0 0.5 to 0.0 0.0 0.0 to 0.5 0.0 0.0<br />
output phon mg2nih4<br />
-----<br />
2. ~/gulp-5.1/Src/gulp &lt; mg2nih4.gin | tee mg2nih4.got<br />
3. gnuplot<br />
&nbsp; set xzeroaxis<br />
&nbsp; set yrange[-50:1800]<br />
&nbsp; set arrow from 120,-50 to 120,1800 nohead<br />
&nbsp; set arrow from 215,-50 to 215,1800 nohead<br />
&nbsp; set arrow from 285,-50 to 285,1800 nohead<br />
&nbsp; set arrow from 425,-50 to 425,1800 nohead<br />
&nbsp; plot &quot;mg2nih4.disp&quot; w p pt 7 ps 0.1<br />
4. q<br />
5. gnuplot<br />
&nbsp; plot &quot;mg2nih4.dens&quot; w i<br />
6. q<br />
Å¶ Gamma - M - A - Gamma - V<br />
&nbsp; 0.0 0.0 0.0 to 0.5 0.5 0.5 to 0.0 0.0 0.5 to 0.0 0.0 0.0 to 0.5 0.0 0.0<br />
<br />
Åû Data: Mg2NiH4, C2/c, 15<br />
------------------------<br />
&nbsp; Primitive cell parameters : &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Full cell parameters :<br />
<br />
&nbsp; a = &nbsp; 7.8827 &nbsp; &nbsp;alpha = &nbsp;68.6808 &nbsp; &nbsp; &nbsp; a = &nbsp;14.4020 &nbsp; &nbsp;alpha = &nbsp;90.0000<br />
&nbsp; b = &nbsp; 7.8827 &nbsp; &nbsp;beta &nbsp;= 111.3192 &nbsp; &nbsp; &nbsp; b = &nbsp; 6.4131 &nbsp; &nbsp;beta &nbsp;= 113.4519<br />
&nbsp; c = &nbsp; 6.5006 &nbsp; &nbsp;gamma = 131.9938 &nbsp; &nbsp; &nbsp; c = &nbsp; 6.5006 &nbsp; &nbsp;gamma = &nbsp;90.0000<br />
------------------------<br />
<br />
Åû mgh2_tmp.gin<br />
-----<br />
opti conp #prop phon inten noden dispersion<br />
cell<br />
14.40202 6.41312 6.50056 90.0 113.4519 90.0<br />
frac<br />
Mg1 core &nbsp;0.234204 &nbsp; 0.015970 &nbsp; 0.411120 &nbsp;XXX0<br />
Mg2 core &nbsp;0.000000 &nbsp; 0.028663 &nbsp; 0.750000 &nbsp;XXX0<br />
Mg3 core &nbsp;0.000000 &nbsp; 0.468702 &nbsp; 0.250000 &nbsp;XXX0<br />
Ni1 core &nbsp;0.120511 &nbsp; 0.227824 &nbsp; 0.576894 &nbsp;XXX1<br />
H1 &nbsp;core &nbsp;0.013040 &nbsp; 0.292296 &nbsp; 0.559006 &nbsp;XXX2<br />
H1 &nbsp;shel &nbsp;0.013040 &nbsp; 0.292296 &nbsp; 0.559006 &nbsp;XXX3<br />
H2 &nbsp;core &nbsp;0.124405 &nbsp; 0.012577 &nbsp; 0.066741 &nbsp;XXX2<br />
H2 &nbsp;shel &nbsp;0.124405 &nbsp; 0.012577 &nbsp; 0.066741 &nbsp;XXX3<br />
H3 &nbsp;core &nbsp;0.139242 &nbsp; 0.323081 &nbsp; 0.377111 &nbsp;XXX2<br />
H3 &nbsp;shel &nbsp;0.139242 &nbsp; 0.323081 &nbsp; 0.377111 &nbsp;XXX3<br />
H4 &nbsp;core &nbsp;0.209100 &nbsp; 0.301371 &nbsp; 0.800247 &nbsp;XXX2<br />
H4 &nbsp;shel &nbsp;0.209100 &nbsp; 0.301371 &nbsp; 0.800247 &nbsp;XXX3<br />
space<br />
15<br />
buck<br />
H1 shel Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H1 core Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H1 shel Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H1 core Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H1 shel Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H1 core Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
buck<br />
H2 shel Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H2 core Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H2 shel Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H2 core Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H2 shel Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H2 core Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
buck<br />
H3 shel Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H3 core Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H3 shel Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H3 core Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H3 shel Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H3 core Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
buck<br />
H4 shel Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H4 core Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H4 shel Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H4 core Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H4 shel Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H4 core Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
buck<br />
H1 shel Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H1 core Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H2 shel Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H2 core Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H3 shel Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H3 core Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H4 shel Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H4 core Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
buck<br />
H1 shel H1 &nbsp;shel XXX6 XXX9 &nbsp;XX12 0.0 12.800<br />
H2 shel H2 &nbsp;shel XXX6 XXX9 &nbsp;XX12 0.0 12.800<br />
H3 shel H3 &nbsp;shel XXX6 XXX9 &nbsp;XX12 0.0 12.800<br />
H4 shel H4 &nbsp;shel XXX6 XXX9 &nbsp;XX12 0.0 12.800<br />
spring<br />
H1 &nbsp;XX13 0<br />
H2 &nbsp;XX13 0<br />
H3 &nbsp;XX13 0<br />
H4 &nbsp;XX13 0<br />
Ni1 999999.0 0<br />
Mg1 999999.0 0<br />
Mg2 999999.0 0<br />
Mg3 999999.0 0<br />
#shrink<br />
#4 4 4<br />
#kpoints<br />
#8 8 8<br />
#dispersion 1 500<br />
#0.0 0.0 0.0 to 0.5 0.5 0.5 to 0.0 0.0 0.5 to 0.0 0.0 0.0 to 0.5 0.0 0.0<br />
#output phon mg2nih4<br />
-----<br />
Å¶ Usually, cation (shel) - cation (shel) pairs are not defined.<br />
Å¶ spring: Core - Shel interaction [eV/A^2]. Larger this value, smallar electronic polarization.<br />
Å¶ Core (charge X[e]) has mass, shell(charge Y[e]). X+Y=valence(e.g., Oxygen -&gt; -2)<br />
------------------------------------------------------------------------------<br />
Å° baysian<br />
<br />
Å† baysian<br />
0. pip install bayesian-optimization<br />
1. baysian.py<br />
----------<br />
from bayes_opt import BayesianOptimization<br />
import numpy as np<br />
import commands<br />
import sys<br />
<br />
file_tmp = &#39;mg2nih4_tmp.gin&#39;<br />
file_inp = &#39;mg2nih4_b.gin&#39;<br />
file_out = &#39;mg2nih4_b.got&#39;<br />
<br />
gulp_adress = &quot;$HOME/gulp-5.1/Src/gulp&quot;<br />
timeout_s &nbsp; = &quot;timeout -s 9 5s&quot; # kill command after 5 s<br />
<br />
output_file_name = &quot;baysian_files&quot;<br />
commands.getoutput(&quot;rm -f -r &quot;+output_file_name)<br />
commands.getoutput(&quot;mkdir &quot;+output_file_name)<br />
<br />
select_limit_y = 1.0e-12<br />
<br />
keyword1 = &quot;Final&quot;<br />
keyword2 = &quot;cell&quot;<br />
target = [7.8827, 7.8827, 6.5006, 68.6808, 111.3192, 131.9938, 0.000001, 0.000001, 0.000001, 0.000001, 0.000001, 0.000001]<br />
y_str = [0,0,0,0,0,0,0,0,0,0,0,0] # initial data<br />
<br />
# fitting parameters<br />
x0 &nbsp;= &nbsp;1.75896<br />
x1 &nbsp;= &nbsp;2.96068<br />
X2 &nbsp;= -1.09386<br />
x3 &nbsp;= 1080.0<br />
x4 &nbsp;= &nbsp;918.0<br />
x5 &nbsp;= 5421.0<br />
x6 &nbsp;= &nbsp;0.25064<br />
x7 &nbsp;= &nbsp;0.24428<br />
x8 &nbsp;= &nbsp;0.24345<br />
x9 &nbsp;= &nbsp;5.04422<br />
x10 = &nbsp;5.36111<br />
x11 = 38.7798<br />
x12 = 22.2918<br />
pbounds = {<br />
&nbsp; &nbsp;&#39;x0&#39;: (1.6,1.9),<br />
&nbsp; &nbsp;&#39;x1&#39;: (2.5,3.0),<br />
&nbsp; &nbsp;&#39;x2&#39;: (-0.9,-1.2),<br />
&nbsp; &nbsp;&#39;x3&#39;: (1000,1100),<br />
&nbsp; &nbsp;&#39;x4&#39;: (800,1100),<br />
&nbsp; &nbsp;&#39;x5&#39;: (5400,5500),<br />
&nbsp; &nbsp;&#39;x6&#39;: (0.24,0.255),<br />
&nbsp; &nbsp;&#39;x7&#39;: (0.24,0.25),<br />
&nbsp; &nbsp;&#39;x8&#39;: (0.24,0.25),<br />
&nbsp; &nbsp;&#39;x9&#39;: (3,10),<br />
&nbsp; &#39;x10&#39;: (3,10),<br />
&nbsp; &#39;x11&#39;: (30,45),<br />
&nbsp; &#39;x12&#39;: (20,45),<br />
} # boundary<br />
<br />
count = 0<br />
<br />
def descripter(x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12):<br />
<br />
&nbsp; print &quot;------------------------&quot;<br />
&nbsp; global count<br />
&nbsp; count += 1<br />
&nbsp; #print count<br />
<br />
&nbsp; global no_flag<br />
&nbsp; no_flag = 0<br />
<br />
&nbsp; fi = open(file_tmp,&#39;r&#39;)<br />
&nbsp; text = fi.read().replace(&#39;XXX0&#39;,str(x0))<br />
&nbsp; text = text.replace(&#39;XXX1&#39;,str(x1))<br />
&nbsp; text = text.replace(&#39;XXX2&#39;,str(x2))<br />
&nbsp; xc3 = (-(x0*3*2/3+x1) - x2*4) / 4<br />
&nbsp; text = text.replace(&#39;XXX3&#39;,str(xc3))<br />
&nbsp; text = text.replace(&#39;XXX4&#39;,str(x3))<br />
&nbsp; text = text.replace(&#39;XXX5&#39;,str(x4))<br />
&nbsp; text = text.replace(&#39;XXX6&#39;,str(x5))<br />
&nbsp; text = text.replace(&#39;XXX7&#39;,str(x6))<br />
&nbsp; text = text.replace(&#39;XXX8&#39;,str(x7))<br />
&nbsp; text = text.replace(&#39;XXX9&#39;,str(x8))<br />
&nbsp; text = text.replace(&#39;XX10&#39;,str(x9))<br />
&nbsp; text = text.replace(&#39;XX11&#39;,str(x10))<br />
&nbsp; text = text.replace(&#39;XX12&#39;,str(x11))<br />
&nbsp; #text = text.replace(&#39;XX12&#39;,&#39;0.0&#39;)<br />
&nbsp; text = text.replace(&#39;XX13&#39;,str(x12))<br />
&nbsp; fi.close<br />
<br />
&nbsp; with open(file_inp,&#39;w&#39;) as f:<br />
&nbsp; &nbsp; print &gt;&gt; f, text<br />
<br />
&nbsp; commands.getoutput(timeout_s+&quot; &quot;+gulp_adress+&quot; &lt; &quot;+file_inp+&quot; &gt; &quot;+file_out)<br />
&nbsp; #commands.getoutput(&quot;cp -p &quot;+file_inp+&quot; ./&quot;+output_file_name+&quot;/&quot;+file_inp+&quot;.&quot;+str(count))<br />
&nbsp; #commands.getoutput(&quot;cp -p &quot;+file_out+&quot; ./&quot;+output_file_name+&quot;/&quot;+file_out+&quot;.&quot;+str(count))<br />
&nbsp; #commands.getoutput(&quot;cp -p &quot;+file_inp+&quot; ./&quot;+output_file_name+file_inp+&quot;.`date \&quot;+%Y%m%d_%H%M%S\&quot;`&quot;)<br />
&nbsp; #commands.getoutput(&quot;cp -p &quot;+file_out+&quot; ./&quot;+output_file_name+file_out+&quot;.`date \&quot;+%Y%m%d_%H%M%S\&quot;`&quot;)<br />
<br />
&nbsp; get_line = &quot;awk &#39;{if($1==\&quot;&quot;+keyword1+&quot;\&quot; &amp;&amp; $2==\&quot;&quot;+keyword2+&quot;\&quot;){printf \&quot;%i \&quot;,NR }else{}}&#39; &quot;+file_out<br />
&nbsp; line = commands.getoutput(get_line)<br />
&nbsp; #print line<br />
&nbsp; if (line == &quot;&quot;):<br />
&nbsp; &nbsp; #y_str[0] = 99.9<br />
&nbsp; &nbsp; #y_str[1] = 99.9<br />
&nbsp; &nbsp; #y_str[2] = 99.9<br />
&nbsp; &nbsp; #y_str[3] = 99.9<br />
&nbsp; &nbsp; #y_str[4] = 99.9<br />
&nbsp; &nbsp; #y_str[5] = 99.9<br />
&nbsp; &nbsp; #y_str[6] = 99.9<br />
&nbsp; &nbsp; #y_str[7] = 99.9<br />
&nbsp; &nbsp; #y_str[8] = 99.9<br />
&nbsp; &nbsp; #y_str[9] = 99.9<br />
&nbsp; &nbsp; #y_str[10] = 99.9<br />
&nbsp; &nbsp; #y_str[11] = 99.9<br />
&nbsp; &nbsp; y = 0.0<br />
&nbsp; &nbsp; print &quot;time out or bad condition range&quot;<br />
&nbsp; else:<br />
&nbsp; &nbsp; line_list = line.rstrip().split(&quot; &quot;)<br />
&nbsp; &nbsp; #print line_list, len(line_list)<br />
&nbsp; &nbsp; a_line = int(line_list[0]) + 3<br />
&nbsp; &nbsp; b_line = int(line_list[0]) + 4<br />
&nbsp; &nbsp; c_line = int(line_list[0]) + 5<br />
&nbsp; &nbsp; alpha_line = int(line_list[0]) + 6<br />
&nbsp; &nbsp; beta_line &nbsp;= int(line_list[0]) + 7<br />
&nbsp; &nbsp; gamma_line = int(line_list[0]) + 8<br />
<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;a\&quot; &amp;&amp; NR==&quot;+str(a_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[0] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[0] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[0] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;b\&quot; &amp;&amp; NR==&quot;+str(b_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[1] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[1] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[1] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;c\&quot; &amp;&amp; NR==&quot;+str(c_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[2] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[2] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[2] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; #<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;alpha\&quot; &amp;&amp; NR==&quot;+str(alpha_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[3] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[3] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[3] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;beta\&quot; &amp;&amp; NR==&quot;+str(beta_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[4] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[4] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[4] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;gamma\&quot; &amp;&amp; NR==&quot;+str(gamma_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[5] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[5] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[5] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; #<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;a\&quot; &amp;&amp; NR==&quot;+str(a_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[6] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[6] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[6] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;b\&quot; &amp;&amp; NR==&quot;+str(b_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[7] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[7] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[7] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;c\&quot; &amp;&amp; NR==&quot;+str(c_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[8] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[8] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[8] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; #<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;alpha\&quot; &amp;&amp; NR==&quot;+str(alpha_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[9] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[9] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[9] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;beta\&quot; &amp;&amp; NR==&quot;+str(beta_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[10] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[10] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[10] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;gamma\&quot; &amp;&amp; NR==&quot;+str(gamma_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[11] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[11] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[11] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
<br />
&nbsp; &nbsp; y = 1 / ( 500*((float(y_str[0])-target[0])/target[0])**2 + 500*((float(y_str[1])-target[1])/target[1])**2 \<br />
&nbsp; &nbsp; + 500*((float(y_str[2])-target[2])/target[2])**2 + 50*((float(y_str[3])-target[3])/target[3])**2 \<br />
&nbsp; &nbsp; + 50*((float(y_str[4])-target[4])/target[4])**2 + 50*((float(y_str[5])-target[5])/target[5])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[6])-target[6])/target[6])**2 + ((float(y_str[7])-target[7])/target[7])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[8])-target[8])/target[7])**2 + ((float(y_str[9])-target[9])/target[9])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[10])-target[10])/target[8])**2 + ((float(y_str[11])-target[11])/target[11])**2 )<br />
<br />
&nbsp; &nbsp; if (y &gt; select_limit_y and no_flag == 0):<br />
&nbsp; &nbsp; &nbsp; commands.getoutput(&quot;cp -p &quot;+file_inp+&quot; ./&quot;+output_file_name+&quot;/&quot;+file_inp+&quot;.&quot;+str(count))<br />
&nbsp; &nbsp; &nbsp; commands.getoutput(&quot;cp -p &quot;+file_out+&quot; ./&quot;+output_file_name+&quot;/&quot;+file_out+&quot;.&quot;+str(count))<br />
<br />
&nbsp; print y, y_str<br />
<br />
&nbsp; return y<br />
<br />
optimizer = BayesianOptimization(f=descripter, pbounds=pbounds)<br />
optimizer.maximize(init_points=1, n_iter=2000, acq=&quot;ucb&quot;)<br />
#acq = ucb, ei, poi, (default: ubc)<br />
----------<br />
2. sed -i &#39;s/\r//g&#39; baysian.py<br />
&nbsp; (sudo apt install nkf)<br />
&nbsp; (nkf -Lu --in-place baysian.py)<br />
3. python baysian.py<br />
Å¶ This method is very heavy. In my case, speed down near (n_iter) 500 cycle.<br />
<br />
Åû Result<br />
------------------------<br />
| &nbsp; iter &nbsp; &nbsp;| &nbsp;target &nbsp; | &nbsp; &nbsp;x0 &nbsp; &nbsp; | &nbsp; &nbsp;x1 &nbsp; &nbsp; | &nbsp; &nbsp;x10 &nbsp; &nbsp;| &nbsp; &nbsp;x11 &nbsp; &nbsp;| &nbsp; &nbsp;x12 &nbsp; &nbsp;| &nbsp; &nbsp;x2 &nbsp; &nbsp; | &nbsp; &nbsp;x3 &nbsp; &nbsp; | &nbsp; &nbsp;x4 &nbsp; &nbsp; | &nbsp; &nbsp;x5 &nbsp; &nbsp; | &nbsp; &nbsp;x6 &nbsp; &nbsp; | &nbsp; &nbsp;x7 &nbsp; &nbsp; | &nbsp; &nbsp;x8 &nbsp; &nbsp; | &nbsp; &nbsp;x9 &nbsp; &nbsp; |<br />
-----------------------------------------------------------------------------------------------------------------------<br />
------------------------<br />
2.85427748993e-05 [&#39;7.561371&#39;, &#39;7.561371&#39;, &#39;6.578849&#39;, &#39;64.212633&#39;, &#39;115.787367&#39;, &#39;125.811920&#39;, &#39;0.000163&#39;, &#39;-0.000022&#39;, &#39;0.000084&#39;, &#39;0.000000&#39;, &#39;-0.000036&#39;, &#39;0.000000&#39;]<br />
| &nbsp;121 &nbsp; &nbsp; &nbsp;| &nbsp;2.854e-0 | &nbsp;1.871 &nbsp; &nbsp;| &nbsp;2.521 &nbsp; &nbsp;| &nbsp;9.101 &nbsp; &nbsp;| &nbsp;31.92 &nbsp; &nbsp;| &nbsp;20.19 &nbsp; &nbsp;| -0.9 &nbsp; &nbsp; &nbsp;| &nbsp;1.001e+0 | &nbsp;1.099e+0 | &nbsp;5.403e+0 | &nbsp;0.246 &nbsp; &nbsp;| &nbsp;0.2445 &nbsp; | &nbsp;0.2443 &nbsp; | &nbsp;3.138 &nbsp; &nbsp;|<br />
------------------------<br />
------------------------<br />
-----(mg2nih4.gin)<br />
opti conp prop phon inten noden dispersion<br />
cell<br />
14.40202 6.41312 6.50056 90.0 113.4519 90.0<br />
frac<br />
Mg1 core &nbsp;0.234204 &nbsp; 0.015970 &nbsp; 0.411120 &nbsp;1.870775082805689<br />
Mg2 core &nbsp;0.000000 &nbsp; 0.028663 &nbsp; 0.750000 &nbsp;1.870775082805689<br />
Mg3 core &nbsp;0.000000 &nbsp; 0.468702 &nbsp; 0.250000 &nbsp;1.870775082805689<br />
Ni1 core &nbsp;0.120511 &nbsp; 0.227824 &nbsp; 0.576894 &nbsp;2.5205053741597725<br />
H1 &nbsp;core &nbsp;0.013040 &nbsp; 0.292296 &nbsp; 0.559006 &nbsp;-0.9<br />
H1 &nbsp;shel &nbsp;0.013040 &nbsp; 0.292296 &nbsp; 0.559006 &nbsp;-0.6655138849427876<br />
H2 &nbsp;core &nbsp;0.124405 &nbsp; 0.012577 &nbsp; 0.066741 &nbsp;-0.9<br />
H2 &nbsp;shel &nbsp;0.124405 &nbsp; 0.012577 &nbsp; 0.066741 &nbsp;-0.6655138849427876<br />
H3 &nbsp;core &nbsp;0.139242 &nbsp; 0.323081 &nbsp; 0.377111 &nbsp;-0.9<br />
H3 &nbsp;shel &nbsp;0.139242 &nbsp; 0.323081 &nbsp; 0.377111 &nbsp;-0.6655138849427876<br />
H4 &nbsp;core &nbsp;0.209100 &nbsp; 0.301371 &nbsp; 0.800247 &nbsp;-0.9<br />
H4 &nbsp;shel &nbsp;0.209100 &nbsp; 0.301371 &nbsp; 0.800247 &nbsp;-0.6655138849427876<br />
space<br />
15<br />
# C 2/c<br />
buck<br />
H1 shel Mg1 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H1 core Mg1 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H1 shel Mg2 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H1 core Mg2 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H1 shel Mg3 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H1 core Mg3 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
buck<br />
H2 shel Mg1 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H2 core Mg1 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H2 shel Mg2 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H2 core Mg2 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H2 shel Mg3 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H2 core Mg3 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
buck<br />
H3 shel Mg1 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H3 core Mg1 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H3 shel Mg2 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H3 core Mg2 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H3 shel Mg3 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H3 core Mg3 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
buck<br />
H4 shel Mg1 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H4 core Mg1 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H4 shel Mg2 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H4 core Mg2 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H4 shel Mg3 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
H4 core Mg3 core 1000.7021099458391 0.24595104678602198 &nbsp;3.13828758552409 0.0 12.800<br />
buck<br />
H1 shel Ni1 core 1099.24584789766 0.2444757832233872 &nbsp;9.101451466358121 0.0 12.800<br />
H1 core Ni1 core 1099.24584789766 0.2444757832233872 &nbsp;9.101451466358121 0.0 12.800<br />
H2 shel Ni1 core 1099.24584789766 0.2444757832233872 &nbsp;9.101451466358121 0.0 12.800<br />
H2 core Ni1 core 1099.24584789766 0.2444757832233872 &nbsp;9.101451466358121 0.0 12.800<br />
H3 shel Ni1 core 1099.24584789766 0.2444757832233872 &nbsp;9.101451466358121 0.0 12.800<br />
H3 core Ni1 core 1099.24584789766 0.2444757832233872 &nbsp;9.101451466358121 0.0 12.800<br />
H4 shel Ni1 core 1099.24584789766 0.2444757832233872 &nbsp;9.101451466358121 0.0 12.800<br />
H4 core Ni1 core 1099.24584789766 0.2444757832233872 &nbsp;9.101451466358121 0.0 12.800<br />
buck<br />
H1 shel H1 &nbsp;shel 5403.386194806582 0.24429985664408002 &nbsp;31.920635303667552 0.0 12.800<br />
H2 shel H2 &nbsp;shel 5403.386194806582 0.24429985664408002 &nbsp;31.920635303667552 0.0 12.800<br />
H3 shel H3 &nbsp;shel 5403.386194806582 0.24429985664408002 &nbsp;31.920635303667552 0.0 12.800<br />
H4 shel H4 &nbsp;shel 5403.386194806582 0.24429985664408002 &nbsp;31.920635303667552 0.0 12.800<br />
spring<br />
H1 &nbsp;20.191241214533157 0<br />
H2 &nbsp;20.191241214533157 0<br />
H3 &nbsp;20.191241214533157 0<br />
H4 &nbsp;20.191241214533157 0<br />
Ni1 999999.0 0<br />
Mg1 999999.0 0<br />
Mg2 999999.0 0<br />
Mg3 999999.0 0<br />
shrink<br />
4 4 4<br />
kpoints<br />
8 8 8<br />
dispersion 1 500<br />
0.0 0.0 0.0 to 0.5 0.5 0.5 to 0.0 0.0 0.5 to 0.0 0.0 0.0 to 0.5 0.0 0.0<br />
output phon mg2nih4<br />
-----<br />
2. ~/gulp-5.1/Src/gulp &lt; mg2nih4.gin | tee mg2nih4.got<br />
3. gnuplot<br />
&nbsp; set xzeroaxis<br />
&nbsp; set yrange[-50:1800]<br />
&nbsp; set arrow from 120,-50 to 120,1800 nohead<br />
&nbsp; set arrow from 215,-50 to 215,1800 nohead<br />
&nbsp; set arrow from 285,-50 to 285,1800 nohead<br />
&nbsp; set arrow from 425,-50 to 425,1800 nohead<br />
&nbsp; plot &quot;mg2nih4.disp&quot; w p pt 7 ps 0.1<br />
4. q<br />
5. gnuplot<br />
&nbsp; plot &quot;mg2nih4.dens&quot; w i<br />
6. q<br />
Å¶ Gamma - M - A - Gamma - V<br />
&nbsp; 0.0 0.0 0.0 to 0.5 0.5 0.5 to 0.0 0.0 0.5 to 0.0 0.0 0.0 to 0.5 0.0 0.0<br />
<br />
Åû Data: Mg2NiH4, C2/c,15<br />
--------------------<br />
&nbsp; Primitive cell parameters : &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Full cell parameters :<br />
<br />
&nbsp; a = &nbsp; 7.8827 &nbsp; &nbsp;alpha = &nbsp;68.6808 &nbsp; &nbsp; &nbsp; a = &nbsp;14.4020 &nbsp; &nbsp;alpha = &nbsp;90.0000<br />
&nbsp; b = &nbsp; 7.8827 &nbsp; &nbsp;beta &nbsp;= 111.3192 &nbsp; &nbsp; &nbsp; b = &nbsp; 6.4131 &nbsp; &nbsp;beta &nbsp;= 113.4519<br />
&nbsp; c = &nbsp; 6.5006 &nbsp; &nbsp;gamma = 131.9938 &nbsp; &nbsp; &nbsp; c = &nbsp; 6.5006 &nbsp; &nbsp;gamma = &nbsp;90.0000<br />
--------------------<br />
<br />
Åû mg2nih4_tmp.gin<br />
-----<br />
opti conp #prop phon inten noden dispersion<br />
cell<br />
14.40202 6.41312 6.50056 90.0 113.4519 90.0<br />
frac<br />
Mg1 core &nbsp;0.234204 &nbsp; 0.015970 &nbsp; 0.411120 &nbsp;XXX0<br />
Mg2 core &nbsp;0.000000 &nbsp; 0.028663 &nbsp; 0.750000 &nbsp;XXX0<br />
Mg3 core &nbsp;0.000000 &nbsp; 0.468702 &nbsp; 0.250000 &nbsp;XXX0<br />
Ni1 core &nbsp;0.120511 &nbsp; 0.227824 &nbsp; 0.576894 &nbsp;XXX1<br />
H1 &nbsp;core &nbsp;0.013040 &nbsp; 0.292296 &nbsp; 0.559006 &nbsp;XXX2<br />
H1 &nbsp;shel &nbsp;0.013040 &nbsp; 0.292296 &nbsp; 0.559006 &nbsp;XXX3<br />
H2 &nbsp;core &nbsp;0.124405 &nbsp; 0.012577 &nbsp; 0.066741 &nbsp;XXX2<br />
H2 &nbsp;shel &nbsp;0.124405 &nbsp; 0.012577 &nbsp; 0.066741 &nbsp;XXX3<br />
H3 &nbsp;core &nbsp;0.139242 &nbsp; 0.323081 &nbsp; 0.377111 &nbsp;XXX2<br />
H3 &nbsp;shel &nbsp;0.139242 &nbsp; 0.323081 &nbsp; 0.377111 &nbsp;XXX3<br />
H4 &nbsp;core &nbsp;0.209100 &nbsp; 0.301371 &nbsp; 0.800247 &nbsp;XXX2<br />
H4 &nbsp;shel &nbsp;0.209100 &nbsp; 0.301371 &nbsp; 0.800247 &nbsp;XXX3<br />
space<br />
15<br />
buck<br />
H1 shel Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H1 core Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H1 shel Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H1 core Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H1 shel Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H1 core Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
buck<br />
H2 shel Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H2 core Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H2 shel Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H2 core Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H2 shel Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H2 core Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
buck<br />
H3 shel Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H3 core Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H3 shel Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H3 core Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H3 shel Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H3 core Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
buck<br />
H4 shel Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H4 core Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H4 shel Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H4 core Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H4 shel Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H4 core Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
buck<br />
H1 shel Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H1 core Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H2 shel Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H2 core Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H3 shel Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H3 core Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H4 shel Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H4 core Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
buck<br />
H1 shel H1 &nbsp;shel XXX6 XXX9 &nbsp;XX12 0.0 12.800<br />
H2 shel H2 &nbsp;shel XXX6 XXX9 &nbsp;XX12 0.0 12.800<br />
H3 shel H3 &nbsp;shel XXX6 XXX9 &nbsp;XX12 0.0 12.800<br />
H4 shel H4 &nbsp;shel XXX6 XXX9 &nbsp;XX12 0.0 12.800<br />
spring<br />
H1 &nbsp;XX13 0<br />
H2 &nbsp;XX13 0<br />
H3 &nbsp;XX13 0<br />
H4 &nbsp;XX13 0<br />
Ni1 999999.0 0<br />
Mg1 999999.0 0<br />
Mg2 999999.0 0<br />
Mg3 999999.0 0<br />
#shrink<br />
#4 4 4<br />
#kpoints<br />
#8 8 8<br />
#dispersion 1 500<br />
#0.0 0.0 0.0 to 0.5 0.5 0.5 to 0.0 0.0 0.5 to 0.0 0.0 0.0 to 0.5 0.0 0.0<br />
#output phon mg2nih4<br />
-----<br />
Å¶ Usually, cation (shel) - cation (shel) pairs are not defined.<br />
Å¶ spring: Core - Shel interaction [eV/A^2]. Larger this value, smallar electronic polarization.<br />
Å¶ Core (charge X[e]) has mass, shell(charge Y[e]). X+Y=valence(e.g., Oxygen -&gt; -2)<br />
------------------------------------------------------------------------------<br />
Å° genetic algorithm<br />
<br />
Å¶ Min = Max * -1<br />
0. pip install -U deap --user<br />
1. ga.py<br />
----------<br />
import random<br />
from deap import creator, base, tools, algorithms<br />
import numpy<br />
import numpy as np<br />
import commands<br />
import sys<br />
#----------------------------------------------------------------------<br />
file_tmp = &#39;mg2nih4_tmp.gin&#39;<br />
file_inp = &#39;mg2nih4_ga.gin&#39;<br />
file_out = &#39;mg2nih4_ga.got&#39;<br />
<br />
gulp_adress = &quot;$HOME/gulp-5.1/Src/gulp&quot;<br />
timeout_s &nbsp; = &quot;timeout -s 9 5s&quot;<br />
<br />
output_file_name = &quot;ga_files&quot;<br />
commands.getoutput(&quot;rm -f -r &quot;+output_file_name)<br />
commands.getoutput(&quot;mkdir &quot;+output_file_name)<br />
<br />
select_limit_y = 100000.0<br />
<br />
keyword1 = &quot;Final&quot;<br />
keyword2 = &quot;cell&quot;<br />
target = [7.8827, 7.8827, 6.5006, 68.6808, 111.3192, 131.9938, 0.000001, 0.000001, 0.000001, 0.000001, 0.000001, 0.000001]<br />
y_str = [0,0,0,0,0,0,0,0,0,0,0,0] # initial data<br />
<br />
# fitting parameters<br />
x0 = [1.73, 2.97, -1.0, 1155.4, 1015.4, 5420.3, 0.2425, 0.2473, 0.2371, 26.94, 4.489, 12.11, 37.3] # initial data<br />
b1 = np.array([[1.6,1.8],[2.9,3],[-0.9,-1.1],[1000,1200],[900,1100],[5400,5500],[0.24,0.26],[0.24,0.26],[0.23,0.25],[0,50],[0,50],[0,50],[0,50]]) # boundary<br />
<br />
count = 0<br />
#----------------------------------------------------------------------<br />
creator.create(&quot;FitnessMax&quot;, base.Fitness, weights=(-1.0,))<br />
creator.create(&quot;Individual&quot;, numpy.ndarray, fitness=creator.FitnessMax)<br />
<br />
toolbox = base.Toolbox()<br />
<br />
n_gene = 13 # number of parameters<br />
min_ind = numpy.ones(n_gene) * -1.0<br />
max_ind = numpy.ones(n_gene) * &nbsp;1.0<br />
for i in range(n_gene):<br />
&nbsp; min_ind[i] = b1[i][0]<br />
&nbsp; max_ind[i] = b1[i][1]<br />
&nbsp; #print min_ind[i], max_ind[i]<br />
#----------------------------------------------------------------------<br />
def create_ind_uniform(min_ind, max_ind):<br />
&nbsp; ind = []<br />
&nbsp; for min, max in zip(min_ind, max_ind):<br />
&nbsp; &nbsp; ind.append(random.uniform(min, max))<br />
&nbsp; return ind<br />
#----------------------------------------------------------------------<br />
toolbox.register(&quot;create_ind&quot;, create_ind_uniform, min_ind, max_ind)<br />
toolbox.register(&quot;individual&quot;, tools.initIterate, creator.Individual, toolbox.create_ind)<br />
toolbox.register(&quot;population&quot;, tools.initRepeat, list, toolbox.individual)<br />
#----------------------------------------------------------------------<br />
#def evalOneMax(individual):<br />
# &nbsp;return sum(individual),<br />
#----------------------------------------------------------------------<br />
def evalOneMax(individual):<br />
<br />
&nbsp; print &quot;------------------------&quot;<br />
&nbsp; global count<br />
&nbsp; count += 1<br />
&nbsp; print count<br />
<br />
&nbsp; global no_flag<br />
&nbsp; no_flag = 0<br />
<br />
&nbsp; fi = open(file_tmp,&#39;r&#39;)<br />
&nbsp; text = fi.read().replace(&#39;XXX0&#39;,str(individual[0]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XXX1&#39;,str(individual[1]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XXX2&#39;,str(individual[2]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; xc3 = (-(individual[0]*3*2/3+individual[1]) - individual[2]*4) / 4<br />
&nbsp; text = text.replace(&#39;XXX3&#39;,str(xc3).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XXX4&#39;,str(individual[3]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XXX5&#39;,str(individual[4]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XXX6&#39;,str(individual[5]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XXX7&#39;,str(individual[6]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XXX8&#39;,str(individual[7]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XXX9&#39;,str(individual[8]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XX10&#39;,str(individual[9]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XX11&#39;,str(individual[10]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace(&#39;XX12&#39;,str(individual[11]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; #text = text.replace(&#39;XX12&#39;,&#39;0.0&#39;)<br />
&nbsp; text = text.replace(&#39;XX13&#39;,str(individual[12]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; #text = text.replace(&#39;XX13&#39;,&#39;845.8&#39;)<br />
&nbsp; fi.close<br />
<br />
&nbsp; with open(file_inp,&#39;w&#39;) as f:<br />
&nbsp; &nbsp; print &gt;&gt; f, text<br />
<br />
&nbsp; commands.getoutput(timeout_s+&quot; &quot;+gulp_adress+&quot; &lt; &quot;+file_inp+&quot; &gt; &quot;+file_out)<br />
&nbsp; #commands.getoutput(&quot;cp -p &quot;+file_inp+&quot; ./&quot;+output_file_name+&quot;/&quot;+file_inp+&quot;.&quot;+str(count))<br />
&nbsp; #commands.getoutput(&quot;cp -p &quot;+file_out+&quot; ./&quot;+output_file_name+&quot;/&quot;+file_out+&quot;.&quot;+str(count))<br />
&nbsp; #commands.getoutput(&quot;cp -p &quot;+file_inp+&quot; ./&quot;+output_file_name+file_inp+&quot;.`date \&quot;+%Y%m%d_%H%M%S\&quot;`&quot;)<br />
&nbsp; #commands.getoutput(&quot;cp -p &quot;+file_out+&quot; ./&quot;+output_file_name+file_out+&quot;.`date \&quot;+%Y%m%d_%H%M%S\&quot;`&quot;)<br />
<br />
&nbsp; get_line = &quot;awk &#39;{if($1==\&quot;&quot;+keyword1+&quot;\&quot; &amp;&amp; $2==\&quot;&quot;+keyword2+&quot;\&quot;){printf \&quot;%i \&quot;,NR }else{}}&#39; &quot;+file_out<br />
&nbsp; line = commands.getoutput(get_line)<br />
&nbsp; #print line<br />
&nbsp; if (line == &quot;&quot;):<br />
&nbsp; &nbsp; #y_str[0] = 99.9<br />
&nbsp; &nbsp; #y_str[1] = 99.9<br />
&nbsp; &nbsp; #y_str[2] = 99.9<br />
&nbsp; &nbsp; #y_str[3] = 99.9<br />
&nbsp; &nbsp; #y_str[4] = 99.9<br />
&nbsp; &nbsp; #y_str[5] = 99.9<br />
&nbsp; &nbsp; #y_str[6] = 99.9<br />
&nbsp; &nbsp; #y_str[7] = 99.9<br />
&nbsp; &nbsp; #y_str[8] = 99.9<br />
&nbsp; &nbsp; #y_str[9] = 99.9<br />
&nbsp; &nbsp; #y_str[10] = 99.9<br />
&nbsp; &nbsp; #y_str[11] = 99.9<br />
&nbsp; &nbsp; y = 99999999.9<br />
&nbsp; &nbsp; print &quot;time out or bad condition range&quot;<br />
&nbsp; else:<br />
&nbsp; &nbsp; line_list = line.rstrip().split(&quot; &quot;)<br />
&nbsp; &nbsp; #print line_list, len(line_list)<br />
&nbsp; &nbsp; a_line = int(line_list[0]) + 3<br />
&nbsp; &nbsp; b_line = int(line_list[0]) + 4<br />
&nbsp; &nbsp; c_line = int(line_list[0]) + 5<br />
&nbsp; &nbsp; alpha_line = int(line_list[0]) + 6<br />
&nbsp; &nbsp; beta_line &nbsp;= int(line_list[0]) + 7<br />
&nbsp; &nbsp; gamma_line = int(line_list[0]) + 8<br />
<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;a\&quot; &amp;&amp; NR==&quot;+str(a_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[0] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[0] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[0] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;b\&quot; &amp;&amp; NR==&quot;+str(b_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[1] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[1] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[1] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;c\&quot; &amp;&amp; NR==&quot;+str(c_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[2] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[2] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[2] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; #<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;alpha\&quot; &amp;&amp; NR==&quot;+str(alpha_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[3] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[3] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[3] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;beta\&quot; &amp;&amp; NR==&quot;+str(beta_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[4] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[4] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[4] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;gamma\&quot; &amp;&amp; NR==&quot;+str(gamma_line)+&quot;){printf($2)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[5] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[5] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[5] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; #<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;a\&quot; &amp;&amp; NR==&quot;+str(a_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[6] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[6] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[6] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;b\&quot; &amp;&amp; NR==&quot;+str(b_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[7] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[7] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[7] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;c\&quot; &amp;&amp; NR==&quot;+str(c_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[8] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[8] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[8] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; #<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;alpha\&quot; &amp;&amp; NR==&quot;+str(alpha_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[9] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[9] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[9] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;beta\&quot; &amp;&amp; NR==&quot;+str(beta_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[10] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; if (y_str[10] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[10] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
&nbsp; &nbsp; get_data = &quot;awk &#39;{if($1==\&quot;gamma\&quot; &amp;&amp; NR==&quot;+str(gamma_line)+&quot;){printf($5)}else{}}&#39; &quot;+file_out<br />
&nbsp; &nbsp; y_str[11] = commands.getoutput(get_data)<br />
&nbsp; &nbsp; print y_str<br />
&nbsp; &nbsp; if (y_str[11] == &quot;************&quot;):<br />
&nbsp; &nbsp; &nbsp; y_str[11] = &quot;99999.999999&quot;<br />
&nbsp; &nbsp; &nbsp; no_flag = 1<br />
<br />
&nbsp; &nbsp; y = 500*((float(y_str[0])-target[0])/target[0])**2 + 500*((float(y_str[1])-target[1])/target[1])**2 \<br />
&nbsp; &nbsp; + 500*((float(y_str[2])-target[2])/target[2])**2 + 50*((float(y_str[3])-target[3])/target[3])**2 \<br />
&nbsp; &nbsp; + 50*((float(y_str[4])-target[4])/target[4])**2 + 50*((float(y_str[5])-target[5])/target[5])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[6])-target[6])/target[6])**2 + ((float(y_str[7])-target[7])/target[7])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[8])-target[8])/target[7])**2 + ((float(y_str[9])-target[9])/target[9])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[10])-target[10])/target[8])**2 + ((float(y_str[11])-target[11])/target[11])**2<br />
<br />
&nbsp; &nbsp; if (y &lt; select_limit_y and no_flag == 0):<br />
&nbsp; &nbsp; &nbsp; commands.getoutput(&quot;cp -p &quot;+file_inp+&quot; ./&quot;+output_file_name+&quot;/&quot;+file_inp+&quot;.&quot;+str(count))<br />
&nbsp; &nbsp; &nbsp; commands.getoutput(&quot;cp -p &quot;+file_out+&quot; ./&quot;+output_file_name+&quot;/&quot;+file_out+&quot;.&quot;+str(count))<br />
<br />
&nbsp; print y, individual<br />
&nbsp; print &quot;------------------------&quot;<br />
<br />
&nbsp; return y,<br />
#----------------------------------------------------------------------<br />
def cxTwoPointCopy(ind1, ind2):<br />
&nbsp; size = len(ind1)<br />
&nbsp; cxpoint1 = random.randint(1, size)<br />
&nbsp; cxpoint2 = random.randint(1, size-1)<br />
&nbsp; if (cxpoint2 &gt;= cxpoint1):<br />
&nbsp; &nbsp; cxpoint2 += 1<br />
&nbsp; else:<br />
&nbsp; &nbsp; cxpoint1, cxpoint2 = cxpoint2, cxpoint1<br />
<br />
&nbsp; ind1[cxpoint1:cxpoint2], ind2[cxpoint2:cxpoint2] = ind2[cxpoint1:cxpoint2].copy(), ind1[cxpoint1:cxpoint2].copy()<br />
<br />
&nbsp; return ind1, ind2<br />
#----------------------------------------------------------------------<br />
def mutUniformDbl(individual, min_ind, max_ind, indpb):<br />
&nbsp; size = len(individual)<br />
&nbsp; for i, min, max in zip(xrange(size), min_ind, max_ind):<br />
&nbsp; &nbsp; if (random.random() &lt; indpb):<br />
&nbsp; &nbsp; &nbsp; individual[i] = random.uniform(min, max)<br />
&nbsp; return indivisual,<br />
#----------------------------------------------------------------------<br />
toolbox.register(&quot;evaluate&quot;, evalOneMax)<br />
toolbox.register(&quot;mate&quot;, tools.cxTwoPoint)<br />
toolbox.register(&quot;mutate&quot;, tools.mutFlipBit, indpb=0.05)<br />
toolbox.register(&quot;select&quot;, tools.selTournament, tournsize=3)<br />
#----------------------------------------------------------------------<br />
def main():<br />
&nbsp; random.seed(64)<br />
&nbsp; pop = toolbox.population(n=300)<br />
&nbsp; hof = tools.HallOfFame(1, similar=numpy.array_equal)<br />
&nbsp; stats = tools.Statistics(lambda ind: ind.fitness.values)<br />
&nbsp; stats.register(&quot;avg&quot;, numpy.mean)<br />
&nbsp; stats.register(&quot;std&quot;, numpy.std)<br />
&nbsp; stats.register(&quot;min&quot;, numpy.min)<br />
&nbsp; stats.register(&quot;max&quot;, numpy.max)<br />
&nbsp; algorithms.eaSimple(pop, toolbox, cxpb=0.5, mutpb=0.2, ngen=50000, stats=stats, halloffame=hof)<br />
&nbsp; return pop, stats, hof<br />
#----------------------------------------------------------------------<br />
if (__name__ == &quot;__main__&quot;):<br />
&nbsp; main()<br />
#----------------------------------------------------------------------<br />
----------<br />
2. sed -i &#39;s/\r//g&#39; ga.py<br />
&nbsp; (sudo apt install nkf)<br />
&nbsp; (nkf -Lu --in-place ga.py)<br />
3. python ga.py<br />
<br />
Åû Result<br />
------------------------(1st time)<br />
26225<br />
[&#39;9.449035&#39;, &#39;9.449035&#39;, &#39;7.794337&#39;, &#39;65.644173&#39;, &#39;114.355827&#39;, &#39;130.450466&#39;, &#39;0.000024&#39;, &#39;0.000027&#39;, &#39;0.000035&#39;, &#39;0.000000&#39;, &#39;0.000018&#39;, &#39;0.000000&#39;]<br />
13.8614115447 [ 1.73382670e+00 &nbsp;2.97027088e+00 -9.99265388e-01 &nbsp;1.15541142e+03<br />
&nbsp; 1.01539857e+03 &nbsp;5.42035859e+03 &nbsp;2.90955269e-01 &nbsp;2.50542141e-01<br />
&nbsp; 2.46283567e-01 &nbsp;2.69445096e-01 &nbsp;4.48954201e+00 &nbsp;1.21187806e+01<br />
&nbsp; 3.73398788e+01]<br />
------------------------<br />
------------------------(2nd try: fix XXX6=5420.3)<br />
3416<br />
[&#39;7.731718&#39;, &#39;7.731718&#39;, &#39;6.445469&#39;, &#39;65.355159&#39;, &#39;114.644841&#39;, &#39;128.735788&#39;, &#39;0.000099&#39;, &#39;0.000000&#39;, &#39;0.000137&#39;, &#39;0.000000&#39;, &#39;0.000020&#39;, &#39;0.000000&#39;]<br />
28464.5951439 [ 1.75833677e+00 &nbsp;2.96323170e+00 -1.04435754e+00 &nbsp;1.07987351e+03<br />
&nbsp; 9.18168015e+02 &nbsp;5.420300e+03 &nbsp;2.50373733e-01 &nbsp;2.44280712e-01<br />
&nbsp; 2.43374856e-01 &nbsp;5.03542311e+00 &nbsp;5.36339758e+00 &nbsp;3.87871715e+01<br />
&nbsp; 2.29040877e+01]<br />
------------------------<br />
-----(mg2nih4.gin)<br />
opti conp prop phon inten noden dispersion<br />
cell<br />
14.40202 6.41312 6.50056 90.0 113.4519 90.0<br />
frac<br />
Mg1 core &nbsp;0.234204 &nbsp; 0.015970 &nbsp; 0.411120 &nbsp;1.7583367683372608<br />
Mg2 core &nbsp;0.000000 &nbsp; 0.028663 &nbsp; 0.750000 &nbsp;1.7583367683372608<br />
Mg3 core &nbsp;0.000000 &nbsp; 0.468702 &nbsp; 0.250000 &nbsp;1.7583367683372608<br />
Ni1 core &nbsp;0.120511 &nbsp; 0.227824 &nbsp; 0.576894 &nbsp;2.9632317018880086<br />
H1 &nbsp;core &nbsp;0.013040 &nbsp; 0.292296 &nbsp; 0.559006 &nbsp;-1.0443575361054227<br />
H1 &nbsp;shel &nbsp;0.013040 &nbsp; 0.292296 &nbsp; 0.559006 &nbsp;-0.5756187735352098<br />
H2 &nbsp;core &nbsp;0.124405 &nbsp; 0.012577 &nbsp; 0.066741 &nbsp;-1.0443575361054227<br />
H2 &nbsp;shel &nbsp;0.124405 &nbsp; 0.012577 &nbsp; 0.066741 &nbsp;-0.5756187735352098<br />
H3 &nbsp;core &nbsp;0.139242 &nbsp; 0.323081 &nbsp; 0.377111 &nbsp;-1.0443575361054227<br />
H3 &nbsp;shel &nbsp;0.139242 &nbsp; 0.323081 &nbsp; 0.377111 &nbsp;-0.5756187735352098<br />
H4 &nbsp;core &nbsp;0.209100 &nbsp; 0.301371 &nbsp; 0.800247 &nbsp;-1.0443575361054227<br />
H4 &nbsp;shel &nbsp;0.209100 &nbsp; 0.301371 &nbsp; 0.800247 &nbsp;-0.5756187735352098<br />
space<br />
15<br />
buck<br />
H1 shel Mg1 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H1 core Mg1 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H1 shel Mg2 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H1 core Mg2 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H1 shel Mg3 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H1 core Mg3 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
buck<br />
H2 shel Mg1 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H2 core Mg1 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H2 shel Mg2 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H2 core Mg2 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H2 shel Mg3 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H2 core Mg3 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
buck<br />
H3 shel Mg1 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H3 core Mg1 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H3 shel Mg2 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H3 core Mg2 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H3 shel Mg3 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H3 core Mg3 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
buck<br />
H4 shel Mg1 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H4 core Mg1 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H4 shel Mg2 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H4 core Mg2 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H4 shel Mg3 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
H4 core Mg3 core 1079.8735051720464 0.25037373292464116 &nbsp;5.03542311455078 0.0 12.800<br />
buck<br />
H1 shel Ni1 core 918.1680153720359 0.24428071195074266 &nbsp;5.36339757745875 0.0 12.800<br />
H1 core Ni1 core 918.1680153720359 0.24428071195074266 &nbsp;5.36339757745875 0.0 12.800<br />
H2 shel Ni1 core 918.1680153720359 0.24428071195074266 &nbsp;5.36339757745875 0.0 12.800<br />
H2 core Ni1 core 918.1680153720359 0.24428071195074266 &nbsp;5.36339757745875 0.0 12.800<br />
H3 shel Ni1 core 918.1680153720359 0.24428071195074266 &nbsp;5.36339757745875 0.0 12.800<br />
H3 core Ni1 core 918.1680153720359 0.24428071195074266 &nbsp;5.36339757745875 0.0 12.800<br />
H4 shel Ni1 core 918.1680153720359 0.24428071195074266 &nbsp;5.36339757745875 0.0 12.800<br />
H4 core Ni1 core 918.1680153720359 0.24428071195074266 &nbsp;5.36339757745875 0.0 12.800<br />
buck<br />
H1 shel H1 &nbsp;shel 5420.3 0.2433748564559581 &nbsp;38.787171477302515 0.0 12.800<br />
H2 shel H2 &nbsp;shel 5420.3 0.2433748564559581 &nbsp;38.787171477302515 0.0 12.800<br />
H3 shel H3 &nbsp;shel 5420.3 0.2433748564559581 &nbsp;38.787171477302515 0.0 12.800<br />
H4 shel H4 &nbsp;shel 5420.3 0.2433748564559581 &nbsp;38.787171477302515 0.0 12.800<br />
spring<br />
H1 &nbsp;22.904087702985887 0<br />
H2 &nbsp;22.904087702985887 0<br />
H3 &nbsp;22.904087702985887 0<br />
H4 &nbsp;22.904087702985887 0<br />
Ni1 999999.0 0<br />
Mg1 999999.0 0<br />
Mg2 999999.0 0<br />
Mg3 999999.0 0<br />
shrink<br />
4 4 4<br />
kpoints<br />
8 8 8<br />
dispersion 1 500<br />
0.0 0.0 0.0 to 0.5 0.5 0.5 to 0.0 0.0 0.5 to 0.0 0.0 0.0 to 0.5 0.0 0.0<br />
output phon mg2nih4<br />
-----<br />
2. ~/gulp-5.1/Src/gulp &lt; mg2nih4.gin | tee mg2nih4.got<br />
3. gnuplot<br />
&nbsp; set xzeroaxis<br />
&nbsp; set yrange[-50:1800]<br />
&nbsp; set arrow from 120,-50 to 120,1800 nohead<br />
&nbsp; set arrow from 215,-50 to 215,1800 nohead<br />
&nbsp; set arrow from 285,-50 to 285,1800 nohead<br />
&nbsp; set arrow from 425,-50 to 425,1800 nohead<br />
&nbsp; plot &quot;mg2nih4.disp&quot; w p pt 7 ps 0.1<br />
4. q<br />
5. gnuplot<br />
&nbsp; plot &quot;mg2nih4.dens&quot; w i<br />
6. q<br />
Å¶ Gamma - M - A - Gamma - V<br />
&nbsp; 0.0 0.0 0.0 to 0.5 0.5 0.5 to 0.0 0.0 0.5 to 0.0 0.0 0.0 to 0.5 0.0 0.0<br />
[P1] Shel Model Ç…äÓÇ√Ç≠ Pb (Zr, Ti) O3 ÇÃå¥éqä‘É|ÉeÉìÉVÉÉÉãÇÃäJî≠<br />
&nbsp; https://www.jstage.jst.go.jp/article/kikaia1979/72/718/72_718_817/_pdf<br />
<br />
Åû Mg2NiH4, C2/c,15<br />
--------------------<br />
&nbsp; Primitive cell parameters : &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Full cell parameters :<br />
<br />
&nbsp; a = &nbsp; 7.8827 &nbsp; &nbsp;alpha = &nbsp;68.6808 &nbsp; &nbsp; &nbsp; a = &nbsp;14.4020 &nbsp; &nbsp;alpha = &nbsp;90.0000<br />
&nbsp; b = &nbsp; 7.8827 &nbsp; &nbsp;beta &nbsp;= 111.3192 &nbsp; &nbsp; &nbsp; b = &nbsp; 6.4131 &nbsp; &nbsp;beta &nbsp;= 113.4519<br />
&nbsp; c = &nbsp; 6.5006 &nbsp; &nbsp;gamma = 131.9938 &nbsp; &nbsp; &nbsp; c = &nbsp; 6.5006 &nbsp; &nbsp;gamma = &nbsp;90.0000<br />
--------------------<br />
<br />
Åû Data: mg2nih4_tmp.gin<br />
-----<br />
opti conp #prop phon inten noden dispersion<br />
cell<br />
14.40202 6.41312 6.50056 90.0 113.4519 90.0<br />
frac<br />
Mg1 core &nbsp;0.234204 &nbsp; 0.015970 &nbsp; 0.411120 &nbsp;XXX0<br />
Mg2 core &nbsp;0.000000 &nbsp; 0.028663 &nbsp; 0.750000 &nbsp;XXX0<br />
Mg3 core &nbsp;0.000000 &nbsp; 0.468702 &nbsp; 0.250000 &nbsp;XXX0<br />
Ni1 core &nbsp;0.120511 &nbsp; 0.227824 &nbsp; 0.576894 &nbsp;XXX1<br />
H1 &nbsp;core &nbsp;0.013040 &nbsp; 0.292296 &nbsp; 0.559006 &nbsp;XXX2<br />
H1 &nbsp;shel &nbsp;0.013040 &nbsp; 0.292296 &nbsp; 0.559006 &nbsp;XXX3<br />
H2 &nbsp;core &nbsp;0.124405 &nbsp; 0.012577 &nbsp; 0.066741 &nbsp;XXX2<br />
H2 &nbsp;shel &nbsp;0.124405 &nbsp; 0.012577 &nbsp; 0.066741 &nbsp;XXX3<br />
H3 &nbsp;core &nbsp;0.139242 &nbsp; 0.323081 &nbsp; 0.377111 &nbsp;XXX2<br />
H3 &nbsp;shel &nbsp;0.139242 &nbsp; 0.323081 &nbsp; 0.377111 &nbsp;XXX3<br />
H4 &nbsp;core &nbsp;0.209100 &nbsp; 0.301371 &nbsp; 0.800247 &nbsp;XXX2<br />
H4 &nbsp;shel &nbsp;0.209100 &nbsp; 0.301371 &nbsp; 0.800247 &nbsp;XXX3<br />
space<br />
15<br />
buck<br />
H1 shel Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H1 core Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H1 shel Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H1 core Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H1 shel Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H1 core Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
buck<br />
H2 shel Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H2 core Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H2 shel Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H2 core Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H2 shel Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H2 core Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
buck<br />
H3 shel Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H3 core Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H3 shel Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H3 core Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H3 shel Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H3 core Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
buck<br />
H4 shel Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H4 core Mg1 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H4 shel Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H4 core Mg2 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H4 shel Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
H4 core Mg3 core XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
buck<br />
H1 shel Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H1 core Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H2 shel Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H2 core Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H3 shel Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H3 core Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H4 shel Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
H4 core Ni1 core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
buck<br />
H1 shel H1 &nbsp;shel XXX6 XXX9 &nbsp;XX12 0.0 12.800<br />
H2 shel H2 &nbsp;shel XXX6 XXX9 &nbsp;XX12 0.0 12.800<br />
H3 shel H3 &nbsp;shel XXX6 XXX9 &nbsp;XX12 0.0 12.800<br />
H4 shel H4 &nbsp;shel XXX6 XXX9 &nbsp;XX12 0.0 12.800<br />
spring<br />
H1 &nbsp;XX13 0<br />
H2 &nbsp;XX13 0<br />
H3 &nbsp;XX13 0<br />
H4 &nbsp;XX13 0<br />
Ni1 999999.0 0<br />
Mg1 999999.0 0<br />
Mg2 999999.0 0<br />
Mg3 999999.0 0<br />
#shrink<br />
#4 4 4<br />
#kpoints<br />
#8 8 8<br />
#dispersion 1 500<br />
#0.0 0.0 0.0 to 0.5 0.5 0.5 to 0.0 0.0 0.5 to 0.0 0.0 0.0 to 0.5 0.0 0.0<br />
#output phon mg2nih4<br />
-----<br />
Å¶ Usually, cation (shel) - cation (shel) pairs are not defined.<br />
Å¶ spring: Core - Shel interaction [eV/A^2]. Larger this value, smallar electronic polarization.<br />
Å¶ Core (charge X[e]) has mass, shell(charge Y[e]). X+Y=valence(e.g., Oxygen -&gt; -2)<br />
<br />
[1] http://darden.hatenablog.com/entry/2017/04/18/225459<br />
[2] https://github.com/DEAP/deap<br />
[3] http://darden.hatenablog.com/entry/2017/03/29/213948<br />
------------------------------------------------------------------------------<br />
&nbsp;