-----------------------------------------------------------------------------<br />
■ 高校数学も出来ない私では「こんなの普通にフォローできるわけのない内容」<br />
・井田　隆／教育／計算科学基礎（http://www.crl.nitech.ac.jp/~ida/education/ComputerScience/index-j.html）<br />
-----------------------------------------------------------------------------<br />
■ 基礎知識<br />
<br />
◇ セルサイズの条件<br />
・MDセルのサイズは、境界条件の影響を受けないように大きく設定する。ポテンシャルのカットオフ距離の2倍は最低限必要<br />
<br />
◇ 初期状態の設定<br />
・原子の初期速度は、ボルツマン分布に従った乱数で与える。平衡状態においては、原子の速度はボルツマン分布に従うことが統計熱力学から分かっている。速やかに平衡状態に到達するためにボルツマン分布を使う<br />
・初期速度として、いきなり大きな速度（温度）を与えることは好ましくない。高温のシミュレーションを行う場合でも、最初は低い温度で始め、徐々に温度を上げていく<br />
・初期速度や初期配置が原因で系全体が並進運動や回転運動を起こさないように、重心位置や速度を調整することも必要である<br />
・自然な状態になるためにはある程度の緩和時間が必要であり、分子動力学では、十分な緩和計算を行ってから物性値の算出を行う<br />
<br />
◇ 差分法の時間刻みの設定<br />
・差分法の時間刻み&Delta;tは、精度を確保しつつ計算時間を短くするように適正に設定する必要がある<br />
・一般に、原子の振動周期の1/1000〜1/200あたりを目安に設定される<br />
・水素などの軽い原子を扱う場合は、時間刻みを小さく（&Delta;t〜0.1fs）とる必要がある。水素が少量含まれる場合は、水素原子のみ時間刻みを小さくするマルチタイムステップ法により計算時間の削減が行われる<br />
・固体系のシミュレーションでは&Delta;t＝0.5〜5fs程度が一般的。<br />
・ギア法は精度が良いのでベルレ法よりも&quot;&Delta;t&quot;をより大きくとることができる<br />
・&quot;Error : Lost atoms&quot;の場合には、&quot;&Delta;t&quot;を現在の値よりもより小さい値にする（原子が周期をまたぎ過ぎることを防ぐ）<br />
<br />
◇ 温度 [5]<br />
・温度は運動エネルギーから計算される。そのため、運動エネルギーに与えた温度分のエネルギーが位置エネルギーに流れると温度が下がる。これは計算の初期においてよく見られる<br />
・能勢法とスケーリング法は結果がほぼ同じになる。能勢法は数学的な厳密性を求めたり、熱の揺らぎを小さいしたい場合に用いられる<br />
・能勢法の仮想質量には物理的意味はない。温度を上手く制御できればよい<br />
<br />
◇ 物性値のゆらぎの取り扱い<br />
・分子動力学の物性値はゆらぎが大きいため、算出には十分な時間・空間平均が必要。とくに応力はゆらぎが大きい<br />
<br />
◇ 系の制御とアンサンブル<br />
・熱統計力学により、熱力学的独立変数は3つであるから、3つの状態変数を制御することができる。<br />
・とくに、何の制御もしない場合は、粒子数N、エネルギーE、体積Vが保存される（一定に制御される）ミクロカノニカルアンサンブル（NEV）となる。下記に（NEV）と他のアンサンブルも含めて特徴を記す。温度ムラを再現したいときや、スパッタ、化学反応のシミュレーションなどで用いられる<br />
&nbsp; ミクロカノニカルアンサンブル（NEV）：エネルギーと体積が一定となる。温度と圧力のゆらぎは小さい。熱伝導率はNEVで計算<br />
&nbsp; カノニカルアンサンブル（NTV）：温度Tと体積Vが一定となる。NEVと比較して、圧力と全エネルギーとポテンシャルエネルギーのゆらぎは大きい。表面張力をMDでは見ることができる。能勢法<br />
&nbsp; 等圧アンサンブル（NPH）：圧力Pを一定に制御する。Anderson法<br />
&nbsp; 等圧・等温アンサンブル（NTP）：温度と圧力を一定に制御する。圧力、体積が設定値のまわりを大きくゆらぐ。NEVと比較して、全エネルギーとポテンシャルエネルギーのゆらぎは大きい。密度はNTPで計算<br />
&nbsp; 等応力アンサンブル（N&sigma;H）：応力&sigma;を一定に制御する。Parinello-Rahman法<br />
&nbsp; 等応力・等温アンサンブル（N&sigma;T）：応力と温度を一定に制御する<br />
&nbsp; グランドカノニカルアンサンブル：粒子数が変化<br />
※ Hはエンタルピー<br />
※ 圧力アンサンブルは、平均二乗変位などの物性値算出には不適切。一方で、ゼロ応力の格子サイズを求めるのには便利であるため用いられる<br />
<br />
◇ 原子間ポテンシャル<br />
・精度を最も上げるには、電子状態計算をベースとした第一原理分子動力学が理想である。しかし、計算系は100個程度に制限され、長い時間ステップの計算も難しいのが現状である。そのため、材料の特性に合わせてさまざまな原子間ポテンシャルが提案されてきた。<br />
・分子間相互作用は、厳密には原子核と電子からなる集団系が量子力学的な法則に従って発生させる多体相互作用です。しかしながら、化学反応を含まない系や電子が非局在していない系に対してはむしろ計算コストの圧倒的に低い経験ポテンシャルの法が精度的に優れており、特別な目的がない限り経験ポテンシャルが用いられています。[P1]<br />
[P1] 応用物理 第86巻 第11号 p.988 (2017)<br />
<br />
□ 2体ポテンシャル<br />
・計算時間が短いことや、ポテンシャル形状が単純で現象の解釈が容易であるなどの理由で用いられる<br />
・空孔や表面などの欠陥まわりのエネルギーは再現できないとされている（バックボンドの記述ができないため）<br />
・格子定数と凝集エネルギーを合わせると、他の物性を合わせ込めない。そのため、通常は凝集エネルギーは合わせない<br />
・弾性定数において必ずCauchyの関係式（C12=C44）が成り立ってしまう<br />
・レナードジョーンズ（Lennard-Jones）ポテンシャル<br />
&nbsp; r = &sigma; * 2*(1/6)で原子間力がゼロ<br />
&nbsp; 電子の電荷の偏りによる双極子間の引力相互作用（van der Waals力）<br />
&nbsp; 物理吸着や希ガス（Ar, Ne）の計算に用いられる<br />
・モース(morse)ポテンシャル<br />
&nbsp; 金属などで用いられる<br />
&nbsp; r0のところが結合エネルギー<br />
・Backinghamポテンシャル<br />
&nbsp; レナードジョーンズ（Lennard-Jones）ポテンシャルをさらに簡単化したもの<br />
&nbsp; SiO2やAl2O3などのガラスの計算によく用いられる<br />
&nbsp; cation-cationはクーロン力のみ。密度、膨張係数を再現するように最適化(https://doi.org/10.1016/j.gca.2007.05.029)<br />
&nbsp; 実験を再現するように最適化（https://doi.org/10.1016/j.jnoncrysol.2018.04.063）<br />
・代表的な2体ポテンシャル：レナードジョーンズポテンシャル、モースポテンシャル、ジョンソンポテンシャルなど<br />
<br />
□ 3体ポテンシャル（共有結合系）<br />
・欠陥（点欠陥、転位、粒界など）の解析で用いられる<br />
・Stillinger-Waberポテンシャル<br />
&nbsp; 多体クラスターポテンシャル<br />
&nbsp; 合わせ込んだ構造以外に遷移する場合（化学反応や相転移など）には対応できない。結晶構造が変化しない計算に向いている<br />
&nbsp; ダイヤモンド構造と液体構造にフィッティング<br />
&nbsp; 格子間Siの平衡濃度・拡散挙動、転移の移動度、エピタキシャル結晶成長、イオンプランテーション、転位の生成・進展<br />
・Tersoffポテンシャル<br />
&nbsp; ボンドオーダーポテンシャル<br />
&nbsp; 多形態（ダイマー、グラファイト、ダイヤモンド、単純立方、体心立方など）のシリコンの構造にフィッティング<br />
&nbsp; 低配位数（2〜4）の挙動を再現する。結晶構造が変化する計算に向いている。<br />
&nbsp; 結合に対応した第一近接ポテンシャル<br />
&nbsp; &radic;配位数 は局所状態密度の二次モーメント近似より導かれる。FSやEAMにおいても類似の考え方<br />
&nbsp; ボンドオーダーに配位数依存性と角度依存性を入れている<br />
&nbsp; T3タイプは弾性定数で合わせ込み。T2タイプは表面構造で合わせ込み（T2タイプはあまり使われない）<br />
&nbsp; 合わせ込んだ構造の範囲内で相転移にも対応できる。界面・表面の計算などにも使われる<br />
&nbsp; 照射欠陥、アモルファス化、固相成長、圧力相変態、インプランテーション化などでも用いられる<br />
&nbsp; 発展形として、C-HのBrenner, Si-HのMartyや大平ポテンシャルがある<br />
&nbsp; 炭素はBrenner(ブレーナー)ポテンシャルまたはその発展形であるREBO(airebo)ポテンシャルが良い<br />
・代表的な多体ポテンシャル：Stillinger-Waberポテンシャル、Tersoffポテンシャル、Brennerポテンシャル, Biswas-Hanmannポテンシャルなど<br />
<br />
□ 多体ポテンシャル（金属結合系）<br />
・二体項の関数形、部分電子密度の関数形、埋め込み関数の関数形によって多くの種類が存在<br />
・埋め込み関数Fには現在（2019年）のところ理論的な支持はない<br />
・結合距離と配位数で引力が変化する。配位数が多いと一結合あたりの結合力が減少<br />
・EAM系のポテンシャル：金属系で用いられる。EAM系として、FS, EAM, MEAM, GEAMが挙げられる<br />
・EAM（イエム）<br />
&nbsp; レナードジョーンズポテンシャルの2.3倍の計算時間がかかる<br />
&nbsp; Mishinポテンシャルなどが有名<br />
・MEAM（エムイエム）：EAMの関数形状の改良、スクリーニング関数、角度項の導入などがされている。レナードジョーンズポテンシャルの20倍程度の計算時間がかかる<br />
・GEAM<br />
&nbsp; 異種原子間2体ポテンシャル<br />
&nbsp; 合金用にポテンシャルパラメータを用意する必要がない（現在（2019年）、混ぜ合わせの式において理論的な支持はない）<br />
・FS<br />
&nbsp; EAMポテンシャルと比べて関数形状が単純であり、コーディングしやすいことから多く用いられてきた<br />
&nbsp; Long-range(LR) FSポテンシャルなどもある<br />
・RGL<br />
&nbsp; EAMの一種<br />
・ADP(Angular-Dependent Potential)<br />
&nbsp; EAM + 角度依存項<br />
<br />
□ イオンポテンシャル（固定電荷）<br />
・バルクでの計算で用いられる<br />
・イオン結合を再現する。表面や界面など構造が急激に変化する場所では電荷が不均一に分散するため、電荷移動を考えた可変電荷ポテンシャルが必要となる。可変電荷ポテンシャルでは、MDステップごとに電荷の分布の計算が必要なため、通常の分子動力学のおよそ100倍以上の計算時間がかかるとされる<br />
・長距離ポテンシャルのため、カットオフ（スクリーニング）もしくはエワルド和の計算（FFT）が必要<br />
・周期境界条件の周期性の特徴を活かして、フーリエ変換により、遠方のコピーセルの影響を効率的に計算するエワルド法が用いられる。ただし、エワルド法は計算量が大きく、通常の分子動力学の10倍程度になると言われている<br />
・代表的なイオンポテンシャル（固定電荷）： BKSポテンシャル<br />
<br />
□ イオンポテンシャル（可変電荷（QEq法））<br />
・界面・表面では局所的な電荷の移動があるため、可変電荷のイオンポテンシャルが必要になる<br />
・Tersoff＋可変電荷ポテンシャル：SiO2などの共有結合系の酸化物<br />
・EAM＋可変電荷ポテンシャル：NiOなどの金属系の酸化物に適応される<br />
・電荷の移動+原子間力の二つを解く必要があるため、計算時間は通常の分子動力学の100倍程度になると言われている<br />
[QEq1] 夏の学校テキスト&nbsp;<br />
&nbsp; http://www.yasuoka.mech.keio.ac.jp/summer2002/download/tsuchiya.pdf<br />
<br />
□ 分子内・分子間ポテンシャル<br />
・高分子などは、個々の原子間結合の挙動よりも分子鎖としての挙動に着目する場合が多い。基本的に最初に定義した分子内の結合は切れないと考える<br />
・有名な分指導力学の汎用ソフトウエアのAMBERなどで提供されている<br />
・Amber Force Field<br />
&nbsp; 全体のエネルギーは、分子内相互作用（2体ポテンシャル+結合角ポテンシャル+ねじれ角ポテンシャル）と分子間相互作用（ファンデルワールス力+クーロン力）の和になる<br />
&nbsp; ポテンシャルの記述が比較的簡単な代わりに、同一原子でも結合状態によってポテンシャルの記述をわけている<br />
&nbsp; 分子内の原子の持つ電荷は第一原理計算で計算して固定値とする<br />
&nbsp; 分子内における多体ポテンシャルは存在するが、異なる分子同士に働く相互作用は2体ポテンシャルのみで表現されることが大半<br />
<br />
□ 最近のポテンシャル<br />
・反応場（原子間ポテンシャル）: 結合の生成・解離を取り扱える。ReaxFFがその一例<br />
・ReaxFF（リアックエフエフ）<br />
&nbsp; レナードジョーンズポテンシャルの250倍程度の計算時間がかかると推定される<br />
・代表的なその他のポテンシャル：ReaxFF, COMB（電荷最適化多体）<br />
<br />
◇ 原子間ポテンシャルについてのその他の事項<br />
・残念ながら、全ての物性値を再現する原子間ポテンシャルの開発は不可能であることが分かっている（第一原理分子動力学を使えばその問題は解決するが計算可能な原子数が通常数百のレベルに落ちてしまう。悩みどころではある）。<br />
・候補となるポテンシャルが選択できたら、それらの物性の再現性の調査を行う。<br />
・重要なことは、計算の目的を明確にして、計算の目的となる現象をポテンシャルが再現しているかという点を調査する。<br />
・目的の現象のみを再現できていればよいというわけではなく、凝集エネルギーや格子定数、弾性定数などのごく基本的な物性の再現も必要である。さもないと構造が不安定になったり、合金などの２元系のポテンシャルへの拡張がしにくくなったりする。<br />
・実績のあるポテンシャルのほとんどでは基本的な物性は再現されている。<br />
<br />
※ 結合距離：2体ポテンシャルの項<br />
※ 結合角：3体ポテンシャルの項（ダイヤモンド構造など）<br />
※ 2面角：4体ポテンシャルの項（ポリマー）<br />
※ 第一原理計算の結果とのポテンシャルの合わせ込み（フィット）<br />
&nbsp; 第一に弾性定数（フォノン）、エネルギー、幾何学構造、その他の物性値はこれらの次にフィットさせることが良く行われる。<br />
※ 大まかな計算コスト<br />
・古典MD: 計算コスト &prop; 粒子数N<br />
・第一原理計算： 計算コスト &prop; 粒子数Nの3乗<br />
&nbsp; （フォースやストレスはエネルギーの微分値であるため、実験値と10%程度の精度のよい計算をしたい場合は多めのk点数やカットオフ値がが必要。弾性定数は2回微分であるためエラーがより大きい）<br />
<br />
□ BMHポテンシャル (NaClなどの計算でよく使われるので別に記載した)<br />
・アルカリハロゲンのMD計算でよく用いられるポテンシャル<br />
・相互作用は vdW + クーロン相互作用<br />
・アモルファスから計算をしても安定な結晶には容易にはならない（膨大な時間が必要）。そのため結晶の計算をする場合は、結晶構造を初期構造として計算する<br />
・パラメータなどについては文献を参照[https://doi.org/10.1016/j.molliq.2017.11.068]。原子Aと原子Bでのポテンシャルは、A-Bの分率で重みづけして係数をきめる<br />
[BMH1] http://www.crl.nitech.ac.jp/~ida/education/ComputerScience/0205.pdf<br />
&nbsp; http://www.crl.nitech.ac.jp/~ida/education/ComputerScience/02_05/5.pdf<br />
[BMH2] https://www.jstage.jst.go.jp/article/kikaia/77/783/77_783_2026/_pdf/-char/ja<br />
[BMH3] Parameters for the BMH potentials. | Download Table<br />
&nbsp; https://www.researchgate.net/figure/Parameters-for-the-BMH-potentials_tbl2_274103796<br />
[BMH4] シリカガラスのバルク密度の温度依存性<br />
&nbsp; http://polymer.apphy.u-fukui.ac.jp/~kuzuu/GroupInside/Thesis/2008/fujisawa/fujisawa_bt.pdf<br />
[BMH5] 分子シミュレーション 夏の学校<br />
&nbsp; http://www.yasuoka.mech.keio.ac.jp/summer2002/download/kawamura.pdf<br />
-----------------------------------------------------------------------------<br />
■ 分子動力学(MD)法の特徴 [K1]<br />
<br />
□ MDから得られる情報<br />
・原子構造、圧力、密度、エネルギー<br />
・弾性率、粘性、拡散係数、イオン伝導<br />
・IR, Raman<br />
<br />
□ MDから得られない情報<br />
・電子構造（バンドギャップ、HOMO, LUMO, 電子伝導）<br />
<br />
□ 計算精度<br />
&nbsp; 多くの粒子数、多くの計算ステップ数、精密なポテンシャルを用いれば、構造や物性は正確にシミュレーションできる。実際には、計算コストの観点から粒子数や計算ステップが制限され、精密なポテンシャルを用意することも難しい。例えば、融解や凝固は核生成（一定のサイズの結晶核など）から始まる現象であるため、それを実現する時間や系の大きさが求められる（融点の場合は、固液界面を作れば界面の移動を見る範囲では核生成は目的としないためより多少計算はし易い）。それを実現するのは容易ではないことがわかる。そのため、計算精度は利用者が結果に満足したところとなる<br />
-----------------------------------------------------------------------------<br />
■ 分子動力学(MD)法とモンテカルロ(MC)法の使い分け<br />
<br />
MD法： 支配方程式は古典力学の運動方程式、決定論<br />
&nbsp; 流体のような原意位置の自由度が大きく、ダイナミックスや非平衡状態が重要な場合に用いる<br />
<br />
MC法： 支配方程式は統計力学のボルツマン分布、確率論<br />
&nbsp; 固体などのような原子位置が有限の自由度を持ち、途中のダイナミックより最終的な平衡状態が重要な場合に用いる<br />
-----------------------------------------------------------------------------<br />
■ 物性の評価に関する基礎知識<br />
<br />
◇ 平衡原子間距離と線膨張係数<br />
・平衡原子間距離は、系の応力がゼロになるときの原子間距離である。<br />
・絶対零度では、ポテンシャル関数により解析的に求めることもできるが、有限温度においては、原子振動により原子間距離が常に変動するため、解析的には求められない。<br />
・分子動力学においては、平衡原子間距離を求めるために、まず、NTPアンサンブルにより、ゼロ応力となるセルサイズの平均値を求める必要がある。<br />
・温度が高くなればなるほど熱膨張するので、平衡原子間距離は大きくなる。<br />
・温度条件を変えたNTPアンサンブルによりセルサイズの温度依存性を計算することで、線膨張係数（線膨張率）を求めることができる。<br />
・線膨張係数には温度依存性があるため、興味のある温度の近くで計算する必要がある。<br />
<br />
◇ 比熱<br />
・定積モル比熱は、温度Tに関する内部エネルギー（全エネルギー）Eの変化の割合である。<br />
・分子動力学で比熱を求める場合は、さまざまな温度において全エネルギーを求めて、温度に対する勾配を計算する。<br />
・固体の比熱は、デューロン-プティの法則により、元素によらず、３＊気体定数となることが知られている。<br />
<br />
◇ 輸送係数<br />
・輸送係数とは、物質拡散や熱の流速とその勾配を対応付ける係数であり、流速　＝　輸送係数　＊　勾配　という関係がある。拡散係数、熱伝導係数、粘性係数などがその例である。<br />
<br />
◇ 動径分布関数<br />
・完全結晶の動径分布関数は、第1ピークから第2と第3と、近接原子に対応してピークが明瞭に観察される。<br />
・アモルファス構造は、第1ピークは変わらないが、第2と第3ピークが統合され、中距離の秩序がなくなる。<br />
・上記のようなアモルファル構造の特徴は、最近接原子との距離は原子間距離によって定まるため結晶と変わらず秩序性があるが、構造の無秩序性のため、距離が離れるにつれ徐々に秩序を失っていくことに起因している。<br />
<br />
◇ 反応<br />
・多くの物理現象は熱活性化過程であり、あるエネルギー障壁を熱エネルギーのアシストで乗り越えることにより現象が進んでいく。<br />
・拡散などの現象が起こる頻度（速度）はR（＝６D/&delta;2）は、下記のように表すことができる。<br />
&nbsp;R ＝ &nu; * exp（-&Delta;E/kBT）<br />
&nbsp; ここで、&nu;は頻度因子、kBはボルツマン定数、Dは拡散係数、&delta;は空孔のジャンプする距離である。<br />
・エネルギー障壁が高い場合、障壁を乗り越える確率は低く、数千、数万振動周期の時間が必要となる。<br />
・エネルギー障壁が高いと、拡散前の状態まわりで単純に熱振動している時間が非常に長く、まれにエネルギー障壁を乗り超えることになる。<br />
&nbsp; このような現象を再現するのに、分子動力学は効率的ではない。なぜなら、拡散が起こる前の熱振動状態が計算時間のほとんどを占めてしまうからである。エネルギー障壁が低ければ（＜0.5eV程度）、十分な計算時間をかければ計算可能であるが、エネルギー障壁が高くなると現実的な計算時間では現象は起こらなくなり、分子動力学の適用が事実上不可能になってしまう。<br />
&nbsp; この解決方法としては下記の３つがある。<br />
<br />
1. 温度を上げて現象を加速する<br />
&nbsp; この方法は、融点以上に温度を上げることができず、温度を上げるとまったく異なる現象（相転移など）が起こる可能性があり、効果は限定的になってしまう。<br />
<br />
2. 反応経路解析<br />
&nbsp; ある原子系の状態を原子座標の３N次元の状態空間上の一つの点と考え、反応（拡散）前の状態の点と反応（拡散）後の状態の点の間にいくつかの中間状態（レプリカと呼ばれる）を設定して、仮想的な弾性バネで結合する。弾性バネで結合することにより、各状態の点は一定の距離を保ちながら反応経路上に配置されることになる。ただし、初期に設定した配置が最小エネルギー反応経路を表しているわけではないので、反応経路と垂直なバネ力を最小化するようにバネを少しずつずらすことによって、最もエネルギーが低い経路を探索する。このような手法は、ナッチド・エラスティックバンド法（NEB法）と呼ばれ、材料系の反応経路解析においては標準的に用いられている。<br />
&nbsp; 実際の計算では、レプリカの設定が大きな課題となり、現象に合わせてさまざまな手法が提案されている。このレプリカの設定手法とNEB法（およびその改良）を合わせて反応経路解析と呼ぶ。<br />
&nbsp; 反応経路解析は、分子動力学の時間スケール（〜ns）では起こらない現象を推測する有効なツールである。<br />
<br />
3. 加速分子動力学法<br />
&nbsp; 反応経路解析では活性化エネルギー&Delta;Eは求められるが、頻度因子&nu;を求めることはできないため、実際にどの程度の頻度で拡散などの現象が起こるかはわからない。すなわち、現象の起こる頻度Rを求めることはできない。<br />
&nbsp; 一方、分子動力学の計算では、活性化エネルギーが低い場合に限られるが、現象が実際に起こるのでRを求めることができる。また、Rの温度依存性のデータの傾きから、活性化エネルギーを求めることができる。しかし、&Delta;Eが高い場合は、分子動力学では現象がまったく起こらないという問題が生じる。そこで、分子動力学を加速するためのさまざまな手法が提案されてきた。フォルターが提案したハイパーダイナミックス法は、原子間ポテンシャル関数Vに何らかのブーストポテンシャル&Delta;V（s）を追加して、現象を速やかに起こすことを目的としている。ここで、sは何らかの原子構造の幾何学的パラメーターである。<br />
&nbsp; Vb ＝ V ＋ &Delta;V（s）<br />
&nbsp; &Delta;Eが高い状態では、深いエネルギー曲面の底に系がトラップされている。そこで、エネルギー曲面の底の部分にブーストポテンシャル&Delta;V（s）を追加して、系の状態を深い底から追い出すことを考える。このブーストポテンシャルは任意に設定可能であり、通常は、何らかの原子構造の幾何学的パラメータsを用いることが多い。たとえば、結合長さが平衡結合長を保たなくするようなバイアスをかけることで、拡散などの原子結合を切る現象を加速することができる。これをボンドブースト法と呼ぶ。<br />
&nbsp; ただし、ブーストポテンシャルが乗り越える先の状態への経路の鞍点（サドルポイント）にかかってしまうと、起こる現象の反応経路と活性化エネルギーを変えてしまうことになるので、その範囲に配慮が必要となる。<br />
&nbsp; ブーストポテンシャルが設定できたら、分子動力学計算を行う。ポテンシャルがかさ上げされている分だけ、早く現象が起こる。これは本来ならば、ポテンシャル井戸の底の部分に滞在する時間をスキップしていることに相当する。計算上は、現在の状態にかさ上げされている&Delta;Vを使って、１MDステップの分子動力学の時間刻み&Delta;tMDが、&Delta;tboostに相当すると解釈する。時間を強制的に進める作業をMDステップごとに行う。<br />
&nbsp; &Delta;tboost ＝ &Delta;tMD * exp（&Delta;V/kBT）<br />
&nbsp; 加速分子動力学は低温でも計算可能である。高温では分子動力学と同じ結果が得られている。加速分子動力学ではハイパーダイナミックス法のほか、メタダイナミクス法などのいくつかの手法が提案され、それぞれ発展している。<br />
<br />
□ 温度・圧力制御の注意点<br />
&nbsp; MC法ではアンサンブルに応じて基準となるエネルギー表式が決まるため問題はないが、MD法は運動方程式を追跡するだけなので本質的に外界と熱のやり取りのないエネルギー保存系の計算であり、いわばNEVアンサンブルしか扱えない。実際に計算結果を実験データと比較するためには温度と圧力をコントロールする必要があり、そのための処方が提唱されている。ただ、それらの処方は必然的に外界との熱のやり取りが必要となるため、運動方程式とは別の操作もしくは新たな支配方程式が加わることになり、その点がMD法の計算結果の信頼性を損ねる一因となっている。<br />
&nbsp; 系の温度は原子の運動エネルギーの総和から常に計算できる。そこで系の温度を設定温度に変えたい時には原子の速度を調整すればよい。その処方としては、<br />
(i) 全原子の速度を一斉に定数倍する（速度スケーリング法 [TP1]）<br />
(ii) 温度を上げたい時には加速、下げたい時には減速する粘性係数的な仮想変数を導入し、その仮想変数の支配方程式は設定温度と系の温度との差に比例して時間変化数する（Nose-Hoover法 [TP1, 2]）エネルギー（ハミルトニアン）はゆらぐが、系のエネルギーと熱浴のハミルトニアンは保存されるのが特徴である。<br />
(iii) 原子の速度を設定温度のボルツマン分布のものとランダムにおきかえる<br />
などがある。どれも一見乱暴なやり方であるが、系が熱平衡に達した時にはどの処方でも（ある誤差の範囲内で）正しい熱平衡分布を与えることが示されている。[TP4]<br />
&nbsp; 圧力制御に関しても似た状況で、周期境界条件を課し、そのセル内での圧力は熱力学のビリアル定理から常に計算できるため、設定圧力と異なる場合には、それに合わせて基本セルの大きさを変えればよい。処方として、<br />
(i) セルの大きさを微少量ずつ変化させる（セルスケーリング法）<br />
(ii) セルのサイズや形そのものを仮想変数として、セル自身の運動方程式は設定圧力と系の圧力との差に比例して形状が変化する形を取る（Anderson法 [TP3]、Parrinello-Rahman法 [TP5]）<br />
などがある。温度・圧力制御ともに仮想変数の変化に伴うオーバーシュートや非現実な相変化が起こりうるため、MD法において非現実的な結果が出やすい部分であるため注意が必要である。<br />
<br />
[TP1] L. V. Woodcock et al., Chem. Phys. Lett., 10 (1971) 257.<br />
[TP2] W. G. Hoover et al., Phys. Rev. A, 31 (1985) 1695.<br />
[TP3] H. C. Anderson et al., J. hem. Phys., 72 (1980) 2384.<br />
[TP4] S. Nose et al., J. Chem. Phys., 81 (1984) 511.<br />
[TP5] M. Parrinello and A. Rahman, Phys. Rev. Lett., 45 (1980) 1196.<br />
-----------------------------------------------------------------------------<br />
■ プログラミングで重要になる知識<br />
<br />
◇ ポテンシャルのカットオフ<br />
・カットオフは、計算結果に影響が出ないように十分に遠くで滑らかに切り捨てる必要がある。単純に切り捨てると、カットオフ距離においてエネルギーの不連続性が生じてしまうため、エネルギー値がカットオフ距離でゼロとなるように関数をシフトする必要がある。これをシフトポテンシャルと呼ぶ。<br />
・単にシフトするだけでは、エネルギー値は連続であっても、エネルギーの微分値（力）が連続ではなくなる。そのため、エネルギーの微分値がカットオフでゼロになるフォースシフトポテンシャルがよく用いられる。<br />
・ポテンシャル関数にカットオフ関数をかけることによって滑らかに切り捨てる方法もよく用いられる。<br />
<br />
◇ ブックキーピング法<br />
・分子動力学では、ポテンシャルのカットオフ距離内の相互作用の計算のみを行う。このため、どの原子がカットオフ距離内にあるかの台帳（ブック）が計算ステップごとに必要となる<br />
・カットオフ距離より少し大きい範囲（この範囲はスキン(skin)と呼ばれる）に存在する原子の番号を台帳に記憶しておき、台帳の外の原子がカットオフ距離内に入ってくる可能性がない間は台帳の更新を行わないことにより、計算量を大幅に削減できる。このような手法をブックキーピングと呼ぶ<br />
・ブックキーピング法は分子動力学の高速化に欠かせない手法である。しかし、台帳の更新間隔、台帳の範囲などを適正に設定する必要がある<br />
<br />
◇ 差分法<br />
・分子動力学では、計算精度を高めるためにさまざまな差分法が提案されている。<br />
・速度ベルレ法：精度が比較的高く計算負荷が低いことからよく用いられる差分法<br />
・ギア法：精度を上げるために、加速度より高次の時間微分量などを用いて、次のステップの状態を決める。加速度以上の高次の微分量の扱いは容易でないため、過去の時刻の加速度を用いる手法が一般的である。ギア法は、ギアの予測子ー修正子法とも呼ばれ、次のステップの予測値をもとに、運動方程式より修正量を計算し、次のステップの修正値を定めている。ギア法は計算負荷は高いが、時間刻みが小さい場合は、ベルレ法より精度が高いことが分かっている。<br />
-----------------------------------------------------------------------------<br />
■ 結晶核の生成 [M5]<br />
<br />
・液体からアモルファスにする時には、急に0 Kにするとおかしな結果になる<br />
・SW(Stillinger-Waber)ポテンシャルを用いて、2.32 g/cm^3の密度のSiを1250 Kでアニールすると、z軸から見て1/4を覆うクラスターの大きさになるのが0.86 nm, 約半分が1.15 nm, ほぼ全てが 1.73 nsとなる。 (P.Beaucage et al., Phys. Rev. B 71 (2005) 094102.<br />
・ガラスは、3000 K などの温度でドロドロにして、急冷することが行われる<br />
・セルの体積は、セルをいったん小さくしてから大きくするとよい<br />
※ 目安の密度：イオン液体（1.3 - 1.5 g/cm^3）<br />
-----------------------------------------------------------------------------<br />
■ Alの多結晶<br />
<br />
&nbsp; 数10nm程度の粒子サイズを境にホール・ペッチ則と逆ホール・ペッチ則が入れ替わることや、亀裂先端から発生した転位が結晶粒界に到達した後、粒界が新たな転位発生源となることを見出している。<br />
<br />
[A1] Shimokawa et al.,<br />
[A2] 日本金属学会関東支部『ここまでできる。計算材料科学入門』<br />
[A3] ホール・ペッチ則 (http://tkkoba.blog.fc2.com/blog-entry-80.html, http://kakiken1984.blog103.fc2.com/blog-entry-146.html)<br />
[A4] 逆ホール・ペッチ則 (http://www.nims.go.jp/apfim/nanostrength.html)<br />
-----------------------------------------------------------------------------<br />
■ 初期配置[I1]<br />
<br />
・分子内、分子間の相互作用を正しく評価したうえで運動方程式を解き、系を時間発展させさえすれば、ランダムな構造から始めたとしても原理的には研究対象となる物質の構造が自然と再現されるはずです。しかしながら、現実に計算できる時間はマイクロ秒であり、タンパク質の折り畳み構造や２重層膜、また結晶や高分子などといった構造形成の時定数の長いものをMD計算の中で作り出すことは不可能です。このため、これらに対してはあらかじめ初期配置として構造を用意して計算を開始しなければなりません。このことは、計算結果は仮定した構造に大きく依存するということでもあり、注意が必要です。<br />
・初期配置としての構造生成ツールは、材料系、高分子系、バイオ系といったように分野ごとにかなり整備されていますが、有料のものも多いようです。全く新しい物質系で計算を始める場合には独力で構造を作らねばなりませんが、これには相当な労力を要すると思ってください。<br />
（省略）<br />
・解析は実験可能な量に限る必要はありません。実験値とのよい一致を確認したうえでMDシミュレーションにおいて初めて可能な解析を行い、分子論を展開するという順序になりますが、実験からは求めることができない量に基づく議論こそ計算の目的であり、研究対象としている振る舞いを表す量を自分で定義し、計算します。物理量としては何でも結構です。<br />
<br />
[I1] 応用物理 第86巻 第11号 p.988 (2017)<br />
-----------------------------------------------------------------------------<br />
■ 引っ張り<br />
<br />
・引っ張りを正か負にするかは分野によって異なる<br />
・機械系は引っ張りを正とする（lammpsとは逆なので注意）<br />
-----------------------------------------------------------------------------<br />
■ 相関関数<br />
<br />
&nbsp; 各種の相関からいくつかの物性を求めることができる<br />
・速度相関：自己拡散係数、振動スペクトル<br />
・回転相関：緩和時間（NMR）<br />
・電流：導電率<br />
・圧力テンソル：粘性係数<br />
・エネルギーフラックス：熱伝導率<br />
※ 熱伝導率はNVEで計算。熱伝導率の計算精度を高めたい場合は、原子数を増やしたり、計算時間（dtではない）を増やしたりする<br />
※ 余談であるが、熱伝導率は平衡状態で計算する方法の他に、計算量が少ない非平衡MDで計算する方法もある。ただし、分子系では非平衡での計算は難しい<br />
------------------------------------------------------------------------------<br />
■ 分子シミュレーション (主に有機物系で用いられるAmber, Gromacs, Charmm, NAMDなど)<br />
<br />
□ 分子シミュレーションの方法<br />
&nbsp; 分子シミュレーションの方法として、主に、分子力学法、分子動力学法、モンテカルロ法の3つがあり、それぞれ扱う原子数Nは数個から数百万個と幅があります。<br />
・分子力学（Molecular Mechanics, MM）法<br />
&nbsp; 力学的な手法。分子系を構成するN個の原子群に働く力をポテンシャルエネルギー関数によって表現します。ポテンシャルエネルギー関数は、以下の4つのエネルギーの成分の和で構成されています。<br />
&nbsp; 1. 分子内の結合の伸縮エネルギー<br />
&nbsp; 2. 結合角の変角エネルギー<br />
&nbsp; 3. 非結合相互作用エネルギー<br />
&nbsp; 4. ねじれ角のねじれエネルギー<br />
&nbsp; ポテンシャルエネルギー関数が作る曲面上の一番低いところが、その分子系の安定構造に相当します。<br />
&nbsp; 4つのエネルギー成分を評価する関数を、その関数を規定するパラメータとあわせて分子力場（Molecular Force Field）といいます。分子力場（あるいは単に力場（りきば））は適用対象によって異なり、用途に応じた経験的パラメータ群として定義されています。<br />
・分子動力学（Molecular Dynamics, MD）法<br />
&nbsp; 分子力学法と同様に力学的な手法ですが、運動方程式を基礎にしている点が分子力学法と異なります。物質系を構成する原子や分子の1つ1つに対する運動方程式を数値的に解き、位置や速度の時間変化やエネルギーなどの変化を追跡します。<br />
・モンテカルロ（Monte Carlo, MC）法 (BOSS: http://zarbi.chem.yale.edu/software.html, etc)<br />
&nbsp; 統計的な手法です。物質系を構成する原子や分子の位置と速度をランダムに変化させ、統計平均から熱平衡状態におけるそれらを求めます。モンテカルロ法で最も有効でよく用いられる手法としてはメトロポリスの方法があります。モンテカルロ法は、熱平衡状態の静的な性質については分子動力学法と等価な結果を与えます。しかし、時間変化や非定常状態を知りたい場合には分子動力学法を用いる必要があります。<br />
<br />
□ 拡散係数<br />
&nbsp; 平均二乗変位（MSD）を時間tに対してプロットし、その傾きを求めれば拡散係数Dとなる<br />
<br />
□ 初期構造<br />
&nbsp; 有機分子系だと、第一原理計算（GAMESSなど）でMP2/6-311G(d,p)レベルで構造最適化した構造とマリケン電荷を分子動力学での構造と電荷に用いたりする。タンパク質などについては下記のPDBを参照してください。<br />
<br />
□ ポテンシャル<br />
・REBO(Reactive Empirical Bond Order)<br />
&nbsp; 炭素や炭化水素の結合の形成と解裂を正確に表現する経験的ポテンシャル<br />
<br />
□ 熱浴制御<br />
&nbsp; 熱浴制御の方法は極めて技巧的であり、どのような計算をしたいのかによって充分注意して正しく選択する必要があります。とくに、非平衡系のシミュレーションを実行する場合には、熱浴制御は大きな問題となります。なぜならば、通常、対象系のエネルギーが、各原子を通して、一律に熱浴エネルギーと結合しているために、熱浴を介したエネルギー緩和が生じてしまうからです。このような場合は、できるだけ対象系を大きくとってミクロカノニカルアンサンブル（NVE）を利用するのが賢明です。しかし、数値計算の特性上、エネルギーを一定に保つことが難しいため、あえてカノニカルアンサンブル（NVT）を利用することもあります。このとき、熱浴との結合は充分小さく設定します。<br />
<br />
□ 化学反応<br />
&nbsp; 調和振動子型のポテンシャル力場を用いている場合、そのままでは反応を取り扱うことは困難です。しかしながら、分子内回転による異性化反応のように結合の解裂を伴わない場合には、調和振動子型のポテンシャル力場でも反応を取り扱うことができます。<br />
&nbsp; Amberでは反応を表現するようなポテンシャル力場を作ることによって反応を取り扱うEVB法がある。<br />
&nbsp; 古典力学の範囲内で化学反応を取り扱うには限界があり、より厳密に化学反応を取り扱うためには電子の量子化が必要になります。分子動力学法では、対象系の中で反応などに伴って大きく電子状態が変わる原子群だけを量子力学的に取り扱い、あまり変わらない他の原子群は古典力学的に取り扱うという量子力学的/分子力学的（QM/MM）-分子動力学（MD）法や、すべての原子群を量子力学的に扱う第一原理分子動力学（ab initio MD）法がよく知られています。現状では、QM/MM法というときの&quot;QM&quot;の意味は、多くの場合電子を量子力学的に扱う必要がある場合も存在します。例えば、水素やプロトンの移動を伴う反応などは、この良い例です。原子核の量子効果は低温で特に顕著になります。<br />
※ 量子力学的/分子力学的（QM/MM）-分子動力学（MD）法 = (QM/MM)-MD法<br />
※ プロトンなど軽い原子核のQM的取り扱いを可能とする方法（経路積分MD法）<br />
<br />
□ 化学平衡<br />
&nbsp; 化学平衡状態は、化学変化を含めたすべての状態についてボルツマン分布が成立すると考えることによって与えられます。分子動力学計算で化学平衡を扱うためには、反応の前後で自由エネルギーを計算する必要があり、一般にその計算は非常に困難です。<br />
<br />
□ 分子凝縮系<br />
&nbsp; 分子凝縮系とは、液体及び固体の状態のように、構成する分子が多数集まって密な状態にある分子集合系を指す。孤立分子系や気相分子系と比べて、分子凝縮系では考慮をしなければならない分子数が桁違いに多くなる。そのため、孤立分子系や気相分子系ではできよう可能であった計算方法にも様々な制約が存在したり、適用することさえ不可能であったりする。そこで、モデルに対しては周期境界条件、計算方法に対してはエネルギーカットオフやエワルド（Ewald）法といった工夫を凝らす必要がある。<br />
&nbsp; 計算条件の設定で注意すべき点は、アンサンブル、温度制御、周期境界条件、圧力制御、カットオフやエワルド法の採用などに関係するパラメータなどである。<br />
&nbsp; 一例としては、SHAKE法による水素原子を含む結合の拘束、NVTアンサンブル、カットオフ距離9.0Å、全計算時間 100 ps、時間ステップ 0.5 fs、初期温度 500 K, 設定温度 300 Kなどで計算したりする。<br />
<br />
□ 自由エネルギー<br />
&nbsp; 一般に、自由エネルギー摂動法の方が、熱力学的積分法よりも自由エネルギー計算の精度が良いと言われている。しかし、化学反応を扱う場合には、対象系の状態（相互作用や分子構造）を変化させる刻み幅を熱力学的積分法よりも小さくする必要があるため、計算時間がその分だけ大きくなる。<br />
<br />
□ エワルド計算<br />
&nbsp; 分子シミュレーションにおいて最も計算時間を要する部分は、クーロン静電相互作用の計算です。水中のタンパク質のような大きな対象系の計算を、周期境界条件下で行う場合、演算量を軽減するために、クーロン相互作用の及ぶ範囲を適当な距離で打ち切ってしまうカットオフ法が過去には広く用いられてきました。しかし、現実には遠距離まで及ぶ相互作用を特定の距離で切断してしまうカットオフ法では様々な問題があるため、信頼性の高い結果を得ることができない。そこで、現在はエワルド（Ewald）法やその高速化版であるパーティクルメッシュエワルド（Particle Mesh Ewald, PME）法が広く用いられています。<br />
&nbsp; エワルド法では全体の電荷が0であることが望ましい（0でないとエネルギーが発散してしまうため）。そんため、それを中和するだけの数のイオン（カウンターイオン）を、対象系内に配置する方法がよく用いられている。<br />
・パラメーター (Amberでは自動的に最適化される)<br />
&nbsp; 電荷の広がりを決定する係数&alpha;： 大きいほど実空間での0への収束は速く、逆空間での収束は遅くなる。逆もまたしかり。<br />
&nbsp; 実空間におけるカットオフ距離<br />
&nbsp; 逆空間における整数ベクトルの絶対値の最大値<br />
・kspace_style [30]<br />
&nbsp; 長距離相互作用の計算はｋ空間で行う。pppmはparticle-particle-particle-mesh Ewald法を意味しており、を意味しており、原子数が大きな系では計算時間がEwald法よりも速くなるという利点がある。Ewaldは通常のEwald法を使用します。その次の数字は許容される計算誤差で小さい方が精度が高く計算できる。<br />
<br />
□ 一般化ボルン（GB）モデル<br />
&nbsp; 連続体モデル（溶媒水を均一な誘電率&epsilon;を持った連続体として扱うモデル）<br />
&nbsp; 連続体モデルは溶媒水分子のミクロな性質がまったく無視されてしまうので、その適用範囲は生体高分子の水溶液系のように全原子動力学シミュレーショの実行が困難な場合によく適用される（個々の溶媒分子を陽に取り扱うのが不可能な場合に、より現実的なシミュレーションを実行するのに用いられる)。<br />
<br />
□ SHAKE法とRATTLE法<br />
-----<br />
・SHAKE法<br />
&nbsp; SHAKE法は指定した原子間の距離を指定した一定値に拘束する手法です。ラグランジュの未定乗数法がこの手法の基礎となっており、タンパク質のように原子数の大きな対象系でも、計算時間がそれ程かからないように工夫されている。<br />
-----<br />
・RATTLE法<br />
&nbsp; 原子間の距離に加えて各原子の速度が、拘束される原子間距離を変化させない速度になるように、速度に関しても束縛を行う。<br />
-----<br />
&nbsp; SHAKE法（あるいはRATTLE法）を適用して、水素原子を含む化学結合の結合長を拘束して分子動力学計算を行うことで、より長い積分時間刻みで安定に数値積分を行うことが可能となります。<br />
&nbsp; 一般にSHAKE法（あるいはRATTLE法）を用いない場合は、0.2 fsから最長でも1.0 fsの短い時間刻みが必要とされるのですが、SHAKE法（あるいはRATTLE法）を用いることで2.0 fsまで積分時間刻みを長く取ることができる。これは水素原子が軽いために、それを含む分子振動の周期が短くなることに由来している。<br />
&nbsp; 例えば、水分子のO-H振動はおよそ3800 cm^-1の振動数であり、これを振動周期に直すと約10 fsとなる。これを2 fs, 0.2 fsの積分刻みで数値積分していくと、それぞれ1周期を5点、50点で積分していくことに相当する。<br />
&nbsp; （5点のように）粗すぎる積分刻みを用いると、振動を正しく積分していくことができない上、保存しなければならない対象系全体のエネルギーなども保存されなくなってしまう。そこで周期が10 fsという時間スケールの短い水素元素を含む分子運動をSHAKE法（あるいはRATTLE法）で拘束して、原子間結合長を平均値に固定することでこの問題を回避している。他の原子については、質量が重いせいで周期が長くなるため、実際上SHAKE法（あるいはRATTLE法）を適用しない場合が多々ある（例えば、調和振動子近似で考えると、C-C結合の換算質量はC-H結合の約6倍なので周期はその平方根である2.4倍程度となる）。このような振動周期と分子動力学計算の精度を議論した上で、積分時間刻みを最長7 fsまで長くすることができる手法を議論している論文が発表されている。<br />
&nbsp; 水素原子を含む結合の結合距離を平均値に固定することには、数値積分精度の他にもう一つの意味がある。文献[10]に記載されているので参照してください。<br />
<br />
□ タンパク質構造データバンク（PDB）<br />
&nbsp; タンパク質やDNAに代表される生体分子の立体構造は、X線結晶構造解析、核磁気共鳴（NMR）等の実験手法により測定されています。得られた構造の多くはタンパク質構造データバンク（Protein Data Bank, PDB）に登録されており、自由に利用可能です。なお、各々の構造ファイルには「101M」のような4文字の数字とアルファベットからなるPDB IDが割り当てられています。<br />
&nbsp; PDBで立体構造が欲しいタンパク質等の名前をキーワードとして検索し、構造ファイルを探します。1つのタンパク質名で検索しても、いくつかのPDBファイルが候補として表示されます。これらは、<br />
1. pHや温度等の実験条件が異なる<br />
2. いくつかのアミノ酸が置き換えられている変異体である<br />
3. 実験手法が異なる（X線やNMR, 中性子回折等）<br />
4. 構造の精度が異なる<br />
5. 生物の種が異なる<br />
というように、測定条件やアミノ酸配列が異なっているので、どの構造ファイルを使用するのかは注意深く選ぶ必要があります。<br />
<br />
□ 平衡化計算の方法<br />
&nbsp; 研究目的に応じて、低温もしくは高温を初期温度とした設定温度での平衡化計算を行います。例えば、結晶のように秩序だった構造を扱いたい場合には、構造が壊れないように低温から平衡化を行うのが望ましいでしょう（下記のタンパク質などので平衡化計算の方法を参照）。そうでない場合には、高温から平衡化を行うのが通例です。（※ 温度やエネルギーなどでの時間変化が一定の値になった平衡状態への到達を確認した後、熱力学的物理量の計算などを始めます）<br />
<br />
□ タンパク質、DNA, RNA, 糖鎖といった生体分子の分子動力学計算の手順<br />
-----<br />
◇ 初期構造の準備<br />
&nbsp; 生体分子において立体構造は機能を発現する上で非常に重要となる。タンパク質は正しくフォールドした天然構造でなければその機能を発現することができないため、熱や酸等により天然構造が壊れてしまうとその機能を失ってしまう。そのため、計算を行う際には、適切な初期構造を用意する必要がある。そこで初期構造を得るデータバンクであるPDBが使われる。<br />
&nbsp; 系にどれだけの数の水分子を含めれば良いのかは難しい問題であり、はっきりと答えることはできません。過去に発表されている分子動力学計算の論文と同程度の数を含めておくとよい。<br />
◇ エネルギー最小化と平衡化計算<br />
&nbsp; 通常、初期構造にはX線結晶解析やNMR測定によって得られた構造を使用しますが、これらの実験構造には、原子同士がファンデルワールス（van der Waals, vdW）半径に比べて異常に接近しているなど、ポテンシャルエネルギー的に非常に不安定な構造の歪みが含まれている場合があります。このような不具合を残したまま分子動力学計算を実行すると、その歪みのせいで非常に大きな力が働いてしまい、タンパク質の構造が壊れてしまう可能性があります。そのため、事前にエネルギー最小化と平衡化計算を実行して歪みを取り除いておくことが重要になります。<br />
・エネルギー最小化<br />
&nbsp; エネルギー最小化の目的は構造の歪みを取り除くことなので、各原子にかかる力が0になるまで最小化を続ける必要はありません。例えば、200ステップで終了したりします<br />
(エネルギー最小化がうまくいかない場合は、エネルギー最小化のステップ数を増やしたり、初期座標を変更したりするなどの工夫が必要になる)<br />
・平衡化計算<br />
&nbsp; エネルギー最小化で構造の歪みを取り除いた後は、例えば、以下の2つの手順が行われたりする<br />
1. 溶媒のみの平衡化<br />
&nbsp; 溶質は固定して溶媒分子群のみを自由に運動させる（計算条件： NPT、2 fs, 5000 step, 300 K, SHAKE法）<br />
2. 対象系全体の平衡化<br />
&nbsp; 全体を自由に運動させる（計算条件： NPT、2 fs, 合計20000 step, 初期温度を0 Kからはじめて20 ps（10000 step）かけて300 Kまで上昇させる, 300 Kでは20 ps(10000 step)計算する, SHAKE法）<br />
&nbsp; このように徐々に温度を上げることで初期構造が壊れるのを防ぐようにしている<br />
・上記の方法以外の平衡化手順がある<br />
&nbsp; 例えば、「対象系全体のエネルギー最小化」では、溶質タンパク質のみで最小化を行い、次に溶媒を含む対象系全体を最小化するという手順も考えられる。「溶媒の平衡化」では、溶質を完全に束縛した平衡化計算の後で、溶質全体を緩く束縛して平衡化計算を行う、あるいは主鎖のみを束縛し側鎖は自由に動ける条件で平衡化計算を行い、徐々に溶質を平衡化する手法もある。他にも様々な平衡化手順のバリエーションが考えられますが、どの手法が最も良いかという判断は難しいので、平衡化手順は先行研究の文献を参照して決定するのが無難です<br />
-----<br />
◇ 糖鎖<br />
&nbsp; 糖鎖は、細胞のシグナル伝達や分子認識などの生理機能を持つ重要な生体高分子です。柔軟な立体構造を持ち、NMRなどの分光学的手法だけでは構造解析が難しい場合が多いため、分子シミュレーションの併用が重要視されています。<br />
&nbsp; 多くの糖鎖は、溶液中の立体構造が不明なので、結晶状態の構造を用いるか、糖鎖中で隣接する残基間のラマチャンドランマップ（二面角（&Phi;,&Psi;）に対する構造エネルギーを図にしたもの）で見出される最も安定なグリコシド結合角を用いて糖残基を連結していき、糖鎖の立体構造を構築する。得られた構造を初期構造として、タンパク質の場合と同様に、エネルギー最小化と平衡化計算を行っていく。<br />
<br />
□ タンパク質の天然構造<br />
&nbsp; PDBから構造ファイルをダウンロードしてフォールドした初期構造を取得する以外に、アミノ酸配列のみから初期構造を生成し、分子力学計算を実行することも可能です。しかしながら、そのタンパク質の天然構造を分子動力学計算により正しく予測することは極めて難しい<br />
<br />
□ 水素イオン濃度とイオン化状態<br />
&nbsp; 特定のpHの環境を指定することが理論上は可能です。しかしながら、例えばpH7の中性環境ではH+の濃度は水H2O 1000万分子に対して1分子という比率になｒ、現在の分子動力学計算で現実的に扱える水分子の分子数をはるかに上回る分子数を取り扱って初めて可能な濃度であることがわかります。つまり通常のpH7の水は現状では計算不可能なのです。そこで、現状では溶質分子のプロトン化状態をあらかじめ指定することで、pH条件を再現したことにしています。<br />
&nbsp; タンパク質を構成するアミノ酸は、水中でイオン化して酸（プロトン供与体）あるいは塩基（プロトン受容体）として働くことができます。アミノ酸が脱プロトン化するかプロトン化するかは溶液のpHによります。そこで、側鎖が解離性の原子集団である残基については、プロトン化状態を指定することで周囲の溶媒のpHを実際上反映できることになります。側鎖に解離性原子集団をもつ残基は、ヒスチジンやシステインなどが挙げられます。<br />
◇ pKaの見積もり方<br />
&nbsp; 解離性の原子集団をもつ残基周囲のpKa値は PROPKA（http://nbcr-222.ucsd.edu/pdb2pqr_2.0.0/ や https://github.com/jensengroup/propka-3.0）で見積もることができます。<br />
&nbsp; PDFファイル内の残基名HISをその残基のpKaが指定したいpHよりも小さい数字ならばHIEかHIDに、そうでないならHIPに置き換えます。なお、HIDとHIEのどちらを選ぶべきかについては難しい問題です。周囲の残基との水素結合の存在などを考慮して決定する必要があります。<br />
<br />
□ ジスルフィド結合<br />
&nbsp; ジスルフィド結合とは、2つのシステイン残基側鎖の-SH基が酸化的に結合し、-S-S-架橋を形成したものです。この結合は非常に強固であり、タンパク質の三次構造を強く束縛することになります。この性質を利用して、実験やシミュレーションで、特定の部位の残基をシステインに変異させることでジスルフィド結合を人工的に導入し、立体構造をある構造に固定したり、構造の安定性をより高めたりすることが行われています。<br />
<br />
□ 変異体<br />
&nbsp; タンパク質は、ペプチド結合によりあ数のアミノ酸が連結されて形成されている。元のアミノ酸配列からなるタンパク質を野生体（Native）と呼ぶ一方、解く知恵のアミノ酸を他のアミノ酸に置換したものを変異体（Mutant）という。変異体は「L29F Mutant」のように表記される。これは29番目のL（ロイシン）をF（フェニルアラニン）に置換した変異体を表している。複数の残基を変異させた場合は「H97D D122N Mutant」のように表記する。<br />
&nbsp; 変異体を合成し、その構造や機能がどのように変化するかを調査することで、フォールディング過程や機能発現等に、どのアミノ酸残基が重要な役割を果たしているかを調査する実験が活発に行わている。フォールディングや機能発現において非常に重要な残基を変異させると、構造や機能活性が大きく変化し、逆にさほど重要性のない残基であれば、変異が構造や機能に与える影響はほとんどありません。また、一般に難しいタンパク質の結晶化を容易にするために、機能に重要でない溶媒に露出しているアミノ酸を置換させる場合もある。<br />
<br />
□ RMSフィット<br />
&nbsp; 2つの異なる構造に対して計算される根平均二乗偏差（Root Mean Square Deviation, RMSD）が最小になるように一方の構造を並進・回転させ、構造がなるべく重なり合うようにする操作<br />
<br />
□ コンタクトマップとDifference Distance matrix<br />
・コンタクトマップ<br />
&nbsp; 全ての残基間の組み合わせに対して残基間の距離をプロットしたもの。<br />
&nbsp; Rij = distance(i,j)<br />
&nbsp; ここでiとjは残基番号、distance(i,j)は残基i,j間の距離を返す関数<br />
・Difference Distance Matrix (DDM)<br />
&nbsp; 2つの構造A, B間でコンタクトマップがどれだけ変化しているかをプロットしたもの。<br />
&nbsp; RABij = distnceA(i,j) - distanceB(i,j)<br />
&nbsp; ここでdistanceA, distanceBはそれぞれ構造A, Bでの残基間の距離を返す関数。<br />
<br />
□ タンパク質のフォールディング<br />
&nbsp; 多くのタンパク質はリボソームによって合成された後、水中で自発的に構造を変形させ、最も自由エネルギーの低い立体構造に巻き戻る。この過程をタンパク質のフォールディング（折り畳み）と呼ぶ。タンパク質がフォールディングし終わった状態を天然（Native）状態と呼び、またその構造を天然構造という。タンパク質は、天然構造になって初めて本来の生理的機能を発現するので、その立体構造の詳細を知ることは、アミノ酸の配列しかわからないタンパク質の機能を推定したり制御したりするために大変重要となる。天然構造の推定については、X線やNMRなどによる分光学的手法に加えて、分子シミュレーションによる非経験的な方法に大きな期待が寄せられています。<br />
&nbsp; タンパク質のフォールディングを駆動する物理化学的な要因として、疎水性相互作用や、水分子の並進エントロピーによる効果などが考察されてり、何が最も支配的な要因であるかについては、もっとも活発な議論の最中です。しかし、原子間相互作用を正しくモデリングし、長時間の計算を厭わなければ、自由エネルギーの最も低い構造にたどり着くことは、統計熱力学的にも自然な結果として期待できる。<br />
&nbsp; 最も直接的な方法は、目的のタンパク質のアミノ酸配列に従って、ポリペプチドを構築して、周囲に水分子群を配置し、そのまま平衡分子動力学計算を長時間実行する。しかし、この方法では無数にあるエネルギー極小の状態に留まってしまうため、最も安定なエネルギー状態にたどり着く前に多くの時間を必要としてしまう。そこで拡張アンサンブル法が用いられている。拡張アンサンブル法は、非ボルツマン因子による人工のアンサンブルに基づいてシミュレーションを行う方法で、ポテンシャルエネルギーの変動が大きく、対象系が特定のエネルギー極小状態に長時間留まることがないので、既存の方法よりもはるかに幅広い自由エネルギー曲面を探索できる。Amberでは拡張アンサンブル法の1つであるレプリカ交換分子動力学法を用いることができる。<br />
&nbsp; Amberのwebサイトに公開されているオンラインチュートリアルには、ff99力場を用い、直鎖状のポリペプチドの初期構造から、Trp-Cageモチーフへのフォールディングを再現する手法が解説されている。一般化ボルン法によって取り扱われ、約20 ns程度で、天然構造に近い構造が出現することが見込まれているが、計算の丸め誤差や計算機環境の違いによって文献どおりの結果が得られない可能性がある<br />
<br />
□ リガンドと受容体<br />
&nbsp; 酵素などのタンパク質の機能発現部位（活性部位）に結合し、分解される基質や、酵素としての機能を阻害する低分子などおｗ一般的にリガンド（ligand）と呼び、それを受け入れるタンパク質などの大きな生体高分子を、受容体（receptor）という。リガンドと受容体がどれほど結合しやすいかを定量（熱力学）的に見積もることは、新規薬剤の開発や、既存の薬剤分子の高機能化を戦略的に進めるうえで非常に重要となります。<br />
<br />
□ 脂質膜<br />
&nbsp; 脂質膜とは両親媒性を持つリン脂質により形成されている膜です。生体内では多種多様な膜タンパク質が脂質膜に付着しており、生体機能の発現に重要な役割を果たしています。<br />
&nbsp; 脂質膜はリン脂質分子（リン脂質1分子は100原子以上）を多数含める必要があり計算コストがかなり大きくなる。<br />
&nbsp; Amberでは汎用力場GAFFを元に力場を生成する。Charmmでは脂質膜の力場が整備されている。そのため、多くの脂質膜系の分子動力学計算がCharmm力場により実行されている。<br />
<br />
□ Water cap<br />
&nbsp; 溶質を中心としてその周囲に溶媒を球状に配置して計算する方法。Droplet法とも呼ばれる<br />
<br />
□ トラジェクトリ<br />
&nbsp; 分子動力学計算で得られた経時情報（位置と速度の軌跡）<br />
<br />
□ 溶媒和<br />
&nbsp; 溶媒和とは、溶質分子やイオンがいくつかの溶媒分子群に取り囲まれて1つの集団を形成した状態をいいます。溶媒和は溶媒分子などと溶媒分子との相互作用によって生じ、溶質分子やイオンは最終的に溶媒中に拡散して均一に分散します。特に、溶媒が水である場合には水和といいます。アンモニアのように極性を持った溶質分子が、極性溶媒に溶けやすいのは、極性分子どうしは静電引力相互作用により引き付け合って溶媒和し易いためであり、無極性溶媒に溶け難いのは互いに引き付け合わずに溶媒和がほとんど起こらないためです。<br />
<br />
□ 溶媒露出面積（Solvent Accessible Surface Area, SASA）<br />
&nbsp; 溶媒和自由エネルギーは、厳密には、遠距離まで及ぶタンパク質と溶媒分子群との静電的な相互作用に加えて、タンパク質周囲の溶媒分子群の再配向やダイナミクス改変に伴うエントロピー変化などを考慮して計算する必要がある。<br />
&nbsp; 溶媒和自由エネルギーはタンパク質の溶媒露出面積（SASA）、すなわち溶媒に接しているタンパク質の表面積に大まかに比例することが経験的に知られている。<br />
&nbsp; SASAは溶液中におけるタンパク質やその他の生体高分子の熱力学的安定性を近似的に見積もる際の良い指標の1つといえる。<br />
&nbsp; SASAは溶媒分子を表す球を、溶質を構成する各原子の球面（一般的にはファンデルワールス（vdW）球面）に接して動かした場合に、その溶媒分子の球の半径をrs（水分子の場合は一般的に1.4Åに設定する）とし、半径riの大きさを持つ原子iの中心から、半径Ri = ri + rs の球面を設定したときに、他の原子が張る同様の球面によって覆われずに外部に露出する表面の面積が原子iの担う用場吐出面積Aiとなる。さらにAiを各原子について計算し、総和をとったものが、溶質全体のSASAとなる。<br />
・GETAREA: http://curie.utmb.edu/getarea.html<br />
・MGLTools: http://mgltools.scripps.edu/packages/MSMS<br />
<br />
□ &alpha;ヘリックスと&beta;シート<br />
&nbsp; タンパク質は、アミノ酸がペプチド結合して鎖状につながった高分子化合物であり、各々固有の立体構造（天然構造）を持っている。その立体構造はタンパク質が機能を発現する上で重要な役割を果たしており、4つのレベル（一次〜四次構造）に分けて理解することができます。<br />
&nbsp; 一次構造（primary structure）とは、タンパク質を構成するアミノ酸の配列順序のことを指します。次いでポリペプチド鎖中の限定された領域に出現する繰り返し構造を二次構造（secondary structure）と呼びます。二次構造として有名なものが&alpha;ヘリックスや&beta;シートである。さらに上級の三次構造（tertiary structure）はポリペプチド鎖全体の三次元的な空間配置を表します。そしてタンパク質の中には1本のポリペプチド鎖からなってるものの他に、複数のポリペプチド鎖が集合して1つのタンパク質を形成している場合があり、これを四次構造（quaternary structure）という。この場合、各々のポリペプチド鎖のことをサブユニットと呼ぶ。<br />
・&alpha;ヘリックス<br />
&nbsp; &alpha;ヘリックスとは、ポリペプチド主鎖がらせん状の立体配置をとる構造です。繰り返し単位はらせんを1回転するのに長軸方向で約0.56 nmであり、3.6個のアミノ酸が含まれている。&alpha;ヘリックスの内部には水素結合が形成されるため、エネルギー的に安定な状態であるといえ、球状タンパク質の多くに多数依存します。ただし、ポリペプチド鎖がいつも&alpha;ヘリックスを形成するというわけではない。例えば、アミノ酸側鎖に正または負電荷が多数連続して存在すると、静電的な反発が生じて&alpha;ヘリックスの形成が妨げられることになる。<br />
&nbsp; 通常のヘリックスでは4つ前の残基と水素結合を形成していますが、時にはヘリックスの巻き具合がきつくなっており、3つ前の残基と水素結合を形成している場合（310ヘリックス）や逆に巻き具合がゆるいため5つ前の残基と水素結合を形成している場合（&pi;ヘリックス）もある。<br />
・&beta;シート<br />
&nbsp; &beta;シートは、平行に配置されたポリペプチド主鎖が、鎖間または鎖内のいずれかで水素結合を形成して固定された構造。隣り合ったポリペプチド鎖が同じ向き（N末端からC末端への配列の向きが同じ）に並んでいる場合を平行&beta;シートと呼び、互い違いの向き（N末端からC末端への配列の向きが逆）に並んでいる場合を逆平行&beta;シートという。<br />
<br />
[10] 長岡正隆ら「すぐできる分子シミュレーションビギナーズマニュアル」KS化学専門書<br />
[30] 分子動力学計算（LAMMPS）<br />
&nbsp; https://mochirixi.hatenadiary.com/archive/category/分子動力学計算%EF%BC%88LAMMPS%EF%BC%89<br />
------------------------------------------------------------------------------<br />
■ 分子動力学<br />
<br />
&nbsp; 分子動力学（Molecular Dynamics: MD）法は（水素も含めて量子効果は小さいと仮定して）ニュートンの運動方程式を基礎方程式とする物理原理に基づいたシミュレーションですが、温度をもつ集団系が研究対象となっているために考慮しなければならない因子が多くあり、量子化学計算や第一原理計算などの電子状態計算と比べて相当に複雑なシミュレーションになっています。<br />
<br />
&nbsp; 分子の形を作る手法に、原子間に距離拘束を課す方法があります。ラグランジュの未定乗数法を用い、ラグランジュの未定乗数は（距離）拘束が満足されるように数値的に決めます。水分子の場合のように複数の拘束が影響し合っている場合には連立方程式として求めなければなりません。これを反復法によって解くものがSHAKE法と呼ばれ、最も一般的に用いられている方法です。振動数が大きく計コストの高い水素の分子内振動は無視して、距離拘束により水素原子との結合距離を固定して計算することが多いように思います。<br />
&nbsp; 初期配置としての構造生成ツールは、材料系、高分子系、バイオ系といったように分野ごとにかなり整備されていますが、有料のものも多いようです。全く新しい物質系で研究を始める場合には独力で構造を作らなければなりませんが、これには相当な労力を要すると思ってください。<br />
<br />
&nbsp; 温度と圧力の制御にもいくつかの手法が用いられている。これらはそれぞれ近似のレベルが異なり、統計力学的基礎を有するものからそうでないものまであります。最も信頼できる制御法は熱浴（能勢の方法）とピストン（アンダーソンの方法）に相当する付加的な自由度を系に与えて運動方程式を解く。両者の組み合わせにより系は正しいNPTアンサンブルを生成することが統計力学的に証明されている。これらの方法には、それぞれいくつかの派生的な方法がある。どの手法を用いているかはソフトに依存する。<br />
<br />
[11] 岡崎進、応用物理、第86巻、第11号（2017）<br />
------------------------------------------------------------------------------<br />
■ グランドカノニカルモンテカルロ（GCMC）法 [18, 19]<br />
<br />
・乱数により系の状態を生成し、各状態の物理量をサンプリングすることで熱的平衡状態における特性を評価する統計的手法<br />
・原子や分子の挿入、消去、回転、移動などを行って、これらの操作の前後のエネルギー差を計算し、その操作を採用するか止めにするかを乱数を用いて繰り返していく<br />
<br />
・温度を一定にして特定の化学ポテンシャル、つまり気体圧力下で、表面上に許される気体分子数（吸着量）を統計力学原理で決定する。次々に圧力を変えながら吸着量を求めると吸着等温線が得られる<br />
<br />
・文献[21]はMUSIC(http://zeolites.cqe.northwestern.edu/Music/music.html#DOWNLOAD)での入力ファイル<br />
・文献[22, 23]はLammpsでの入力ファイル。何れも修正が必要<br />
------------------------------------------------------------------------------<br />
■ 分子動力学でよく使われる計算条件 [9]<br />
<br />
・総ステップ数： 5000 - 10000 steps<br />
&nbsp; 100000 steps (NEV, NTP)（緩和、セルサイズ算出、本計算）<br />
・時間刻み幅： 0.5 - 1.0 fs<br />
&nbsp; 水素などの軽い原子: 0.1 fs<br />
&nbsp; 固体系: 0.5 - 5 fs<br />
・出力間隔： 100 step&nbsp;<br />
・温度： 298 K<br />
・圧力： 1 atm = (0.101325 MPa)<br />
・boxの大きさ: 17.62 Å以上<br />
&nbsp; この値にならない場合は&quot;replicate&quot;でboxを大きくする<br />
・ブックキーピングの球殻の厚さ(dr): 0.2 Å（固体）、0.5 Å（液体）<br />
※ 値を変える場合、[総ステップ数 * 時間刻み幅]となるようにされていたりする<br />
※ MDでは計算開始から数十psの計算結果は評価に使わない。ポテンシャルエネルギーなどで収束をチェック<br />
※ 時間刻み幅（timestepはディフォルトで1.0 fsになっている。ディフォルトは妥当な値）。軽い原子ほど時間刻み幅は短くする。重い原子になるほど時間刻み幅を長くしても精度のよい計算が可能になる（振動周期が長くなるため）<br />
<br />
[9] 泉聡志ら『実践分子動力学シミュレーション』森北出版<br />
-----------------------------------------------------------------------------<br />
■ References<br />
<br />
[M1] 泉聡志ら『実践分子動力学シミュレーション』森北出版<br />
[M2] 日本金属学会関東支部『ここまでできる。計算材料科学入門』<br />
[M3] 原子間ポテンシャルについて<br />
&nbsp; http://www.cmsm.iis.u-tokyo.ac.jp/documents/ポテンシャル関数について_2018_01.pdf<br />
[M4] 日本材料学会分子動力学部門委員会<br />
&nbsp; http://www.hpci-office.jp/materials/ws_material_161004_izumi.pdf<br />
[M5] Introduction to Molecular Dynamics simulation<br />
&nbsp; https://westgrid.github.io/manitobaSummerSchool2018/md-slides.pdf<br />
------------------------------------------------------------------------------<br />
■ References<br />
<br />
[1] 講習会資料<br />
&nbsp; http://md.jsms.jp/download/<br />
[2] LAMMPSで構造最適化<br />
&nbsp; https://justice-vsbr.hatenablog.com/entry/2018/08/02/101057<br />
&nbsp; 色々と試して何が問題化を明らかにしてくださっているのでとても助かる<br />
[3] 6.12. MD ? LAMMPS メニュー (Winmostar User Manual)<br />
&nbsp; https://winmostar.com/jp/manual_jp/V9/html/winmos/md/winmos_lammps.html<br />
[4] 分子動力学計算を活用したインシリコ創薬<br />
&nbsp; https://www.r-ccs.riken.jp/aicssite/wp-content/uploads/2016/05/20151202hirokawa.pdf<br />
&nbsp; https://www.r-ccs.riken.jp/course/life_science2_2.4.html (動画)<br />
&nbsp; https://www.youtube.com/watch?v=UBW1TxwfqhE (Youtube動画)<br />
[5] LAMMPS入門の手引き 0:環境の設定<br />
&nbsp; https://qiita.com/tkmtSo/items/34a0098cb967f2a9fdfe<br />
[6] LAMMPS入門の手引き 1:静的な計算<br />
&nbsp; https://qiita.com/tkmtSo/items/e43220cd9bbb7634af34<br />
&nbsp; ・velocityコマンドは原子に強制的に初速を与えるコマンドです。はじめが0ケルビンだと全く動かないため、初速を適当に与える意味があります。<br />
&nbsp; ・minimizeはrunコマンドと似ていますが、動力学計算を行うのではなく、よりエネルギーが低くなるように原子を動かすコマンドです。なので、minimizeが終わったときはエネルギーが(局所)安定点に達した構造が得られることが期待されます。つまり0ケルビンのときの構造です。デフォルトはCG法が使われています。<br />
&nbsp; ・fix nvtコマンドは系にNVTアンサンブルを適用するコマンドです。つまり温度制御をかけます。後ろの3つの値は「MD開始時の熱浴の温度」「MD終了時の熱浴の温度」「熱浴の順応性」です。3つ目の値が少し直感的でない値ですが、曖昧に表現すると(人工的な)熱浴に対する慣性のようなパラメータです。おおよそtimestepで設定した値の100倍くらいにしておけば大丈夫です。(圧力制御の場合は1000倍程度)<br />
[7] Input files: samples<br />
&nbsp; http://www.phonon.t.u-tokyo.ac.jp/people/~ohnishi/lammps.html<br />
[8] LAMMPS tutorial<br />
&nbsp; https://icme.hpc.msstate.edu/mediawiki/index.php/LAMMPS_tutorials<br />
[9] 泉聡志ら『実践分子動力学シミュレーション』森北出版<br />
[10] 長岡正隆ら「すぐできる分子シミュレーションビギナーズマニュアル」KS化学専門書<br />
[11] Molecular Mechanics (MM) 計算（z軸方向のみの緩和）<br />
&nbsp; http://www.phonon.t.u-tokyo.ac.jp/people/~ohnishi/lammps2.html<br />
&nbsp; LAMMPS/examples/USER/phonon/3-3D-FCC-Cu-EAM/<br />
&nbsp; https://github.com/CFDEMproject/LAMMPS/tree/master/examples/USER/phonon/3-3D-FCC-Cu-EAM<br />
[12] Examples (LAMMPS calculations)<br />
&nbsp; http://abelcarreras.github.io/DynaPhoPy/examples.html<br />
[13] DynaPhoPy (Phonon anharmonic properties from Molecular Dynamics)<br />
&nbsp; http://abelcarreras.github.io/DynaPhoPy/index.html<br />
&nbsp; https://pypi.org/project/dynaphopy/1.16.4/<br />
[14] PhonTS<br />
&nbsp; http://phonts.mse.ufl.edu/<br />
[15] LAMMPS ? Installation&nbsp;<br />
&nbsp; http://www.nanophysics.pl/MolecularDynamics/lammps-installation.pdf<br />
[16] EAM potentials (Phonon Dispersion Curves)<br />
&nbsp; https://sites.google.com/site/eampotentials/Al<br />
[17] GCMC<br />
&nbsp; https://lammps.sandia.gov/threads/msg53394.html<br />
[18] 新規モンテカルロ計算プログラムの開発と各種触媒系への応用<br />
&nbsp; http://www.aki.che.tohoku.ac.jp/prev/htm5/2b16petro.pdf<br />
[19] 分子吸着による固体表面ナノ構造解析<br />
&nbsp; https://www.scas.co.jp/scas-news/sn-back-issues/pdf/14/talk_14.pdf<br />
[20] LAMMPS input for water (Avogadro)<br />
&nbsp; https://avogadro.cc/docs/extensions/lammps-input-for-water/<br />
[21] Understanding the adsorption process in ZIF-8 using high pressure crystallography and computational modelling<br />
&nbsp; https://datashare.is.ed.ac.uk/handle/10283/3047<br />
[22] Adsorbate-induced lattice deformation in IRMOF-74 series<br />
&nbsp; https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5228029/<br />
[23] [lammps-users] GCMC gas adsorption<br />
&nbsp; https://lammps.sandia.gov/threads/msg74437.html<br />
[24] ASE<br />
&nbsp; http://ryokbys.web.nitech.ac.jp/ase.html<br />
[25] 分子シミュレーションスクール2018：シミュレーションの全体像・概論<br />
&nbsp; http://www.mitsuhiromatsumoto.mech.kyoto-u.ac.jp/<br />
[26] [lammps-users] Problems of temperature calculation for fix GCMC<br />
&nbsp; https://lammps.sandia.gov/threads/msg58606.html<br />
[27] LAMMPSの使い方<br />
&nbsp; http://ryokbys.web.nitech.ac.jp/contents/lammps_usage/<br />
[28] 原子間ポテンシャルの開発を支援するソフトウェア（kPot）<br />
&nbsp; http://www.fml.t.u-tokyo.ac.jp/potenfit/<br />
[29] 9.1. LAMMPS キーワード設定<br />
&nbsp; https://winmostar.com/jp/manual_jp/V7/calcmanual_jp.html<br />
[30] 分子動力学計算（LAMMPS）<br />
&nbsp; https://mochirixi.hatenadiary.com/archive/category/分子動力学計算%EF%BC%88LAMMPS%EF%BC%89<br />
<br />
各種講習会<br />
[K1] 分子動力学計算の実践講習 -溶融塩とイオン液体-<br />
&nbsp; http://amorphous.tf.chiba-u.jp/MS講習会/molten.html#org7303de4<br />
[K2] SCLS講習会‐SCLS計算機システムの実習‐分子動力学の基礎‐<br />
&nbsp; https://www.r-ccs.riken.jp/jp/lecture/SCLS講習会‐SCLS計算機システムの実習‐分子動力学の基礎‐.html<br />
[K3] ノートパソコンで出来る原子レベルのシミュレーション入門講習会<br />
&nbsp; http://m3.jsms.jp/course.html<br />
------------------------------------------------------------------------------