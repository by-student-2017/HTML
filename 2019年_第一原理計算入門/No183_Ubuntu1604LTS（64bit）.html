<p>&nbsp;&nbsp; Ubuntu 16.04 LTS amd64 (64 bit版)をインストールし、第一原理計算コードをセットアップするまでを解説する<br />
------------------------------------------------------------------------------<br />
■ Youtube動画（全てクリエイティブコモンにしています）<br />
・インストール方法： <a href="https://www.youtube.com/playlist?list=PL9r3BfacS1mFif0-qGV_mTVVqcNIlB9TW">https://www.youtube.com/playlist?list=PL9r3BfacS1mFif0-qGV_mTVVqcNIlB9TW</a><br />
　（バージョンが変わっても基本的な操作や考え方は同じです）<br />
・再生リスト: <a href="https://www.youtube.com/channel/UCcyHw8UcdB8ppBHYLUAdklw/playlists">https://www.youtube.com/channel/UCcyHw8UcdB8ppBHYLUAdklw/playlists</a><br />
・関連動画: <a href="https://www.youtube.com/channel/UCh922UHWEPD1FqGSp-Cvn7Q/playlists">https://www.youtube.com/channel/UCh922UHWEPD1FqGSp-Cvn7Q/playlists</a><br />
------------------------------------------------------------------------------<br />
■ sudo apt-get install<br />
<br />
# Update<br />
sudo apt-get update<br />
<br />
# Compiler (Intel compiler need g++)<br />
sudo apt-get -y install build-essential<br />
sudo apt-get -y install g++<br />
sudo apt-get -y install gfortran<br />
<br />
# Script (WIEN2k use csh and tcsh)<br />
sudo apt-get -y install csh<br />
sudo apt-get -y install tcsh<br />
<br />
# XcrySDen<br />
sudo apt-get -y install tk tcl tclx<br />
<br />
# Plot soft (WIEN2k use gnuplot)<br />
sudo apt-get -y install gnuplot<br />
sudo apt-get -y install grace<br />
sudo apt-get -y install rasmol<br />
sudo apt-get -y install xterm<br />
<br />
# phonopy<br />
sudo apt-get -y install python-dev python-numpy&nbsp;python-matplotlib&nbsp;python-yaml&nbsp;python-h5py<br />
<br />
# phono3py<br />
sudo apt-get -y install libgomp1 liblapack-dev liblapacke-dev<br />
<br />
# BoltzTraP (for VASP)<br />
sudo apt-get install python-ase<br />
<br />
# SPR-KKR<br />
sudo apt-get -y install imagemagick<br />
sudo apt-get -y install graphicsmagick-imagemagick-compat<br />
sudo apt-get -y install iwidgets4<br />
<br />
# python<br />
sudo apt-get -y install python-tk<br />
sudo apt-get -y install python-lxml<br />
sudo apt-get -y install python-scipy<br />
sudo apt-get -y install python-setuptools<br />
sudo apt-get -y install texlive<br />
<br />
# Patch<br />
sudo apt-get -y install patch<br />
<br />
other method: Ubuntu Software Center &gt; gfortran<br />
-----------------------------------------------------------------------------<br />
■ Intel compiler (parallel_studio_xe_2016_update4)<br />
Rough process<br />
1. tar zxvf $HOME/Downloads/parallel_studio_xe_2016_update4.tgz<br />
2. cd par*<br />
3. sudo ./install.sh<br />
4. Please type a selection or press &quot;Enter&quot; to accept default choice [1]: Enter<br />
5. space<br />
6. accept<br />
7. Please type a selection or press &quot;Enter&quot; to accept default choice [1]: Enter<br />
8. Serial number<br />
9. Press &quot;Enter&quot; key to continue: Enter<br />
10. Please type a selection: 1<br />
11. Please type a selection or press &quot;Enter&quot; to accept default choice [1]:<br />
12. space<br />
13. accept<br />
14. all enter<br />
<br />
15. gedit $HOME/.bashrc<br />
#--------------------<br />
# Intel Compiler ( Fortran &amp; C++ ) environmental setting<br />
export PATH=$PATH:/opt/intel/vtune_amplifier_xe<br />
export PATH=$PATH:/opt/intel/inspector_xe<br />
source /opt/intel/bin/compilervars.sh intel64<br />
# mpiifort (intel mpi)<br />
source /opt/intel/impi/5.1.3.258/bin64/mpivars.sh<br />
#--------------------<br />
<br />
# FFT<br />
1. bash<br />
2. sudo bash<br />
3. cd /opt/intel/composer_xe_2013/mkl/interfaces/fftw3xf/<br />
4. make libintel64 compiler=intel<br />
<br />
[1] https://software.intel.com/en-us/articles/how-to-run-intel-mpi-on-xeon-phi<br />
-----------------------------------------------------------------------------<br />
■ FFTW3 (FFTW3 for WIEN2k)<br />
1) tar zxvf $HOME/Downloads/fftw-3.3.5.tar.gz<br />
2) cd ff*<br />
3) ./configure MPICC=mpicc CC=icc F77=ifort --enable-avx2 --enable-mpi<br />
4) make<br />
5) sudo make install<br />
My PC: Intel(R) Core(TM) i7-4770S (can use SSE4.1/4.2, AVX 2.0), see cpuinfo and web<br />
-----------------------------------------------------------------------------<br />
■ <span style="font-family: verdana, tahoma, &quot;ＭＳ ゴシック&quot;, &quot;ＭＳ Ｐゴシック&quot;, &quot;ヒラギノ角ゴ Pro W3&quot;, Osaka−等幅, Osaka, 平成角ゴシック, sans-serif;">OpenMPI (skip this procedure for intelmpi, home case)</span></p>

<div>1. download: http://www.open-mpi.org/</div>

<p>2. tar zxvf $HOME/Downloads/openmpi-1.8.8.tar.gz<br />
3. cd openmpi*<br />
4. ./configure -prefix=$HOME/openmpi CXX=icpc CC=icc FC=ifort F90=ifort F77=ifort<br />
5. make<br />
6. make install<br />
----------<br />
7. gedit ~/.bashrc<br />
#--------------------<br />
# OpenMPI environmental setting<br />
export MPIROOT=$HOME/openmpi<br />
export PATH=$MPIROOT/bin:$PATH<br />
export LD_LIBRARY_PATH=$MPIROOT/lib:$LD_LIBRARY_PATH<br />
export MANPATH=$MPIROOT/share/man:$MANPATH<br />
#--------------------<br />
-----------------------------------------------------------------------------<br />
■ <span style="font-family: verdana, tahoma, &quot;ＭＳ ゴシック&quot;, &quot;ＭＳ Ｐゴシック&quot;, &quot;ヒラギノ角ゴ Pro W3&quot;, Osaka−等幅, Osaka, 平成角ゴシック, sans-serif;">OpenMPI (skip this procedure for intelmpi, root case)</span></p>

<div>1. download: http://www.open-mpi.org/</div>
2. tar zxvf $HOME/Downloads/openmpi-1.8.8.tar.gz<br />
3. cd op*<br />
4. ./configure CXX=g++ CC=gcc FC=ifort F90=ifort F77=ifort<br />
&nbsp; or<br />
&nbsp; ./configure CXX=icpc CC=icc FC=ifort F90=ifort F77=ifort<br />
&nbsp; or<br />
&nbsp; ./configure -prefix=/usr/local/openmpi CXX=icpc CC=icc FC=ifort F90=ifort F77=ifort<br />
5. make<br />
&nbsp;&nbsp; or<br />
&nbsp;&nbsp; sudo make<br />
6. sudo make install<br />
----------<br />
7. gedit ~/.bashrc<br />
#--------------------<br />
# OpenMPI environmental setting<br />
export MPIROOT=/usr/local/openmpi<br />
export PATH=$MPIROOT/bin:$PATH<br />
export LD_LIBRARY_PATH=$MPIROOT/lib:$LD_LIBRARY_PATH<br />
export MANPATH=$MPIROOT/share/man:$MANPATH<br />
#--------------------<br />
------------------------------------------------------------------------------<br />
■ cif2cell<br />
1. tar zxvf cif2cell-1.2.10.tar.gz<br />
2. cd cif2cell-1.2.10<br />
3. gedit cif2cell<br />
----------<br />
before-----line 1608 (shortcut command: Ctrl + I )<br />
incarfile = INCARFile(cd,docstring=docstring,vca=options.vca,prioritylist=prioritylist,encutfac=encutfac)<br />
<br />
after-------line 1608<br />
incarfile = INCARFile(cd,docstring=docstring,potcardir=lib,vca=options.vca,prioritylist=prioritylist,encutfac=encutfac)<br />
----------<br />
4. sudo python setup.py install<br />
------------------------------------------------------------------------------<br />
■ XcrySDen<br />
1) download: <a href="http://www.xcrysden.org/Download.html">http://www.xcrysden.org/Download.html</a><br />
2) tar zxvf $HOME/Downloads/xc-1.5.23-linux_x86_64-semishared.tar.gz<br />
3) cd XCr*<br />
4) ./xcConfigure<br />
5) Do you have a CRYSTAL package ([y]es/[n]o): n<br />
6) Is this correct ([y]es/[n]o): y<br />
7) Would you like to add xcrysden icon to the desktop ([y]es/[n]o): n<br />
8) bash<br />
* command: xcrysden<br />
------------------------------------------------------------------------------<br />
■ XcrySDen<br />
1) download: <a href="http://www.xcrysden.org/Download.html">http://www.xcrysden.org/Download.html</a><br />
2) tar zxvf $HOME/Downloads/xcrysden-1.5.60-linux_x86_64-semishared.tar.gz<br />
3) cd xcr*<br />
4) gedit $HOME/.bashrc<br />
#--------------------<br />
# xcrysden<br />
XCRYSDEN_TOPDIR=$HOME/xcrysden-1.5.60-bin-semishared<br />
XCRYSDEN_SCRATCH=$HOME/xcrys_tmp<br />
export XCRYSDEN_TOPDIR XCRYSDEN_SCRATCH<br />
PATH=&quot;$XCRYSDEN_TOPDIR:$PATH:$XCRYSDEN_TOPDIR/scripts:$XCRYSDEN_TOPDIR/util&quot;<br />
#--------------------<br />
------------------------------------------------------------------------------<br />
■ VESTA<br />
1. download: http://jp-minerals.org/vesta/jp/<br />
2. tar xvf $HOME/Downloads/VESTA-x86_64.tar.bz2<br />
3. ./VESTA<br />
------------------------------------------------------------------------------<br />
■ WIEN2k<br />
1) mkdir WIEN2k_14<br />
2) cd WIEN2k_14<br />
3) cp $HOME/Downloads/WIEN2k_14.2.tar ./<br />
4) tar -xvf WIEN2k_14.2.tar<br />
5) gunzip *.gz<br />
6) chmod +x ./expand_lapw<br />
----------<br />
7) ./expand_lapw<br />
&nbsp; WARNING: This will expand all WIEN.tar files !!!<br />
It will overwrite all changes you have made previously in the WIEN subdirectories<br />
continue (y/n)<br />
y<br />
-----------<br />
8) ./siteconfig_lapw<br />
&nbsp; Press RETURN to continue<br />
&nbsp; Enter<br />
----------<br />
9) I&nbsp;&nbsp;&nbsp; Linux (Intel ifort compiler (12.0 and later) + mkl )<br />
&nbsp; i<br />
&nbsp; Press RETURN to continue<br />
&nbsp; Enter<br />
----------<br />
10) Your compiler: ifort<br />
&nbsp; Your compiler: icc<br />
&nbsp; Press RETURN to continue<br />
&nbsp; Enter<br />
&nbsp; Hit Enter to continue<br />
&nbsp; Enter<br />
----------<br />
11) Current settings:<br />
&nbsp; O&nbsp;&nbsp; Compiler options: -FR -mp1 -w -prec_div -pc80 -pad -ip -DINTEL_VML -traceback -assume buffered_io -axAVX2<br />
&nbsp; F&nbsp;&nbsp; FFTW options: -DFFTW3 -I/usr/local/lib/include<br />
&nbsp; FL&nbsp; FFTW_LIBS: -lfftw3_mpi -lfftw3 -L/usr/local/lib<br />
----------<br />
12) Shared Memory Architecture? (y/n): y<br />
&nbsp; Do you know/need a command to bind your jobs to specific nodes ?<br />
&nbsp; (like taskset -c). Enter N / your_specific_command: N<br />
----------<br />
13) &nbsp;&nbsp; Do you have MPI, Scalapack and FFTW installed and intend to run finegrained parallel?<br />
&nbsp;&nbsp; This is useful only for BIG cases (50 atoms and more / unit cell)<br />
&nbsp;&nbsp; and your HARDWARE has at least 16 cores (or is a cluster with Infiniband)<br />
&nbsp;&nbsp; You need to KNOW details about your installed&nbsp; MPI and FFTW )<br />
&nbsp;&nbsp; (y/n) y<br />
&nbsp;&nbsp;&nbsp;&nbsp; Recommended setting for parallel f90 compiler: mpiifort<br />
&nbsp;&nbsp;&nbsp;&nbsp; Current selection:&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp; Your compiler: mpiifort<br />
&nbsp;Finding the required fftw2/3 mpi-files in /usr and /opt ..../usr/local/lib/libfftw3_mpi.a<br />
could not find fftw ....<br />
Your present FFTW choice is: FFTW3<br />
Please specify whether you want to use FFTW3 (default) or FFTW2&nbsp; (FFTW3 / FFTW2):<br />
Present FFTWpath is: /usr/local/lib<br />
Please specify the ROOT-path of your FFTW installation (like /opt/fftw3): /usr/local/lib<br />
Your FFTW_LIBS are: -lfftw3_mpi -lfftw3 -L/usr/local/lib/lib<br />
Your FFTW_OPT are : -DFFTW3 -I/usr/local/lib/include<br />
is this correct? enter Y (default) or n: y<br />
FP&nbsp; FPOPT(par.comp.options): -FR -mp1 -w -prec_div -pc80 -pad -ip -DINTEL_VML -traceback -assume buffered_io -axAVX2<br />
----------<br />
14) A&nbsp;&nbsp; Compile all programs (suggested)<br />
&nbsp; a<br />
----------<br />
15) ./userconfig_lapw<br />
----------<br />
16) .bashrc<br />
&nbsp; export OMP_NUM_THREADS=4<br />
----------<br />
17) bash<br />
18) w2web<br />
My PC: Intel(R) Core(TM) i7-4770S (can use SSE4.1/4.2, AVX 2.0), see cpuinfo and web<br />
------------------------------------------------------------------------------<br />
■ boltztrap<br />
1. tar xvf BoltzTraP.tar.bz2<br />
2. cd boltztrap-*/src<br />
3. gedit Makefile<br />
&nbsp;&nbsp; FC=ifort<br />
&nbsp;&nbsp; FOPT = -FR -mp1 -w -prec_div -pc80 -pad -align -DINTEL_VML -traceback -axAVX,SSE4.2,SSE4.1,SSSE3,SSE3<br />
&nbsp;&nbsp; LDFLAGS = $(FOPT) -L$(MKLROOT)/lib/$(MKL_TARGET_ARCH) -pthread<br />
&nbsp;&nbsp; LIBS = -lmkl_lapack95_lp64&nbsp;-lmkl_blas95_lp64 -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core -openmp -lpthread<br />
4. make<br />
------------------------------------------------------------------------------<br />
■ spglib<br />
1. download: https://sourceforge.net/projects/spglib/<br />
2. tar zxvf spg*<br />
3. cd spg*<br />
4. ./configure<br />
5. make<br />
6. sudo make install<br />
------------------------------------------------------------------------------<br />
■ pyspglib-1.8.3.1 (BoltzTraP for VASP)<br />
1. download: https://pypi.python.org/pypi/pyspglib<br />
2. tar zxvf pys*<br />
3. cd pys*<br />
4. sudo python setup.py install<br />
------------------------------------------------------------------------------<br />
■ vasp.5.lib<br />
1. tar zxvf vasp.5.lib.tar.gz<br />
2. cd vasp.5.lib<br />
3. cp makefile.linux_ifc_P4 makefile<br />
4. gedit makefile<br />
&nbsp; -----(Note: CC=cc)<br />
&nbsp; CPP&nbsp;&nbsp;&nbsp;&nbsp; = gcc -E -P -C $*.F &gt;$*.f<br />
&nbsp; FC=ifort<br />
<br />
&nbsp; CFLAGS = -O<br />
&nbsp; FFLAGS = -O0 -FI -axAVX2,AVX,SSE4.2,SSE4.1,SSE3,SSSE3,SSE2<br />
&nbsp; -----<br />
5. make<br />
------------------------------------------------------------------------------<br />
■ vasp.5.3 (OpenMPI)<br />
1. tar zxvf vasp.5.3.3.tar.gz<br />
2. cd vasp.5.3<br />
3. cp makefile.linux_ifc_P4 makefile<br />
4. gedit makefile<br />
&nbsp; -----<br />
&nbsp; FC=ifort<br />
&nbsp; FCL=$(FC)<br />
&nbsp; CPP_ =&nbsp; ./preprocess &lt;$*.F | /usr/bin/cpp -P -C -traditional &gt;$*$(SUFFIX)<br />
&nbsp; CPP_=fpp -f_com=no -free -w0 $*.F $*$(SUFFIX)<br />
&nbsp; CPP&nbsp;&nbsp;&nbsp;&nbsp; = $(CPP_)&nbsp; -DHOST=\&quot;LinuxIFC\&quot; \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -DCACHE_SIZE=12000 -DPGF90 -Davoidalloc -DNGXhalf \<br />
&nbsp; FFLAGS =&nbsp; -FR -names lowercase -assume byterecl<br />
&nbsp; OFLAG=-O2 -ip -axAVX2,AVX,SSE4.2,SSE4.1,SSE3,SSSE3,SSE2<br />
&nbsp; OFLAG_HIGH = $(OFLAG)<br />
&nbsp; OBJ_HIGH =<br />
&nbsp; OBJ_NOOPT =<br />
&nbsp; DEBUG&nbsp; = -FR -O0<br />
&nbsp; INLINE = $(OFLAG)<br />
&nbsp; MKL_PATH=$(MKLROOT)/lib/intel64<br />
&nbsp; MKL_FFTW_PATH=$(MKLROOT)/interfaces/fftw3xf/<br />
&nbsp; BLAS=<br />
&nbsp; LAPACK=<br />
&nbsp; LIB&nbsp; = -L../vasp.5.lib -ldmy \<br />
&nbsp;&nbsp;&nbsp;&nbsp; ../vasp.5.lib/linpack_double.o $(LAPACK) \<br />
&nbsp;&nbsp;&nbsp;&nbsp; $(BLAS)<br />
&nbsp; FFT3D&nbsp;&nbsp; = fft3dfurth.o fft3dlib.o<br />
&nbsp; FC=mpif90<br />
&nbsp; FCL=$(FC) -mkl<br />
&nbsp; CPP&nbsp;&nbsp;&nbsp; = $(CPP_) -DMPI&nbsp; -DHOST=\&quot;LinuxIFC\&quot; -DIFC \<br />
&nbsp;&nbsp;&nbsp;&nbsp; -DCACHE_SIZE=4000 -DPGF90 -Davoidalloc -DNGZhalf \<br />
&nbsp;&nbsp;&nbsp;&nbsp; -DMPI_BLOCK=8000 -Duse_collective -DscaLAPACK<br />
&nbsp; BLACS= -lmkl_blacs_openmpi_lp64<br />
&nbsp; SCA= $(MKL_PATH)/libmkl_scalapack_lp64.a $(BLACS)<br />
&nbsp; LIB&nbsp;&nbsp;&nbsp;&nbsp; = -L../vasp.5.lib -ldmy&nbsp; \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ../vasp.5.lib/linpack_double.o \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(SCA) $(LAPACK) $(BLAS)<br />
&nbsp; FFT3D&nbsp;&nbsp; = fftmpi.o fftmpi_map.o fft3dfurth.o fft3dlib.o<br />
&nbsp; -----<br />
5. make<br />
Retry case: gedit makefile &gt; make clean &gt; make<br />
<br />
other case<br />
----------<br />
# FFT: fftmpi.o with fft3dlib of Juergen Furthmueller<br />
#FFT3D&nbsp;&nbsp; = fftmpi.o fftmpi_map.o fft3dfurth.o fft3dlib.o<br />
# you may also try to use the fftw wrapper to mkl (but the path might vary a lot)<br />
# it seems this is best for AMD based systems<br />
FFT3D&nbsp;&nbsp; = fftmpiw.o fftmpi_map.o&nbsp; fftw3d.o&nbsp; fft3dlib.o&nbsp;&nbsp; $(MKL_FFTW_PATH)/libfftw3xf_intel.a<br />
INCS = -I$(MKLROOT)/include/fftw<br />
----------<br />
------------------------------------------------------------------------------<br />
■ vasp.5.3 (IntelMPI)<br />
1. tar zxvf vasp.5.3.3.tar.gz<br />
2. cd vasp.5.3<br />
3. cp makefile.linux_ifc_P4 makefile<br />
4. gedit makefile<br />
&nbsp; -----<br />
&nbsp; FC=ifort<br />
&nbsp; FCL=$(FC)<br />
&nbsp; CPP_ =&nbsp; ./preprocess &lt;$*.F | /usr/bin/cpp -P -C -traditional &gt;$*$(SUFFIX)<br />
&nbsp; CPP_=fpp -f_com=no -free -w0 $*.F $*$(SUFFIX)<br />
&nbsp; CPP&nbsp;&nbsp;&nbsp;&nbsp; = $(CPP_)&nbsp; -DHOST=\&quot;LinuxIFC\&quot; \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -DCACHE_SIZE=12000 -DPGF90 -Davoidalloc -DNGXhalf \<br />
&nbsp; FFLAGS =&nbsp; -FR -names lowercase -assume byterecl<br />
&nbsp; OFLAG=-O2 -ip -axAVX2,AVX,SSE4.2,SSE4.1,SSE3,SSSE3,SSE2<br />
&nbsp; OFLAG_HIGH = $(OFLAG)<br />
&nbsp; OBJ_HIGH =<br />
&nbsp; OBJ_NOOPT =<br />
&nbsp; DEBUG&nbsp; = -FR -O0<br />
&nbsp; INLINE = $(OFLAG)<br />
&nbsp; MKL_PATH=$(MKLROOT)/lib/intel64<br />
&nbsp; MKL_FFTW_PATH=$(MKLROOT)/interfaces/fftw3xf/<br />
&nbsp; BLAS=<br />
&nbsp; LAPACK=<br />
&nbsp; LIB&nbsp; = -L../vasp.5.lib -ldmy \<br />
&nbsp;&nbsp;&nbsp;&nbsp; ../vasp.5.lib/linpack_double.o $(LAPACK) \<br />
&nbsp;&nbsp;&nbsp;&nbsp; $(BLAS)<br />
&nbsp; FFT3D&nbsp;&nbsp; = fft3dfurth.o fft3dlib.o<br />
&nbsp; FC=mpiifort<br />
&nbsp; FCL=$(FC) -mkl<br />
&nbsp; CPP&nbsp;&nbsp;&nbsp; = $(CPP_) -DMPI&nbsp; -DHOST=\&quot;LinuxIFC\&quot; -DIFC \<br />
&nbsp;&nbsp;&nbsp;&nbsp; -DCACHE_SIZE=4000 -DPGF90 -Davoidalloc -DNGZhalf \<br />
&nbsp;&nbsp;&nbsp;&nbsp; -DMPI_BLOCK=8000 -Duse_collective -DscaLAPACK -Duse_collective \<br />
&nbsp;&nbsp;&nbsp;&nbsp; -DnoAugXCmeta -Duse_bse_te \<br />
&nbsp;&nbsp;&nbsp;&nbsp; -Duse_shmem -Dtbdyn<br />
&nbsp; BLACS= -lmkl_blacs_intelmpi_lp64<br />
&nbsp; SCA= $(MKL_PATH)/libmkl_scalapack_lp64.a $(BLACS)<br />
&nbsp; LIB&nbsp;&nbsp;&nbsp;&nbsp; = -L../vasp.5.lib -ldmy&nbsp; \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ../vasp.5.lib/linpack_double.o \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(SCA) $(LAPACK) $(BLAS)<br />
&nbsp; FFT3D&nbsp;&nbsp; = fftmpiw.o fftmpi_map.o&nbsp; fftw3d.o&nbsp; fft3dlib.o&nbsp;&nbsp; $(MKL_FFTW_PATH)/libfftw3xf_intel.a<br />
&nbsp; INCS = -I$(MKLROOT)/include/fftw<br />
&nbsp; -----<br />
5. make<br />
Retry case: gedit makefile &gt; make clean &gt; make<br />
------------------------------------------------------------------------------<br />
■ recompile<br />
Phonon calculation error case<br />
---------<br />
&nbsp; &nbsp; internal error in SETUP_DEG_CLUSTERS: NB_TOT exceeds NMAX_DEG<br />
&nbsp;&nbsp;&nbsp; increase NMAX_DEG to&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 144<br />
---------<br />
<br />
1. cd $HOME/vasp.5.3<br />
2. grep NMAX_DEG *.f90<br />
&nbsp;You get &quot;subrot_cluster.f90:&nbsp;&nbsp;&nbsp; INTEGER, PARAMETER :: NMAX_DEG=48&quot;<br />
-----<br />
3. gedit subrot_cluster.F<br />
-----before-----<br />
&nbsp;&nbsp;&nbsp; INTEGER, PARAMETER :: NMAX_DEG=48<br />
-----after-----<br />
&nbsp;&nbsp;&nbsp; INTEGER, PARAMETER :: NMAX_DEG=168<br />
-----<br />
4. make<br />
<br />
※ VASPはCとFortranのプリプロセッサ（cppとfpp）を用いて、.Fの拡張子がついたファイルをコンパイルするPCの環境に合わせたものに書き換えて.f90の拡張子がついたものとして出力する。<br />
　上記のようにコードを書き換える場合には、.Fの拡張子を書き換えておくと安心できる。<br />
(VASP makefile copy subrot_cluster.F to subrot_cluster.f90)<br />
------------------------------------------------------------------------------<br />
■ potpaw_PBE<br />
1. mkdir potpaw_PBE<br />
2. cd potpaw_PBE<br />
3. tar zxvf potpaw_PBE.tgz<br />
------------------------------------------------------------------------------<br />
■ Phonopy<br />
1) download phonopy: <a class="yt-uix-servicelink " data-servicelink="CC8Q6TgiEwjcn4aEua_QAhVKpVgKHRsuAmgo-B0" data-url="http://atztogo.github.io/phonopy/" href="http://atztogo.github.io/phonopy/" rel="nofollow" target="_blank">http://atztogo.github.io/phonopy/</a><br />
to <a class="yt-uix-servicelink " data-servicelink="CC8Q6TgiEwjcn4aEua_QAhVKpVgKHRsuAmgo-B0" data-url="http://atztogo.github.io/phonopy/install.html" href="http://atztogo.github.io/phonopy/install.html" rel="nofollow" target="_blank">http://atztogo.github.io/phonopy/inst...</a><br />
2) download phonopy-1.11.2.25.tar.gz<br />
3) tar zxvf phonopy-1.11.2.25.tar.gz<br />
4) cd phonopy*<br />
5) sudo python setup.py install<br />
------------------------------------------------------------------------------<br />
■ Phono3py<br />
1) download phono3py: <a class="yt-uix-servicelink " data-servicelink="CC8Q6TgiEwjcn4aEua_QAhVKpVgKHRsuAmgo-B0" data-url="http://atztogo.github.io/phono3py/" href="http://atztogo.github.io/phono3py/" rel="nofollow" target="_blank">http://atztogo.github.io/phono3py/</a><br />
to <a class="yt-uix-servicelink " data-servicelink="CC8Q6TgiEwjcn4aEua_QAhVKpVgKHRsuAmgo-B0" data-url="http://atztogo.github.io/phono3py/install.html" href="http://atztogo.github.io/phono3py/install.html" rel="nofollow" target="_blank">http://atztogo.github.io/phono3py/ins...</a><br />
2) tar zxvf phono3py-1.11.3.29.tar.gz<br />
3) cd phono3py*<br />
4) sudo python setup.py install<br />
------------------------------------------------------------------------------<br />
■ intelmpi environmental settings <span style="font-family: verdana, tahoma, &quot;ＭＳ ゴシック&quot;, &quot;ＭＳ Ｐゴシック&quot;, &quot;ヒラギノ角ゴ Pro W3&quot;, Osaka−等幅, Osaka, 平成角ゴシック, sans-serif;">(skip this procedure for OpenMPI)</span><br />
# ssh<br />
1. sudo apt-get install openssh-server<br />
2. sudo apt-get install ssh<br />
3. mkdir .ssh<br />
4. ssh-keygen<br />
&nbsp; All enter<br />
5. cd .ssh<br />
6. cat id_rsa.pub &gt; authorized_keys<br />
7. sudo gedit /etc/ssh/sshd_config<br />
8. service ssh restart<br />
<br />
# MPD<br />
1. gedit $HOME/.mpd.conf<br />
&nbsp; secretword=&lt;mpd secret word&gt;<br />
2. chmod 600 $HOME/.mpd.conf<br />
3. gedit $HOME/mpd.hosts<br />
&nbsp; 127.0.0.1<br />
4. gedit $HOME/machinefile<br />
&nbsp; 127.0.0.1:4<br />
5. mpdallexit<br />
6. mpdboot -f $HOME/mpd.hosts -n 4 -r ssh<br />
7. mpdtrace<br />
8. mpiexec -machinefile $HOME/machinefile -n 2 python -V<br />
<br />
# Usage<br />
mpiexec -machinefile $HOME/machinefile -env I_MPI_DEVICE sock -n 4 /home/student/vasp/vasp.5.3/vasp -r ssh<br />
mpirun -machinefile $HOME/machinefile -env I_MPI_DEVICE sock -np 4 /home/student/vasp/vasp.5.3/vasp -r ssh<br />
mpirun -machinefile $HOME/machinefile -genv I_MPI_DEVICE sock -n 4 /home/student/vasp/vasp.5.3/vasp -r ssh<br />
------------------------------------------------------------------------------<br />
■ hyperthreading OFF<br />
[1] <a href="https://monostudio.jp/1178">https://monostudio.jp/1178</a><br />
------------------------------------------------------------------------------<br />
■ Abinit<br />
<br />
◇ intel MPI + intel compiler + MKL + intel FFT<br />
1. tar zxvf $HOME/Downloads/abinit-7.10.5.tar.gz<br />
2. cd abinit-7.10.5<br />
3. ./configure FC=mpiifort CC=mpiicc CXX=mpiicpc --with-linalg-flavor=&quot;mkl&quot; --with-linalg-incs=&quot;-I/opt/intel/compilers_and_libraries/linux/mkl/include/intel64/lp64 -I/opt/intel/compilers_and_libraries/linux/mkl/include&quot; --with-linalg-libs=&quot;-L/opt/intel/compilers_and_libraries/linux/mkl/lib/intel64 -lmkl_blas95_lp64 -lmkl_lapack95_lp64 -lmkl_scalapack_lp64 -lmkl_intel_lp64 -lmkl_core -lmkl_intel_thread -lmkl_blacs_intelmpi_lp64 -lpthread -lm -ldl&quot; --with-fft-flavor=fftw3-mkl --with-fft-libs=&quot;-L/opt/intel/compilers_and_libraries/linux/mkl/interfaces/fftw3xf -lfftw3xf_intel&quot; --enable-64bit-flags FCFLAGS_EXTRA=&quot;-O2 -axAVX2,AVX,SSE4.2&quot; CFLAGS_EXTRA=&quot;-O2 -axAVX2,AVX,SSE4.2&quot; CXXFLAGS_EXTRA=&quot;-O2 -axAVX2,AVX,SSE4.2&quot;<br />
4. make mj4<br />
5. cd tests<br />
6. mpirun -machinefile $HOME/machinefile -env I_MPI_DEVICE sock -r ssh ./runtests.py -j4 fast<br />
7. cd ..<br />
8. sudo make install<br />
<br />
◇ Usage<br />
mpirun -machinefile $HOME/machinefile -env I_MPI_DEVICE sock -r ssh -np 4 abinit &lt; case.in &gt; case.out<br />
------------------------------------------------------------------------------<br />
■ PWscf<br />
<br />
◇ intel MPI + intel compiler + MKL + intel FFT<br />
1. tar zxvf $HOME/Downloads/qe-6.0.tar.gz<br />
2. cd qe-6.0<br />
3. ./configure MPIF90=mpiifort CXX=g++ CC=gcc FC=ifort F77=ifort F90=ifort BLAS_LIBS=&quot;${MKLROOT}/lib/intel64/libmkl_blas95_lp64.a ${MKLROOT}/lib/intel64/libmkl_lapack95_lp64.a -L${MKLROOT}/lib/intel64 -lmkl_intel_lp64 -lmkl_core -lmkl_intel_thread -lpthread -lm -ldl&quot; LAPACK_LIBS=&quot;${MKLROOT}/lib/intel64/libmkl_blas95_lp64.a ${MKLROOT}/lib/intel64/libmkl_lapack95_lp64.a -L${MKLROOT}/lib/intel64 -lmkl_intel_lp64 -lmkl_core -lmkl_intel_thread -lpthread -lm -ldl&quot; FFT_LIBS=&quot;${MKLROOT}/interfaces/fftw3xf/libfftw3xf_intel.a&quot; --enable-openmp<br />
4. make all<br />
<br />
◇ Usage<br />
mpirun -machinefile $HOME/machinefile -env I_MPI_DEVICE sock -r ssh -np 4 $HOME/qe-6.0/bin/pw.x &lt; case.in &gt; case.out<br />
-----------------------------------------------------------------------------<br />
■ <span style="font-family: verdana, tahoma, &quot;ＭＳ ゴシック&quot;, &quot;ＭＳ Ｐゴシック&quot;, &quot;ヒラギノ角ゴ Pro W3&quot;, Osaka−等幅, Osaka, 平成角ゴシック, sans-serif;">OpenMPI (skip this procedure for intelmpi, home case)</span>

<div>1. download: http://www.open-mpi.org/</div>

<p>2. tar zxvf $HOME/Downloads/openmpi-2.0.2.tar.gz<br />
3. cd openmpi*<br />
4. ./configure -prefix=$HOME/openmpi CXX=icpc CC=icc FC=ifort F90=ifort F77=ifort<br />
5. make<br />
6. make install<br />
----------<br />
7. gedit ~/.bashrc<br />
#--------------------<br />
# OpenMPI environmental setting<br />
export MPIROOT=$HOME/openmpi<br />
export PATH=$MPIROOT/bin:$PATH<br />
export LD_LIBRARY_PATH=$MPIROOT/lib:$LD_LIBRARY_PATH<br />
export MANPATH=$MPIROOT/share/man:$MANPATH<br />
#--------------------<br />
-----------------------------------------------------------------------------<br />
■ LIBXC<br />
□ download (Libxc:download - OctopusWiki - TDDFT.org)<br />
<a class="yt-uix-servicelink  " data-servicelink="CC8Q6TgYACITCNr447avgNMCFUeTWAodBTYIVij4HQ" data-target-new-window="True" data-url="http://www.tddft.org/programs/octopus/wiki/index.php/Libxc:download" href="http://www.tddft.org/programs/octopus/wiki/index.php/Libxc:download" rel="nofollow noopener" target="_blank">http://www.tddft.org/programs/octopus...</a><br />
<br />
□ install autoconf and libtool<br />
sudo apt-get install autoconf<br />
sudo apt-get install libtool<br />
<br />
□ install libxc<br />
tar zxvf $HOME/Downloads/libxc*<br />
cd libxc*<br />
autoreconf -i<br />
./configure FC=ifort CC=icc F77=ifort<br />
make<br />
make check<br />
(make check | tee results)<br />
sudo make install<br />
<br />
□ Libraries have been installed in: /opt/etsf/lib<br />
/opt/etsf/lib/libxc.a<br />
/opt/etsf/lib/libxcf90.a<br />
<br />
I used openmpi-2.0.2<br />
My PC: Intel(R) Xeon(R)&nbsp; E5-2640 v3 (can use SSE4.1/4.2, AVX 2.0), see cpuinfo and web<br />
-----------------------------------------------------------------------------<br />
■ FFTW3 (FFTW3 for WIEN2k)<br />
1) tar zxvf $HOME/Downloads/fftw-3.3.6-pl2.tar.gz<br />
2) cd ff*<br />
3) ./configure MPICC=mpiicc CC=icc F77=ifort --enable-avx2 --enable-mpi --enable-openmp --enable-threads<br />
4) make<br />
5) sudo make install<br />
My PC: Intel(R) Xeon(R)&nbsp; E5-2640 v3 (can use SSE4.1/4.2, AVX 2.0), see cpuinfo and web<br />
------------------------------------------------------------------------------<br />
■ WIEN2k<br />
1) mkdir WIEN2k_16<br />
2) cd WIEN2k_16<br />
3) cp $HOME/Downloads/WIEN2k_16.tar ./<br />
4) tar -xvf WIEN2k_16.tar<br />
5) gunzip *.gz<br />
6) chmod +x ./expand_lapw<br />
----------<br />
7) ./expand_lapw<br />
&nbsp; WARNING: This will expand all WIEN.tar files !!!<br />
It will overwrite all changes you have made previously in the WIEN subdirectories<br />
continue (y/n)<br />
y<br />
-----------<br />
8) ./siteconfig_lapw<br />
&nbsp; Press RETURN to continue<br />
&nbsp; Enter<br />
----------<br />
9) I&nbsp;&nbsp;&nbsp; Linux (Intel ifort compiler (12.0 or later)+mkl (+intelmpi))<br />
&nbsp; i<br />
&nbsp; Press RETURN to continue<br />
&nbsp; Enter<br />
----------<br />
10) Your compiler: ifort<br />
&nbsp; Your compiler: icc<br />
&nbsp; Press RETURN to continue<br />
&nbsp; Enter<br />
&nbsp; Hit Enter to continue<br />
&nbsp; Enter<br />
----------<br />
11) Current settings:<br />
&nbsp;O&nbsp;&nbsp; Compiler options:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -O1 -FR -mp1 -w -prec_div -pc80 -pad -ip -DINTEL_VML -traceback -assume buffered_io -I$(MKLROOT)/include -axAVX2<br />
&nbsp;F&nbsp;&nbsp; FFTW options:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -DFFTW3 -I/usr/local/include<br />
&nbsp;X&nbsp;&nbsp; LIBX options:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -DLIBXC -I/opt/etsf/include<br />
&nbsp;E&nbsp;&nbsp; ELPA options:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<br />
&nbsp;L&nbsp;&nbsp; Linker Flags:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(FOPT) -L$(MKLROOT)/lib/$(MKL_TARGET_ARCH) -pthread<br />
&nbsp;P&nbsp;&nbsp; Preprocessor flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39;-DParallel&#39;<br />
&nbsp;R&nbsp;&nbsp; R_LIB (LAPACK+BLAS):&nbsp;&nbsp;&nbsp;&nbsp; -lmkl_lapack95_lp64 -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core -openmp -lpthread<br />
&nbsp;FL&nbsp; FFTW_LIBS:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -lfftw3_mpi -lfftw3 -L/usr/local/lib<br />
&nbsp;XL&nbsp; LIBXC_LIBS:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -L/opt/etsf/lib -lxcf03 -lxc<br />
&nbsp;EL&nbsp; ELPA_LIBS:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<br />
&nbsp;S&nbsp;&nbsp; Save and Quit<br />
&nbsp;Q&nbsp;&nbsp; Quit and abandon changes<br />
&nbsp;&nbsp;&nbsp;&nbsp; To change an item select option.<br />
Selection: s<br />
----------<br />
12) Configure parallel execution&nbsp; *<br />
&nbsp; If you have A CLUSTER OF shared memory parallel computers answer next question with N<br />
&nbsp; Shared Memory Architecture? (y/N):y<br />
&nbsp; Do you know/need a command to bind your jobs to specific nodes ?<br />
&nbsp; (like taskset -c). Enter N / your_specific_command:<br />
&nbsp;&nbsp; ********************************************************<br />
&nbsp;&nbsp; Do you have MPI, Scalapack, ELPA, and FFTW installed and intend to run<br />
&nbsp;&nbsp; finegrained parallel?<br />
&nbsp;&nbsp; This is useful only for BIG cases (50 atoms and more / unit cell)<br />
&nbsp;&nbsp; and your HARDWARE has at least 16 cores (or is a cluster with Infiniband)<br />
&nbsp;&nbsp; You need to KNOW details about your installed MPI, ELPA, and FFTW )<br />
&nbsp;&nbsp; (y/n) y<br />
&nbsp;&nbsp;&nbsp;&nbsp; Recommended setting for parallel f90 compiler: mpif90<br />
&nbsp;&nbsp;&nbsp;&nbsp; Current selection:&nbsp; mpif90<br />
&nbsp;&nbsp;&nbsp;&nbsp; Your compiler: mpif90<br />
&nbsp;Do you want to automatically search for FFTW installations? (Y,n):<br />
n<br />
Your present FFTW choice is: FFTW3<br />
Please specify whether you want to use FFTW3 (default) or FFTW2&nbsp; (FFTW3 / FFTW2): FFTW3<br />
Present FFTWpath is: f<br />
Present FFTWpath is: f<br />
Please specify the ROOT-path of your FFTW installation (like /opt/fftw3/) or accept present choice (enter):<br />
/usr/local<br />
Your FFTW_LIBS are: -lfftw3_mpi -lfftw3 -L/usr/local/lib<br />
Your FFTW_OPT are : -DFFTW3 -I/usr/local/include<br />
Is this correct? enter Y (default) or n: y<br />
&nbsp;Do you want to use ELPA? (y,N):<br />
N<br />
&nbsp;&nbsp; Recommended options for system linuxifc are:<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RP_LIB(SCALAPACK+PBLAS): -lmkl_scalapack_lp64 -lmkl_blacs_intelmpi_lp64 $(R_LIBS)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FPOPT(par.comp.options): -O1 -FR -mp1 -w -prec_div -pc80 -pad -ip -DINTEL_VML -traceback -assume buffered_io -I$(MKLROOT)/include<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MPIRUN command&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : mpirun -np _NP_ -machinefile _HOSTS_ _EXEC_<br />
&nbsp;&nbsp; Current settings:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FFTW_LIB + FFTW_OPT&nbsp;&nbsp;&nbsp; : -lfftw3_mpi -lfftw3 -L/usr/local/lib&nbsp; +&nbsp; -DFFTW3 -I/usr/local/include (already set)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ELPA_LIB + ELPA_OPT&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp; +&nbsp;&nbsp; (already set)<br />
&nbsp;&nbsp;&nbsp;&nbsp; RP&nbsp; RP_LIB(SCALAPACK+PBLAS): -lmkl_scalapack_lp64 -lmkl_blacs_intelmpi_lp64 $(R_LIBS)<br />
&nbsp;&nbsp;&nbsp;&nbsp; FP&nbsp; FPOPT(par.comp.options): -O1 -FR -mp1 -w -prec_div -pc80 -pad -ip -DINTEL_VML -traceback -assume buffered_io -I$(MKLROOT)/include -axAVX2<br />
&nbsp;&nbsp;&nbsp;&nbsp; MP&nbsp; MPIRUN command&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : mpirun -np _NP_ -machinefile _HOSTS_ _EXEC_<br />
&nbsp;&nbsp;&nbsp;&nbsp; CN&nbsp; CORES_PER_NODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 1<br />
&nbsp;&nbsp;&nbsp;&nbsp; S&nbsp;&nbsp; Save and Quit<br />
&nbsp;&nbsp;&nbsp;&nbsp; Q&nbsp;&nbsp; Quit abandon changes<br />
&nbsp;&nbsp;&nbsp;&nbsp; To change an item select option.<br />
Selection: s<br />
----------<br />
13) A&nbsp;&nbsp; Compile all programs (suggested)<br />
&nbsp; a<br />
----------<br />
14) ./userconfig_lapw<br />
----------<br />
15) .bashrc<br />
&nbsp; export OMP_NUM_THREADS=4<br />
----------<br />
16) bash<br />
17) w2web<br />
My PC: Intel(R) Xeon(R)&nbsp; E5-2640 v3 (can use SSE4.1/4.2, AVX 2.0), see cpuinfo and web<br />
------------------------------------------------------------------------------<br />
■ VASP 5.4.1 (gfortran, OpenMPI)<br />
1. sudo apt-get install libopenmpi-dev<br />
2. sudo apt-get install liblapack-dev<br />
3. sudo apt-get install libscalapack-mpi-dev<br />
4. sudo apt-get install libfftw3-dev<br />
5. tar zxvf vasp.5.4.1.05Feb16.tar.gz<br />
6. gunzip patch.5.4.1.14032016.gz<br />
&nbsp;&nbsp; gunzip patch.5.4.1.03082016.gz<br />
(get them from http://cms.mpi.univie.ac.at/wiki/index.php/Installing_VASP#Adapting_makefile.include)<br />
7. cd vasp.5.4.1<br />
8. patch -p0 &lt; patch.5.4.1.14032016<br />
&nbsp; &nbsp; patch -p0 &lt; patch.5.4.1.03082016<br />
9. cp arch/makefile.include.linux_gfortran makefile.include<br />
10. gedit makefile.include<br />
&nbsp; -----<br />
# Precompiler options<br />
CPP_OPTIONS= -DMPI -DHOST=\&quot;IFC91_ompi\&quot; -DIFC \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -DCACHE_SIZE=4000 -Davoidalloc \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -DMPI_BLOCK=8000 -DscaLAPACK -Duse_collective \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -Duse_bse_te -Duse_shmem -Dtbdyn<br />
<br />
CPP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = gcc -E -P -C $*$(FUFFIX) &gt;$*$(SUFFIX) $(CPP_OPTIONS)<br />
<br />
FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = mpif90.openmpi<br />
FCL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = mpif90.openmpi<br />
<br />
FREE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = -ffree-form -ffree-line-length-none<br />
<br />
FFLAGS&nbsp;&nbsp;&nbsp;&nbsp; =<br />
OFLAG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = -O2 -mtune=native -m64<br />
OFLAG_IN&nbsp;&nbsp; = $(OFLAG)<br />
DEBUG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = -O0<br />
<br />
LIBDIR&nbsp;&nbsp;&nbsp;&nbsp; = /usr/lib<br />
BLAS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = -L$(LIBDIR) -lblas<br />
LAPACK&nbsp;&nbsp;&nbsp;&nbsp; = -L$(LIBDIR) -llapack<br />
BLACS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = -lblacs-openmpi -lblacsCinit-openmpi -lblacsF77init-openmpi<br />
SCALAPACK&nbsp; = -L$(LIBDIR) -lscalapack-openmpi $(BLACS)<br />
<br />
OBJECTS&nbsp;&nbsp;&nbsp; = fftmpiw.o fftmpi_map.o&nbsp; fftw3d.o&nbsp; fft3dlib.o \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /usr/lib/libfftw3.a<br />
INCS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =-I/usr/include -I/usr/lib/openmpi/include<br />
<br />
LLIBS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = $(SCALAPACK) $(LAPACK) $(BLAS)<br />
<br />
OBJECTS_O1 += fft3dfurth.o fftw3d.o fftmpi.o fftmpiw.o chi.o<br />
OBJECTS_O2 += fft3dlib.o<br />
<br />
# For what used to be vasp.5.lib<br />
CPP_LIB&nbsp;&nbsp;&nbsp; = $(CPP)<br />
FC_LIB&nbsp;&nbsp;&nbsp;&nbsp; = $(FC)<br />
CC_LIB&nbsp;&nbsp;&nbsp;&nbsp; = gcc<br />
CFLAGS_LIB = -O<br />
FFLAGS_LIB = -O1<br />
FREE_LIB&nbsp;&nbsp; = $(FREE)<br />
<br />
OBJECTS_LIB= linpack_double.o getshmem.o<br />
<br />
# Normally no need to change this<br />
SRCDIR&nbsp;&nbsp;&nbsp;&nbsp; = ../../src<br />
BINDIR&nbsp;&nbsp;&nbsp;&nbsp; = ../../bin<br />
&nbsp; -----<br />
11. make all<br />
<br />
□ Usage<br />
/usr/bin/mpirun.openmpi -np 4 $HOME/vasp/vasp.5.4.1/bin/vasp_std<br />
------------------------------------------------------------------------------<br />
■ vasp.5.4 (intel fortran, OpenMPI, gcc libfftw3xf_gnu.a)<br />
1. tar zxvf vasp.5.4.1.05Feb16.tar.gz<br />
2. gunzip patch.5.4.1.14032016.gz<br />
&nbsp;&nbsp; gunzip patch.5.4.1.03082016.gz<br />
(get them from http://cms.mpi.univie.ac.at/wiki/index.php/Installing_VASP#Adapting_makefile.include)<br />
3. cd vasp.5.4.1<br />
4. patch -p0 &lt; patch.5.4.1.14032016<br />
&nbsp; &nbsp; patch -p0 &lt; patch.5.4.1.03082016<br />
5. cp arch/makefile.include.linux_intel makefile.include<br />
6. gedit makefile.include<br />
&nbsp; -----<br />
# Precompiler options<br />
CPP_OPTIONS= -DMPI -DHOST=\&quot;IFC91_ompi\&quot; -DIFC \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -DCACHE_SIZE=4000 -DPGF90 -Davoidalloc \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -DMPI_BLOCK=8000 -DscaLAPACK -Duse_collective \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -Duse_bse_te -Duse_shmem -Dtbdyn<br />
<br />
CPP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = fpp -f_com=no -free -w0&nbsp; $*$(FUFFIX) $*$(SUFFIX) $(CPP_OPTIONS)<br />
<br />
FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = mpif90<br />
FCL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = mpif90 -mkl=sequential<br />
<br />
FREE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = -free -names lowercase<br />
<br />
FFLAGS&nbsp;&nbsp;&nbsp;&nbsp; = -assume byterecl<br />
OFLAG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = -O2 -axAVX2,AVX,SSE4.2<br />
OFLAG_IN&nbsp;&nbsp; = $(OFLAG)<br />
DEBUG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = -O0<br />
<br />
MKL_PATH&nbsp;&nbsp; = $(MKLROOT)/lib/intel64<br />
BLAS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =<br />
LAPACK&nbsp;&nbsp;&nbsp;&nbsp; =<br />
BLACS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = -lmkl_blacs_openmpi_lp64<br />
SCALAPACK&nbsp; = $(MKL_PATH)/libmkl_scalapack_lp64.a $(BLACS)<br />
<br />
OBJECTS&nbsp;&nbsp;&nbsp; = fftmpiw.o fftmpi_map.o fftw3d.o fft3dlib.o \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(MKLROOT)/interfaces/fftw3xf/libfftw3xf_gnu.a<br />
INCS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =-I$(MKLROOT)/include/fftw<br />
<br />
LLIBS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = $(SCALAPACK) $(LAPACK) $(BLAS)<br />
<br />
OBJECTS_O1 += fft3dfurth.o fftw3d.o fftmpi.o fftmpiw.o<br />
OBJECTS_O2 += fft3dlib.o<br />
<br />
# For what used to be vasp.5.lib<br />
CPP_LIB&nbsp;&nbsp;&nbsp; = $(CPP)<br />
FC_LIB&nbsp;&nbsp;&nbsp;&nbsp; = $(FC)<br />
CC_LIB&nbsp;&nbsp;&nbsp;&nbsp; = gcc<br />
CFLAGS_LIB = -O<br />
FFLAGS_LIB = -O1<br />
FREE_LIB&nbsp;&nbsp; = $(FREE)<br />
<br />
OBJECTS_LIB= linpack_double.o getshmem.o<br />
<br />
# Normally no need to change this<br />
SRCDIR&nbsp;&nbsp;&nbsp;&nbsp; = ../../src<br />
BINDIR&nbsp;&nbsp;&nbsp;&nbsp; = ../../bin<br />
&nbsp; -----<br />
7. make all<br />
<br />
□ Usage<br />
/usr/bin/mpirun.openmpi -np 4 $HOME/vasp/vasp.5.4.1/bin/vasp_std<br />
------------------------------------------------------------------------------<br />
■ vasp.5.4 (intel compiler, OpenMPI, icc libfftw3xf_intel.a)<br />
1. tar zxvf vasp.5.4.1.05Feb16.tar.gz<br />
2. gunzip patch.5.4.1.14032016.gz<br />
&nbsp;&nbsp; gunzip patch.5.4.1.03082016.gz<br />
(get them from http://cms.mpi.univie.ac.at/wiki/index.php/Installing_VASP#Adapting_makefile.include)<br />
3. cd vasp.5.4.1<br />
4. patch -p0 &lt; patch.5.4.1.14032016<br />
&nbsp; &nbsp; patch -p0 &lt; patch.5.4.1.03082016<br />
5. cp arch/makefile.include.linux_intel makefile.include<br />
6. gedit makefile.include<br />
&nbsp; -----<br />
# Precompiler options<br />
CPP_OPTIONS= -DMPI -DHOST=\&quot;IFC91_ompi\&quot; -DIFC \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -DCACHE_SIZE=4000 -DPGF90 -Davoidalloc \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -DMPI_BLOCK=8000 -Duse_collective \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -DnoAugXCmeta -Duse_bse_te \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -Duse_shmem -Dtbdyn<br />
<br />
CPP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = fpp -f_com=no -free -w0&nbsp; $*$(FUFFIX) $*$(SUFFIX) $(CPP_OPTIONS)<br />
<br />
FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = mpif90<br />
FCL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = mpif90 -mkl<br />
<br />
FREE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = -free -names lowercase<br />
<br />
FFLAGS&nbsp;&nbsp;&nbsp;&nbsp; = -assume byterecl<br />
OFLAG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = -O2 -axAVX2,AVX,SSE4.2<br />
OFLAG_IN&nbsp;&nbsp; = $(OFLAG)<br />
DEBUG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = -O0<br />
<br />
MKL_PATH&nbsp;&nbsp; = $(MKLROOT)/lib/intel64<br />
BLAS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =<br />
LAPACK&nbsp;&nbsp;&nbsp;&nbsp; =<br />
BLACS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = -lmkl_blacs_openmpi_lp64<br />
SCALAPACK&nbsp; = $(MKL_PATH)/libmkl_scalapack_lp64.a $(BLACS)<br />
<br />
OBJECTS&nbsp;&nbsp;&nbsp; = fftmpiw.o fftmpi_map.o fftw3d.o fft3dlib.o \<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(MKLROOT)/interfaces/fftw3xf/libfftw3xf_intel.a<br />
INCS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =-I$(MKLROOT)/include/fftw<br />
<br />
LLIBS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = $(SCALAPACK) $(LAPACK) $(BLAS)<br />
<br />
OBJECTS_O1 += fft3dfurth.o fftw3d.o fftmpi.o fftmpiw.o<br />
OBJECTS_O2 += fft3dlib.o<br />
<br />
# For what used to be vasp.5.lib<br />
CPP_LIB&nbsp;&nbsp;&nbsp; = $(CPP)<br />
FC_LIB&nbsp;&nbsp;&nbsp;&nbsp; = $(FC)<br />
CC_LIB&nbsp;&nbsp;&nbsp;&nbsp; = icc<br />
CFLAGS_LIB = -O<br />
FFLAGS_LIB = -O1<br />
FREE_LIB&nbsp;&nbsp; = $(FREE)<br />
<br />
OBJECTS_LIB= linpack_double.o getshmem.o<br />
<br />
# Normally no need to change this<br />
SRCDIR&nbsp;&nbsp;&nbsp;&nbsp; = ../../src<br />
BINDIR&nbsp;&nbsp;&nbsp;&nbsp; = ../../bin<br />
&nbsp; -----<br />
7. make all<br />
<br />
□ Usage<br />
/usr/bin/mpirun.openmpi -np 4 $HOME/vasp/vasp.5.4.1/bin/vasp_std<br />
-----------------------------------------------------------------------------<br />
<span style="font-family: Verdana;">■ </span>SPR-KKR<br />
<br />
<span style="font-family: verdana, tahoma, &quot;ＭＳ ゴシック&quot;, &quot;ＭＳ Ｐゴシック&quot;, &quot;ヒラギノ角ゴ Pro W3&quot;, Osaka−等幅, Osaka, 平成角ゴシック, sans-serif;">□ xband</span><br />
1) mkdir&nbsp;sprkkr<br />
2) cd sprkkr<br />
3) mkdir xband<br />
4) cd xband<br />
5) cp $HOME/Downloads/xband_6.3.tar.gz .<br />
6) tar -zxvf&nbsp;xband_6.3.tar.gz<br />
7) gedit ~/.bashrc<br />
&nbsp;&nbsp; export XBANDPATH=$HOME/sprkkr/xband<br />
&nbsp;&nbsp; export PATH=$PATH:$XBANDPATH:<br />
&nbsp;&nbsp; export XLIB_SKIP_ARGB_VISUALS=1<br />
8) bash<br />
----------<br />
gfortran case<br />
9)&nbsp; rewrite<br />
&nbsp;&nbsp; gedit geometry/Makefile<br />
&nbsp;&nbsp;&nbsp;&nbsp; FC=ifort -&gt;&nbsp;FC=gfortran<br />
&nbsp;&nbsp; gedit graphics/makefile<br />
&nbsp;&nbsp;&nbsp;&nbsp; linuxFC=ifort -&gt;&nbsp;linuxFC=gfortran<br />
&nbsp;&nbsp;&nbsp;&nbsp; linux-gnuFC = ifort -&gt; linux-gnuFC = gfortran<br />
&nbsp;&nbsp;&nbsp;&nbsp; FC=ifort -O2 -&gt; FC=gfortran -O2<br />
&nbsp;&nbsp; gedit spheres/makefile<br />
&nbsp;&nbsp;&nbsp;&nbsp; linuxFC=ifort -&gt;&nbsp;linuxFC=gfortran<br />
&nbsp;&nbsp;&nbsp;&nbsp; FC=ifort -O2 -&gt; FC=gfortran -O2<br />
&nbsp;&nbsp; gedit symmetry/makefile<br />
&nbsp;&nbsp;&nbsp;&nbsp; linuxFC = ifort -&gt; linuxFC = gfortran<br />
&nbsp;&nbsp;&nbsp;&nbsp; FC=ifort -&gt;&nbsp;FC=gfortran -O2<br />
10) xband<br />
----------<br />
Intel fortran case<br />
9) xband<br />
----------<br />
<br />
<span style="font-family: verdana, tahoma, &quot;ＭＳ ゴシック&quot;, &quot;ＭＳ Ｐゴシック&quot;, &quot;ヒラギノ角ゴ Pro W3&quot;, Osaka−等幅, Osaka, 平成角ゴシック, sans-serif;">□</span> SPRKKR&nbsp;6.3<br />
1) cp $HOME/Downloads/sprkkr6.3.2pub20121219.tgz ./sprkkr<br />
2) cd sprkkr<br />
3) tar -zxvf $HOME/Downloads/sprkkr6.3.2pub20121219.tgz<br />
4) cp make.inc_example make.inc<br />
5) gedit make.inc<br />
&nbsp; LIB = -L/usr/local/lib -llapack -lblas<br />
&nbsp; LIBMPI = -L/usr/local/lib -lscalapack -llapack -lblas<br />
&nbsp; LIBMPI=<br />
&nbsp; INCLUDE = -I/usr/local/openmpi/include<br />
&nbsp; FFLAGS =&nbsp;-lgfortran -L/usr/lib/gcc/x86_64-linux-gnu/4.9 -O2 -fstack-arrays -m64 -fsignaling-nans -funroll-all-loops -mtune=native -march=native -ftree-vectorize -ffast-math -fno-protect-parens<br />
&nbsp; FC = mpif90 -c $(FFLAGS) $(INCLUDE)<br />
&nbsp; LINK = mpif90 $(FFLAGS) $(INCLUDE)<br />
6) make scfmpi（single type: make scf )<br />
&nbsp;&nbsp; 上記の作業で binary が作成される。PCが 4 core の場合は下記となる<br />
&nbsp;&nbsp;&nbsp; mpirun -np 4 kkrscf6.3MPI *.inp &gt; OUTPUT<br />
7) この他にもプログラムを作成することができる<br />
&nbsp;&nbsp; a) make all<br />
&nbsp;&nbsp;&nbsp;&nbsp; gen, scf, embgen, embscf が作成される<br />
&nbsp;&nbsp; b) make allmpi<br />
&nbsp;&nbsp;&nbsp;&nbsp; scfmpi, embscfmpi, specmpi が作成される<br />
&nbsp;&nbsp; c) Makefile を見ると一応下記のコマンドがある<br />
&nbsp;&nbsp;&nbsp;&nbsp; make genmpi, make embscfmpi, make chi,<br />
&nbsp;&nbsp;&nbsp; make opm, make opmmpi, make spec<br />
<br />
<span style="font-family: verdana, tahoma, &quot;ＭＳ ゴシック&quot;, &quot;ＭＳ Ｐゴシック&quot;, &quot;ヒラギノ角ゴ Pro W3&quot;, Osaka−等幅, Osaka, 平成角ゴシック, sans-serif;">□</span> SPRKKR 7.7.1 (gfortran)<br />
0) install<br />
&nbsp; sudo apt-get install openmpi-bin<br />
&nbsp; sudo apt-get install libopenmpi-dev<br />
&nbsp; sudo apt-get insatll libblas-dev liblapack-dev<br />
&nbsp; mkdir bin<br />
&nbsp; sudo apt-get install emacs<br />
1) cp $HOME/Downloads/PUB7.7.1_170921_09h44.tar.gz ./sprkkr<br />
2) cd sprkkr<br />
3) tar -zxvf $HOME/Downloads/PUB7.7.1_170921_09h44.tar.gz<br />
4) gedit make.inc<br />
&nbsp;&nbsp;&nbsp; BUILD_TYPE :=<br />
&nbsp;&nbsp;&nbsp; LIB = -L/usr/lib -llapack -lblas<br />
&nbsp;&nbsp;&nbsp; INCLUDE = -I/usr/lib/openmpi/include/<br />
&nbsp; &nbsp; FFLAGS = -O2 -axSSE4.2 -diag-disable remark<br />
&nbsp;&nbsp;&nbsp; FFLAGS = -O2<br />
4.1) &nbsp;export LANG=en_US<br />
&nbsp; (Note: Japanese character case)<br />
5) make scfmpi（single type: make scf )<br />
&nbsp;&nbsp; 上記の作業で binary が作成される。PCが 4 core の場合は下記となる<br />
&nbsp;&nbsp;&nbsp; mpirun -np 4 kkrscf6.3MPI *.inp &gt; OUTPUT<br />
6) この他にもプログラムを作成することができる<br />
&nbsp;&nbsp; a) make all<br />
&nbsp;&nbsp;&nbsp;&nbsp; gen, scf, embgen, embscf が作成される<br />
&nbsp;&nbsp; b) make allmpi<br />
&nbsp;&nbsp;&nbsp;&nbsp; scfmpi, embscfmpi, specmpi が作成される<br />
&nbsp;&nbsp; c) Makefile を見ると一応下記のコマンドがある<br />
&nbsp;&nbsp;&nbsp;&nbsp; make genmpi, make embscfmpi, make chi,<br />
&nbsp;&nbsp;&nbsp;&nbsp; make opm, make opmmpi, make spec<br />
7) you can get executable file in $HOME/bin directory<br />
&nbsp; cp -r $HOME/bin $HOME/sprkkr/bin</p>
<br />
run on terminal (1 CPU)<br />
$HOME/sprkkr/bin/kkrscf7.7.0 &lt; AlVFe2_SCF.inp&nbsp; &gt; AlVFe2_SCF.out<br />
-----------------------------------------------------------------------------