　ここでは形成エネルギーの計算方法に関する情報についてまとめる<br />
-----------------------------------------------------------------------------<br />
■ 欠陥形成での形成エネルギー の計算<br />
<br />
□ 形成エネルギー = スーパーセルで欠陥を含んだ全エネルギー　?　完全結晶の全エネルギー + &Sigma;（欠陥形成のために結晶に出入りする原子種の数（整数）* 化学ポテンシャル） + 点欠陥の持つ有効電荷 * 系のフェルミエネルギー<br />
<br />
□ スーパーセルで欠陥を含んだ全エネルギー<br />
・スーパーセルを作成して欠陥を含んだ系を計算する（200原子程度）。<br />
・k点は単位胞のときに1000点程度で計算していたとすると、2x2x2のスーパーセルでは1000/(2x2x2)のk点を用いる。<br />
<br />
□ 化学ポテンシャル (&mu;Al<sub>2</sub>O<sub>3</sub> や&mu;O)の計算方法<br />
・&mu;Al<sub>2</sub>O<sub>3 </sub>= Al<sub>2</sub>O<sub>3</sub>での全エネルギー　または　2*&mu;Al + 3*&mu;O<br />
通常は、完全結晶のAl<sub>2</sub>O<sub>3</sub>を計算すればよい。<br />
・&mu;O = O<sub>2</sub>の全エネルギー / 2<br />
真空層を 10オングストローム（1nm）以上入れた酸素分子を計算して、得られたエネルギーを1/2倍すればよい。k点は&Gamma;点の1点のみで良い。<br />
<br />
□ 分圧を考慮した場合の化学ポテンシャルの計算方法<br />
・&mu;O =[O<sub>2</sub>の全エネルギー(0 K) +&nbsp;&mu;O<sub>2</sub>(T,P<sub>O2<sup>0</sup></sub>) +&nbsp;k<sub>B</sub>*T*ln (P<sub>O2</sub>/P<sub>O2<sup>0</sup></sub>) ] / 2<br />
ここで、k<sub>B</sub> はボルツマン定数、Tは絶対温度(K)、P<sub>O2<sup>0</sup></sub>はO<sub>2</sub>に対する参照圧力（通常1atm）、P<sub>O2</sub>はO<sub>2</sub>に対する分圧。<br />
&nbsp; O<sub>2</sub>の全エネルギー(0 K)は第一原理計算で求められる。<br />
&nbsp; &mu;O(T,P<sub>O2<sup>0</sup></sub>)&nbsp; はNIST-JANAF Thermochemical Tablesに掲載されている。他の気体についても同様。<br />
<br />
□ 水溶液中での化学ポテンシャルの計算方法<br />
・&mu;Ca = Caの全エネルギー（計算値）　+ 水和エネルギー等の実験値&nbsp;+ k<sub>B</sub>*T*ln (Ca{mol/l})<br />
・ln (Ca{mol/l}) は NISTやJANAF の thermochemical table を用いるとよい。<br />
<br />
□ 点欠陥<br />
・点欠陥の持つ有効電荷 = 0 の場合：系のフェルミエネルギーの計算は必要なし<br />
・点欠陥の持つ有効電荷 &ne; 0 の場合：系のフェルミエネルギーを未知の変数としてx軸にし、形成エネルギーをy軸として、 幾つか想定される点欠陥の有効電荷でグラフを描く。そうして、形成エネルギーが最も小さく、電気的中性条件が満たされる欠陥の組み合わせを採用する<br />
※ 想定される価数は左欄の「基礎無機化学　理解への道」を参照）<br />
<br />
□&nbsp;点欠陥の計算での注意事項<br />
・理論計算では、電荷の中性を保つためにバックグラウンドに電荷があてられます。縦軸にエネルギー、横軸に 1/L = (1/V)<sup>1/3</sup> &prop; (1/N)<sup>1/3</sup> として、幾つかのスーパーセルで計算して直線で横軸が0のときのエネルギーを採用するようにします(Makov and Payne, Phys. Rev. B 51&nbsp;(1995) 4014.: <a href="http://journals.aps.org/prb/abstract/10.1103/PhysRevB.51.4014">http://journals.aps.org/prb/abstract/10.1103/PhysRevB.51.4014</a>)。この方法を用いないと、200?300原子を用いたスーパーセルでも大きな誤りを導いてしまいます。<br />
・直線で引いたときの傾きの大きさは、欠陥レベルがどれだけ局在しているかによります。想像が付くように、局在しているとスーパーセルサイズの依存性が小さくなります。<br />
・ギャップの補正も必要です（S. B. Zhang et al., Phys. Rev. B (1998)）。通常、LDAやGGAはギャップを小さく見積るので、PBE0やHSEを用いたりすることも行われます（大きなギャップの系では、&alpha;の値を単位胞のときに実験のギャップの値を再現するように指定したりします）。他の手法が使われることもあります（LDA+Uなど）。<br />
・クーロン相互作用は長距離まで影響を与えるので大きなスーパーセルが必要（FNVセルサイズ補正法で対処する方法もある）<br />
・イオン性が強いとアニオンとカチオンが入れ替わりにくい<br />
・欠陥化学において格子欠陥を表記するための方法として、クレーガー=ビンクの表記法が使われたりする<br />
・Cuはp型になりやすい傾向がある<br />
・2019年末、著名な先生に相談すると、欠陥の計算はスピン軌道相互作用（SO）を入れずに計算しているそうです。一方、バンドギャップは重元素でSOを入れないと合いが悪いのでSOが重要になる。<br />
※ 点欠陥の計算におけるエラーを0.1 eV程度に低減する方法として、FNVセルサイズ補正法（Freysoldt et al., PRL 2009）がある。これは格子緩和後や層状構造にも有効である。関連する論文としては、Kumagai and Oba, Phys. Rev. B 89 (2014) 195205.がある。これらに関連する補正法は、sxdefectalign, PyCDT, CoFFEEなどで実装されている<br />
※ 著名な先生だとVASPで計算されたりする<br />
※ 余談：NEBで拡散経路を計算すると、点欠陥など、原子の通り易い経路で活性化エネルギーが小さくなる。原子が通り易そうな空間が出来るモデルが無いかを考えてみることとも大切（複合空孔であるSchottkey空孔も調べてみたりする。バックボンドが強くなって点結果の効果があまり見られないこともあることは知っておくと良い）。（第一原理計算は0 Kの計算となるが、活性化エネルギーをかなりよく再現する。計算と合わなければモデル（結晶構造）が間違っている可能性を検討する）<br />
-----------------------------------------------------------------------------<br />
□ 電気的中性条件を考慮した系のフェルミエネルギーの計算方法<br />
<br />
・想定される全ての欠陥のモデルを作り、各モデルに対して全エネルギーを算出する。そして、以下の式で系のフェルミエネルギーを決定する。<br />
&nbsp; C<sub>&beta;</sub> = N<sub>&beta;</sub>*exp(?形成エネルギー/(k<sub>B</sub>*T))<br />
&nbsp; &sum;q<sub>&beta;</sub>*C<sub>&beta;</sub>= 0 (q<sub>&beta; </sub>: 欠陥<sub>&beta;</sub>の電荷)<br />
ここで、N<sub>&beta;</sub>は単位体積あたりに欠陥&beta;が入りることが出来るサイト数。<br />
-----------------------------------------------------------------------------<br />
■ 表面・界面エネルギー の計算<br />
<br />
□ 表面・界面エネルギー＝(1/ (2*界面面積))*(スーパーセルの全エネルギー ? &sum;(N<sub>i</sub> * &mu;<sub>i</sub>))<br />
ここで、N<sub>i </sub>はスーパーセル内に含まれる各原子iの数、&mu;<sub>i</sub>は原子iの化学ポテンシャル。<br />
・表面・界面エネルギーの計算は6層?10層程度で計算する<br />
・表面エネルギーの計算では、真空層 10オングストローム（1 nm）を入れたミラー対称のスーパーセルを作成する<br />
・界面エネルギーの計算では、真空層 10オングストローム（1 nm）の代わりに計算したい構造に替える<br />
・界面が化学量論比でない場合は、化学ポテンシャルを未知の変数としてx軸にし、表面エネルギーをy軸としてグラフをプロットする・界面密着性を計算する場合には、格子定数を少し伸ばした値を入力ファイルに入力し、構造最適化を行う。これを徐々に繰り返して傾向をプロットしていく<br />
-----------------------------------------------------------------------------<br />
■ 具体的な計算方法の情報<br />
<br />
※ VASPでは<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: rgb(17, 17, 17); font-family: Roboto,Arial,sans-serif; font-size: 13.93px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.3; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&quot;NELECT&quot;で</span>点欠陥の有効電荷<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: rgb(17, 17, 17); font-family: Roboto,Arial,sans-serif; font-size: 13.93px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.3; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">を変える。NELECTの電子数を+1すると欠陥は-1に、逆に電子数を-1にすると欠陥は+1された状態をシミュレートする。全体の電荷は中性となるようになっている。</span><br />
<br />
・How to calculate the formation energy of a charged defect ?<br />
（https://www.researchgate.net/post/How_to_calculate_the_formation_energy_of_a_charged_defect）
<div class="nova-e-text nova-e-text--size-m nova-e-text--family-sans-serif nova-e-text--spacing-s nova-e-text--color-inherit redraft-text" style="text-align: left; color: inherit; text-transform: none; line-height: 1.3; text-indent: 0px; letter-spacing: normal; font-size: 0.87rem; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; margin-top: 0px; margin-bottom: 15px; word-spacing: 0px; white-space: normal; orphans: 2; -webkit-text-stroke-width: 0px;"><font face="Roboto,Arial,sans-serif">Dear all,<br />
I read in some references that in order to include a charged defect in VASP calculation, we need to add electrons (holes) into the defect cell until the additional charge relax into conduction (valence) band. I have two questions:&nbsp;</font></div>

<ol class="nova-e-list nova-e-list--size-m nova-e-list--type-ordered nova-e-list--spacing-auto" style="list-style: decimal; margin: 0px 0px 1.42em 1.2em; padding: 0px; text-align: left; color: inherit; text-transform: none; line-height: 1; text-indent: 0px; letter-spacing: normal; font-size: 0.87rem; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; word-spacing: 0px; white-space: normal; orphans: 2; -webkit-text-stroke-width: 0px;">
	<li class="nova-e-list__item" style="line-height: 1.3; margin-bottom: 0.5em;"><font face="Roboto,Arial,sans-serif">How to add additional electrons or holes? Is it to set the parameter &quot;NELECT&quot; relative to that of valence electron Numbers of a neutral cell?&nbsp;</font></li>
	<li class="nova-e-list__item" style="line-height: 1.3;"><font face="Roboto,Arial,sans-serif">Whether the charged state is localized or belongs to the whole supercell? how to evaluate this?</font></li>
</ol>

<div class="nova-e-text nova-e-text--size-m nova-e-text--family-sans-serif nova-e-text--spacing-s nova-e-text--color-inherit redraft-text" style="text-align: left; color: inherit; text-transform: none; line-height: 1.3; text-indent: 0px; letter-spacing: normal; font-size: 0.87rem; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; margin-top: 0px; margin-bottom: 15px; word-spacing: 0px; white-space: normal; orphans: 2; -webkit-text-stroke-width: 0px;"><font face="Roboto,Arial,sans-serif">Any favorable suggestions are&nbsp;greatly appreciated!<br />
Thanks in advance!<br />
Reference:&nbsp;<a class="nova-e-link nova-e-link--color-inherit nova-e-link--theme-decorated" href="https://www.researchgate.net/deref/http%3A%2F%2Fdx.doi.org%2F10.1016%2Fj.jnucmat.2010.10.088" rel="noopener" style="background: none; margin: 0px; padding: 0px; outline: invert; border: 0px; border-image: none; text-align: inherit; color: inherit; font-size: inherit; font-weight: inherit; text-decoration: underline; display: inline; cursor: pointer;" target="_blank">http://dx.doi.org/10.1016/j.jnucmat.2010.10.088</a><br />
----------A1<br />
&nbsp; To study charged defect using the supercell method as included in many DFT packages, we can add or remove some electrons from the neutral supercell trought the parameter nelec (nombre of electron in the system). we should note here that adding electrons means a negative state for the defect while removing electrons simulate the case of the positive charged defects. in addition, the code will automatically add a backgroung jellium to make the supercell in neutral charge and the &nbsp;jellium charge is distributed in the voulme but &nbsp;it will be localized near the defects. the rest of the work will be done by the code to deduce the eignvalue as well as the defect related levels.<br />
----------A2<br />
&nbsp; Calculation of charged defects is a topic which has gotten much interest in recent years. Unfortunately there are a lot of problems which pop up when you want to calculate such systems using ab-initio methods. Often the charge needs to be localized (Note that Gaussian basis sets will do this for the wrong reason, eg:&nbsp;J. Comput. Chem. 34(5), 422-427 (2013),) which can be hard for standard DFT with a plane wave basis-set (such as VASP). Depending on the materials you are working with, it may be interesting to check if DFT+U methods are used (required) for one or more of the composing elements. If so, using them can give rise to the required localisation. When I was studying a MOF which contained TiO-clusters including +U parameters for Ti resulted in the experimentally observed localisation, which was nicely visualized by plotting the atomic charges calculated using the Hirshfeld-I atoms-in-molecules partitioning scheme (Hirshfeld-i: J. Comput. Chem. 34(5), 405-417 (2013), TiO-containing MOF, in the SI of Angew. Chem. Int. Ed. 54(47), 13912-13917 (2015)). This just to give a picture of the localisation issue. Luckily VASP is rather good at handling such systems, once you know how to get the required localisation.</font></div>

<div class="nova-e-text nova-e-text--size-m nova-e-text--family-sans-serif nova-e-text--spacing-s nova-e-text--color-inherit redraft-text" style="text-align: left; color: inherit; text-transform: none; line-height: 1.3; text-indent: 0px; letter-spacing: normal; font-size: 0.87rem; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; margin-top: 0px; margin-bottom: 15px; word-spacing: 0px; white-space: normal; orphans: 2; -webkit-text-stroke-width: 0px;"><font face="Roboto,Arial,sans-serif">For practically calculating the defect formation energy in case of charged defects, there is a really useful paper by Lany and Zunger on this:</font></div>

<div class="nova-e-text nova-e-text--size-m nova-e-text--family-sans-serif nova-e-text--spacing-s nova-e-text--color-inherit redraft-text" style="text-align: left; color: inherit; text-transform: none; line-height: 1.3; text-indent: 0px; letter-spacing: normal; font-size: 0.87rem; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; margin-top: 0px; margin-bottom: 15px; word-spacing: 0px; white-space: normal; orphans: 2; -webkit-text-stroke-width: 0px;"><font face="Roboto,Arial,sans-serif">Phys. Rev. B 78, 235104 (2008)</font></div>

<div class="nova-e-text nova-e-text--size-m nova-e-text--family-sans-serif nova-e-text--spacing-s nova-e-text--color-inherit redraft-text" style="text-align: left; color: inherit; text-transform: none; line-height: 1.3; text-indent: 0px; letter-spacing: normal; font-size: 0.87rem; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; margin-top: 0px; margin-bottom: 15px; word-spacing: 0px; white-space: normal; orphans: 2; -webkit-text-stroke-width: 0px;"><font face="Roboto,Arial,sans-serif">You may also want to have a look at the review paper by Kresse of the First-Principles calculation of point defects in solids:</font></div>

<div class="nova-e-text nova-e-text--size-m nova-e-text--family-sans-serif nova-e-text--spacing-s nova-e-text--color-inherit redraft-text" style="text-align: left; color: inherit; text-transform: none; line-height: 1.3; text-indent: 0px; letter-spacing: normal; font-size: 0.87rem; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; margin-top: 0px; margin-bottom: 15px; word-spacing: 0px; white-space: normal; orphans: 2; -webkit-text-stroke-width: 0px;"><font face="Roboto,Arial,sans-serif">Rev. Mod. Phys. 86, 253-305 (2014)</font></div>

<div class="nova-e-text nova-e-text--size-m nova-e-text--family-sans-serif nova-e-text--spacing-s nova-e-text--color-inherit redraft-text" style="color: inherit; font-family: Roboto,Arial,sans-serif; font-size: 0.87rem; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.3; margin-bottom: 15px; margin-top: 0px; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">These two papers will help you out a lot, mainly with regard to the title question. The first question would be answered with setting NELECT as you state, but in addition, you may want/need to play with NUPDOWN, MAGMOM and the DFT+U related parameters. For your second question regarding the evaluation of the localisation, there I think Hirshfeld-I charges will be of use, as they will give you a quantitative picture.<br />
----------A3
<div class="nova-e-text nova-e-text--size-m nova-e-text--family-sans-serif nova-e-text--spacing-s nova-e-text--color-inherit redraft-text" style="color: inherit; font-family: Roboto,Arial,sans-serif; font-size: 0.87rem; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.3; margin-bottom: 15px; margin-top: 0px; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; As far as I know VASP does not have an implementations of Lany Zunger corrections. One can also use the FNV corrections, which is a more versatile approach since it is extendable to low-dimensional systems as well. FNV has been recently implemented in the CoFFEE code:<br />
<br />
Code: <a class="nova-e-link nova-e-link--color-inherit nova-e-link--theme-decorated" href="https://www.researchgate.net/deref/http%3A%2F%2Fwww.physics.iisc.ernet.in%2F~mjain%2Fpages%2Fsoftware.html" rel="noopener" style="background: none; margin: 0px; padding: 0px; outline: invert; border: 0px; border-image: none; text-align: inherit; color: inherit; font-size: inherit; font-weight: inherit; text-decoration: underline; display: inline; cursor: pointer;" target="_blank">http://www.physics.iisc.ernet.in/~mjain/pages/software.html</a><br />
----------A4<br />
By following<br />
&nbsp;&nbsp; S. K. Nayak et al., Phys. Status Solidi RRL. (2014) 1-5.<br />
&nbsp; &nbsp;<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: rgb(60, 64, 67); font-family: arial,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.58; orphans: 2; overflow-wrap: break-word; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">https://doi.org/10.1002/</span><em style="color: rgb(82, 86, 90); font-family: arial,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: bold; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">pssr</em><span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: rgb(60, 64, 67); font-family: arial,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.58; orphans: 2; overflow-wrap: break-word; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">.</span><em style="color: rgb(82, 86, 90); font-family: arial,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: bold; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">201409032</em><br />
and&nbsp;<br />
&nbsp; S. Lany et al., Modeling Simul. Mater. Eng. 17 (2009) 084002<br />
<br />
E_formation(D,q) = E(D,q) - E(host defect free) + Sum[n(i)*&mu;(i)] + q(Ev + delta E_F)<br />
&nbsp; E_formaiion(D,q) = formation energy of point defect D with supercell charge q<br />
&nbsp; E(D,q) = total energy of the point defect D with supercell charge q<br />
&nbsp; E(host defect free)&nbsp; = E(host defect free) = total energy of host supercell<br />
<br />
containing equivalent number of atoms as that of the defect supecell<br />
&nbsp;&nbsp;Sum[n(i)*&mu;(i)]&nbsp; = the growth conditions for the crystal are incorporated through the chemical potentials &mu;(i) of the elemental species with the number n(i) of atoms added (n(i) negative) or removed (n(i) positive) from the pure host<br />
&nbsp; Ev + delta E_F: the Fermi level E_F is referenced with respect to the valence band maximum Ev and is related to Ev as&nbsp;<br />
&nbsp; Ev + delta E_F (from pure host calculations)<br />
<br />
|&lt;--------Eg-----------&gt;|<br />
Ev &nbsp; &nbsp; &nbsp; E_F &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Ec<br />
0(if EVBM) &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Ec<br />
<br />
Ev = valence band maximum<br />
Ec = conduction band minimum<br />
Eg = band gap<br />
Ev &lt; E_F &lt; Ec<br />
<br />
if we set Ev to zero, then E_F is between 0 and Eg (as varying parameter).<br />
<br />
Now what is Ev ?<br />
In principle, Ev can be obtained from total energy difference between neutral calculation E(n) and one charge calculation.<br />
E(n-1) for a very large supercell<br />
&nbsp; Ev = E(N) - E(N-1) for N ---&gt; large<br />
Or simply do a test neutral calculation with a unit cell.<br />
Then subtract ne electron slowly. i.e. from delta(q) = 0 e to 1 e removed in the interval delta(q) such as of 0.01. Then plot the total energy,<br />
&nbsp; E(delta(q)=0) - E(delta(q)) vs. log<sub>10</sub>(1/delta(q))<br />
A curve with saturation value will be obtained. This saturated value should gives Ev (It is equivalent to the energy needed to add or remove a charge to alter the Fermi energy in the charged calculations).<br />
<br />
&nbsp; In VASP, e.g. if one plots the DOS, the Fermi energy obtained from OUTCAR file should be equal to Ev (If the Fermi level lies exactly at the valence band maximum (VBM), otherwise one needs to shift the Fermi level to the VBM. The amount of this shift is subtracted from Fermi energy obtained in OUTCAR file.<br />
&nbsp; One could compare all these unmbers in the 3 methods described. e.g. consider ZnO with 96 atoms total, remove one oxygen atom and put charge q, then we have ZnO:Vo:q<br />
&nbsp; E_formation(ZnO:Vo:q) = E_tot_supercell(ZnO:Vo:q) - [ E_tot_supercell(ZnO) -&nbsp; &mu;(one O) ] + q*(Ev + delta E_F)<br />
i.e.&nbsp;<br />
&nbsp; E(95 atoms) - [ E(96 atoms of pure) - E(one oxygen atom) ] + q*(Ev + delta E_F)<br />
as explained&nbsp;<br />
&nbsp; &mu;O approx. = (1/2)*E(O2) (put 2 oxygen atoms in a large supercell)<br />
Half of the total energy of O2 molecule gives the chemical potential of oxygen (&mu;O).<br />
----------<br />
-----------------------------------------------------------------------------<br />
■&nbsp; References<br />
<br />
[1] 「アドバンス/スーパーコンピューティング・サービス」<br />
[2] 佐々木泰造ら「密度汎関数理論入門 理論とその応用」吉岡書店<br />
[3]&nbsp;Makov and Payne, Phys. Rev. B 51&nbsp;(1995) 4014.<br />
&nbsp; <a href="http://journals.aps.org/prb/abstract/10.1103/PhysRevB.51.4014">http://journals.aps.org/prb/abstract/10.1103/PhysRevB.51.4014</a>)<br />
[4]&nbsp;S. B. Zhang et al., Phys. Rev. B (1998)<br />
[5]&nbsp;Freysoldt et al., PRL 2009<br />
[6]&nbsp;Kumagai and Oba, Phys. Rev. B 89 (2014) 195205.<br />
[7]&nbsp;How to calculate the formation energy of a charged defect<br />
&nbsp; https://www.researchgate.net/post/How_to_calculate_the_formation_energy_of_a_charged_defect<br />
[8]&nbsp;How can I calculate the defect formation energy by DFT ?<br />
&nbsp; https://www.researchgate.net/post/How_can_I_calculate_the_defect_formation_energy_by_DFT<br />
[9] S. Masoumi et al, Phys. Chem. Chem. Phys. 21 (2018)14688-14693.<br />
&nbsp;&nbsp;https://pubs.rsc.org/en/content/articlelanding/2018/cp/c8cp01578c#!divAbstract<br />
&nbsp; Quantum Espresso, GGA(PBE) and PBE0 (&alpha;=0.34), ZnO<br />
&nbsp; Norm conserving pseudo-potentials: Zn (3d<sup>10</sup> 4s<sup>2</sup>), O(2s<sup>2</sup> 2p<sup>4</sup>)<br />
&nbsp; ZnO: cutoff 70 Ry, 6x6x3 k-points, a=0.331 nm, c/a=1.61, Zn-O=0.202 nm<br />
&nbsp; ZnO(3x3x2): 2x2x2 k-points (relaxing all atomic positions, PBE)<br />
&nbsp; force tolerance: 10<sup>-6</sup> Ry/Angstrom<br />
&nbsp; stress tolerance: 10<sup>-4</sup> Ry/Angstrom<sup>3</sup><br />
[10] C-J. Yu et al.,&nbsp;https://arxiv.org/pdf/1305.3994.pdf<br />
[11]&nbsp;Chalcogenide Semiconductor Research and Applications Tutorial<br />
&nbsp;&nbsp;https://jaramillo.mit.edu/sites/default/files/2017%20CSRA%20-%20Lany%20tutorial%20-%20first%20principles%20calculations.pdf<br />
[12] P. Erhart et al., Phys. Rev. B 72 (2005) 085213.<br />
&nbsp; Abinit, LDA,&nbsp;Norm conserving pseudo-potentials (Troullier and Martines)<br />
&nbsp; ZnO: cutoff 35 Hatree, a=0.32005 nm, c/a=1.6131 nm, u=0.3792<br />
&nbsp; convergence of total energies better than 0.05 eV<br />
&nbsp; suprecell (64 atoms)<br />
&nbsp; 16 k-points (Monkhost-Pack grid)<br />
[12] R. Ramprasad et al., https://th.fhi-berlin.mpg.de/site/uploads/Publications/PRL-in-print_Ramprasad.pdf<br />
[13] A Theoretical Study on the Surface of Zinc Oxide<br />
&nbsp; https://discovery.ucl.ac.uk/id/eprint/1493454/1/phd-thesis.pdf<br />
[14] Calculating the formation energies of charged defects Introduction<br />
&nbsp; https://wiki.fysik.dtu.dk/gpaw/dev/tutorials/defects/defects.html<br />
&nbsp; GPAWを用いたGaAsでのVGa3-の計算方法（2x2x2のスーパーセルを用いている）。<br />
&nbsp; &quot;Here we briefly discuss the other ingredients needed to calculate defect formation energies using the Zhang-Northrup formula. First, the valence band position ?v must be obtained from a calculation on the pristine unit cell, with a dense enough k-point sampling so that the band edge is included (for GaAs this just means that the &Gamma; point is included).&quot; (where ?<sub>v</sub> is the valence band maximum, then ?<sub>v</sub> = E<sub>VBM</sub>)<br />
<span style="text-align: left; color: black; text-transform: none; line-height: 1.5; text-indent: 0px; letter-spacing: normal; font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; word-spacing: 0px; display: inline; white-space: normal; orphans: 2; float: none; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">[15] Formation energies of charged defects<br />
&nbsp; https://docs.quantumwise.com/tutorials/charged_defects/charged_defects.html<br />
&nbsp; https://docs.quantumatk.com/_downloads/charged_defects.pdf<br />
&nbsp; https://docs.quantumatk.com/_downloads/ppt_charged_defects.pdf<br />
&nbsp; QuantumATKを用いたGaAsでのVAs3-の計算方法<br />
&nbsp; &quot;Setup the undefected supercell to calculate E<sub>tot</sub>[bulk] and E<sub>VBM</sub>&quot;</span><br />
-----------------------------------------------------------------------------<br />
■ ZnO (PWscf)<br />
<br />
□ step 1 (Zn, P6<sub>3</sub>/mmc (194))<br />
0. wget https://www.quantum-espresso.org/upf_files/Zn.pbe-dnl-kjpaw_psl.1.0.0.UPF<br />
1.&nbsp;gedit zn.in<br />
----------<br />
&amp;CONTROL<br />
&nbsp; calculation &nbsp;= 'vc-relax' ,<br />
&nbsp; prefix &nbsp;= 'zn' ,<br />
&nbsp; outdir &nbsp;= './work/' ,<br />
&nbsp; pseudo_dir = './' ,<br />
/<br />
&amp;SYSTEM<br />
&nbsp; ibrav = 0<br />
&nbsp; A = &nbsp; &nbsp;2.62673<br />
&nbsp; nat = 2<br />
&nbsp; ntyp = 1<br />
&nbsp; ecutwfc &nbsp;= 40 ,<br />
&nbsp; ecutrho &nbsp;= 160 ,<br />
&nbsp; occupations = 'smearing' ,<br />
&nbsp; degauss &nbsp;= 0.02 ,<br />
&nbsp; smearing = 'mp',<br />
&nbsp; nspin = 2 ,<br />
&nbsp; starting_magnetization(1) = 1 ,<br />
&nbsp; tot_magnetization = -1 ,<br />
&nbsp; exxdiv_treatment = 'gygi-baldereschi' ,<br />
&nbsp; x_gamma_extrapolation = .true. ,<br />
/<br />
&amp;ELECTRONS<br />
&nbsp; conv_thr = 1.0e-04 ,<br />
&nbsp; mixing_beta = 0.7 ,<br />
/<br />
<span style="text-align: left; color: inherit; text-transform: none; line-height: 1.3; text-indent: 0px; letter-spacing: normal; font-size: 0.87rem; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; word-spacing: 0px; display: inline !important; white-space: normal; orphans: 2; float: none; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">&amp;IONS</span><br style="text-align: left; color: rgb(0, 0, 0); text-transform: none; text-indent: 0px; letter-spacing: normal; font-size: 13.93px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; word-spacing: 0px; white-space: normal; orphans: 2; -webkit-text-stroke-width: 0px;" />
<span style="text-align: left; color: inherit; text-transform: none; line-height: 1.3; text-indent: 0px; letter-spacing: normal; font-size: 0.87rem; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; word-spacing: 0px; display: inline !important; white-space: normal; orphans: 2; float: none; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">/</span><br style="text-align: left; color: rgb(0, 0, 0); text-transform: none; text-indent: 0px; letter-spacing: normal; font-size: 13.93px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; word-spacing: 0px; white-space: normal; orphans: 2; -webkit-text-stroke-width: 0px;" />
<span style="text-align: left; color: inherit; text-transform: none; line-height: 1.3; text-indent: 0px; letter-spacing: normal; font-size: 0.87rem; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; word-spacing: 0px; display: inline !important; white-space: normal; orphans: 2; float: none; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">&amp;CELL</span><br style="text-align: left; color: rgb(0, 0, 0); text-transform: none; text-indent: 0px; letter-spacing: normal; font-size: 13.93px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; word-spacing: 0px; white-space: normal; orphans: 2; -webkit-text-stroke-width: 0px;" />
<span style="text-align: left; color: inherit; text-transform: none; line-height: 1.3; text-indent: 0px; letter-spacing: normal; font-size: 0.87rem; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; word-spacing: 0px; display: inline !important; white-space: normal; orphans: 2; float: none; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">/</span><br />
CELL_PARAMETERS {alat}<br />
&nbsp; 1.000000000000000 &nbsp; 0.000000000000000 &nbsp; 0.000000000000000<br />
&nbsp;-0.500000000000000 &nbsp; 0.866025403784439 &nbsp; 0.000000000000000<br />
&nbsp; 0.000000000000000 &nbsp; 0.000000000000000 &nbsp; 1.982400170554264<br />
ATOMIC_SPECIES<br />
&nbsp; Zn &nbsp; 65.38000 &nbsp;Zn.pbe-dnl-kjpaw_psl.1.0.0.UPF<br />
ATOMIC_POSITIONS {crystal}<br />
&nbsp; Zn &nbsp; 0.333333333333333 &nbsp; 0.666666666666667 &nbsp; 0.250000000000000<br />
&nbsp; Zn &nbsp; 0.666666666666667 &nbsp; 0.333333333333333 &nbsp; 0.750000000000000<br />
K_POINTS automatic<br />
&nbsp; 6 6 2 &nbsp;1 1 1<br />
----------<br />
2. export OMP_NUM_THREADS=1<br />
&nbsp;&nbsp;mpirun -np 4 &nbsp;$HOME/q-e-qe-6.4.1/bin/pw.x &lt; zn.in | tee zn.out<br />
3. grep &quot; &nbsp;total energy&quot; zn.out | tail -n 1<br />
&nbsp; (total energy &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= &nbsp; &nbsp;-487.43374505 Ry)<br />
&nbsp; (PWSCF &nbsp; &nbsp; &nbsp; &nbsp;: &nbsp; 4m40.61s CPU &nbsp; 5m 3.42s WALL)<br />
<br />
□ step 2 (O2, slab model)<br />
0. wget https://www.quantum-espresso.org/upf_files/O.pbe-n-kjpaw_psl.1.0.0.UPF<br />
1.&nbsp;gedit o2.in<br />
----------<br />
&amp;CONTROL<br />
&nbsp; calculation &nbsp;= 'relax' ,<br />
&nbsp; prefix &nbsp;= 'o2' ,<br />
&nbsp; outdir &nbsp;= './work/' ,<br />
&nbsp; pseudo_dir = './' ,<br />
/<br />
&amp;SYSTEM<br />
&nbsp; ibrav = 0<br />
&nbsp; A = &nbsp; &nbsp;20.0<br />
&nbsp; nat = 2<br />
&nbsp; ntyp = 1<br />
&nbsp; ecutwfc &nbsp;= 40 ,<br />
&nbsp; ecutrho &nbsp;= 160 ,<br />
&nbsp; occupations = 'smearing' ,<br />
&nbsp; degauss &nbsp;= 0.02 ,<br />
&nbsp; smearing = 'mp',<br />
&nbsp; nspin = 2 ,<br />
&nbsp; starting_magnetization(1) = 1 ,<br />
&nbsp; tot_magnetization = -1 ,<br />
&nbsp; exxdiv_treatment = 'gygi-baldereschi' ,<br />
&nbsp; x_gamma_extrapolation = .true. ,<br />
/<br />
&amp;ELECTRONS<br />
&nbsp; conv_thr = 1.0e-04 ,<br />
&nbsp; mixing_beta = 0.7 ,<br />
/<br />
&amp;IONS<br />
/<br />
CELL_PARAMETERS {alat}<br />
&nbsp; 1.000000000000000 &nbsp; 0.000000000000000 &nbsp; 0.000000000000000<br />
&nbsp; 0.000000000000000 &nbsp; 1.000000000000000 &nbsp; 0.000000000000000<br />
&nbsp; 0.000000000000000 &nbsp; 0.000000000000000 &nbsp; 1.000000000000000<br />
ATOMIC_SPECIES<br />
&nbsp; &nbsp;O &nbsp; 15.99900 &nbsp; O.pbe-n-kjpaw_psl.1.0.0.UPF<br />
ATOMIC_POSITIONS {crystal}<br />
&nbsp; &nbsp;O &nbsp; 0.000000000000000 &nbsp; 0.000000000000000 &nbsp; 0.057000000000000<br />
&nbsp; &nbsp;O &nbsp; 0.000000000000000 &nbsp; 0.000000000000000 &nbsp;-0.057000000000000<br />
K_POINTS gamma<br />
----------<br />
2. export OMP_NUM_THREADS=1<br />
&nbsp;&nbsp;mpirun -np 4 &nbsp;$HOME/q-e-qe-6.4.1/bin/pw.x &lt; o2.in | tee o2.out<br />
3. grep &quot; &nbsp;total energy&quot; o2.out | tail -n 1<br />
&nbsp; (total energy &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= &nbsp; &nbsp; -82.63929933 Ry)<br />
&nbsp; (PWSCF &nbsp; &nbsp; &nbsp; &nbsp;: &nbsp;12m15.98s CPU &nbsp;13m43.13s WALL)<br />
<br />
□ step 3 (ZnO, P6<sub>3</sub>mc (186))<br />
0. wget https://www.quantum-espresso.org/upf_files/Zn.pbe-dnl-kjpaw_psl.1.0.0.UPF<br />
&nbsp;&nbsp;wget https://www.quantum-espresso.org/upf_files/O.pbe-n-kjpaw_psl.1.0.0.UPF<br />
1. gedit zno.in<br />
----------<br />
&amp;CONTROL<br />
&nbsp; calculation &nbsp;= 'vc-relax' ,<br />
&nbsp; prefix &nbsp;= 'zno' ,<br />
&nbsp; outdir &nbsp;= './work/' ,<br />
&nbsp; pseudo_dir = './' ,<br />
/<br />
&amp;SYSTEM<br />
&nbsp; ibrav = 0<br />
&nbsp; A = &nbsp; &nbsp;3.28910<br />
&nbsp; nat = 4<br />
&nbsp; ntyp = 2<br />
&nbsp; ecutwfc &nbsp;= 40 ,<br />
&nbsp; ecutrho &nbsp;= 160 ,<br />
&nbsp; occupations = 'smearing' ,<br />
&nbsp; degauss &nbsp;= 0.02 ,<br />
&nbsp; smearing = 'mp',<br />
&nbsp; nspin = 2 ,<br />
&nbsp; starting_magnetization(1) = 1 ,<br />
&nbsp; starting_magnetization(2) = 1 ,<br />
&nbsp; tot_magnetization = -1 ,<br />
&nbsp; exxdiv_treatment = 'gygi-baldereschi' ,<br />
&nbsp; x_gamma_extrapolation = .true. ,<br />
/<br />
&amp;ELECTRONS<br />
&nbsp; conv_thr = 1.0e-04 ,<br />
&nbsp; mixing_beta = 0.7 ,<br />
/<br />
&amp;IONS<br />
/<br />
&amp;CELL<br />
/<br />
CELL_PARAMETERS {alat}<br />
&nbsp; 1.000000000000000 &nbsp; 0.000000000000000 &nbsp; 0.000000000000000<br />
&nbsp;-0.500000000000000 &nbsp; 0.866025403784439 &nbsp; 0.000000000000000<br />
&nbsp; 0.000000000000000 &nbsp; 0.000000000000000 &nbsp; 1.613456568666201<br />
ATOMIC_SPECIES<br />
&nbsp; Zn &nbsp; 65.38000 &nbsp;Zn.pbe-dnl-kjpaw_psl.1.0.0.UPF<br />
&nbsp; &nbsp;O &nbsp; 15.99900 &nbsp; O.pbe-n-kjpaw_psl.1.0.0.UPF<br />
ATOMIC_POSITIONS {crystal}<br />
&nbsp; Zn &nbsp; 0.666666666666667 &nbsp; 0.333333333333333 &nbsp; 0.500548000000000<br />
&nbsp; Zn &nbsp; 0.333333333333333 &nbsp; 0.666666666666667 &nbsp; 0.000548000000000<br />
&nbsp; &nbsp;O &nbsp; 0.666666666666667 &nbsp; 0.333333333333333 &nbsp; 0.879762000000000<br />
&nbsp; &nbsp;O &nbsp; 0.333333333333333 &nbsp; 0.666666666666667 &nbsp; 0.379762000000000<br />
K_POINTS automatic<br />
&nbsp; 4 4 2 &nbsp;1 1 1<br />
----------<br />
2. export OMP_NUM_THREADS=1<br />
&nbsp;&nbsp;mpirun -np 4 &nbsp;$HOME/q-e-qe-6.4.1/bin/pw.x &lt; zno.in | tee zno.out<br />
3. grep &quot; &nbsp;total energy&quot; zno.out | tail -n 1<br />
&nbsp; (total energy &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= &nbsp; &nbsp;-570.89287364 Ry)<br />
&nbsp; (PWSCF &nbsp; &nbsp; &nbsp; &nbsp;: &nbsp; 3m58.30s CPU &nbsp; 4m23.48s WALL)<br />
4. grep &quot;Fermi&quot; zno.out | tail -n 1<br />
&nbsp; (the Fermi energy is &nbsp; &nbsp; 6.9794 ev)<br />
<br />
□ step 4<br />
1. formation enegy = E<sub>tot</sub>(ZnO) -&nbsp;E<sub>tot</sub>(Zn) -&nbsp;E<sub>tot</sub>(O<sub>2</sub>)<br />
&nbsp; =&nbsp;-570.89287364 - (-487.43374505) - (-82.63929933)<br />
&nbsp; = -0.81982926 Ry =&nbsp;-0.81982926 * 13.6058 eV = -11.154 eV<br />
&nbsp; =&nbsp;-11.154/4 eV/atom = -2.7885 eV/atom<br />
&nbsp; ([ATOMIC_POSITIONS]に記載している各原子の個数が揃うようにする。今回はたまたま同じ数になる）<br />
※ 全て上記の入力で[calculation &nbsp;= 'scf']にしてもほぼ同じ値になる。計算が重い場合は上記の入力ファイルを[calculation &nbsp;= 'scf']と書きかえて同じように計算すればよい（この方法は論文などで構造が明らかになっているか、または、実験的（例えばリートベルト法）に構造が明らかになっているときに推奨される）。<br />
※ Ref.: F. Oba et al., Phys. Rev. B 77 (2008) 245202.<br />
&nbsp; (&Delta;H<sub>f</sub> denotes the heat of formation of ZnO)

<table border="1" cellpadding="1" cellspacing="1" style="width: 417px;">
	<tbody>
		<tr>
			<td style="width: 88px;">&nbsp;</td>
			<td style="width: 55px; text-align: center;">a<br />
			(Å)</td>
			<td style="width: 55px; text-align: center;">c<br />
			(Å)</td>
			<td style="width: 62px; text-align: center;">&Delta;H<sub>f</sub><br />
			(eV)<sup>a</sup></td>
			<td style="width: 60px; text-align: center;">E<sub>3d</sub><br />
			(eV)</td>
			<td style="width: 66px; text-align: center;">E<sub>g</sub><br />
			(eV)</td>
		</tr>
		<tr>
			<td style="width: 88px; text-align: center;">GGA-PBE</td>
			<td style="width: 55px; text-align: center;">3.286</td>
			<td style="width: 55px; text-align: center;">5.299</td>
			<td style="width: 62px; text-align: center;">-2.82</td>
			<td style="width: 60px; text-align: center;">-4.8</td>
			<td style="width: 66px; text-align: center;">0.74</td>
		</tr>
		<tr>
			<td style="width: 88px; text-align: center;">PBE0</td>
			<td style="width: 55px; text-align: center;">3.257</td>
			<td style="width: 55px; text-align: center;">5.223</td>
			<td style="width: 62px; text-align: center;">-3.03</td>
			<td style="width: 60px; text-align: center;">-5.9</td>
			<td style="width: 66px; text-align: center;">3.18</td>
		</tr>
		<tr>
			<td style="width: 88px; text-align: center;">HSE</td>
			<td style="width: 55px; text-align: center;">3.261</td>
			<td style="width: 55px; text-align: center;">5.225</td>
			<td style="width: 62px; text-align: center;">-3.01</td>
			<td style="width: 60px; text-align: center;">-5.8</td>
			<td style="width: 66px; text-align: center;">2.49</td>
		</tr>
		<tr>
			<td style="width: 88px; text-align: center;">HSE (a=0.75)</td>
			<td style="width: 55px; text-align: center;">3.249</td>
			<td style="width: 55px; text-align: center;">5.196</td>
			<td style="width: 62px; text-align: center;">-3.13</td>
			<td style="width: 60px; text-align: center;">-6.4</td>
			<td style="width: 66px; text-align: center;">3.43</td>
		</tr>
		<tr>
			<td style="width: 88px; text-align: center;">Experiment<sup>b</sup></td>
			<td style="width: 55px; text-align: center;">3.242</td>
			<td style="width: 55px; text-align: center;">5.188</td>
			<td style="width: 62px; text-align: center;">-3.63</td>
			<td style="width: 60px; text-align: center;">-7.5</td>
			<td style="width: 66px; text-align: center;">3.44</td>
		</tr>
	</tbody>
</table>
<sup>a</sup>Errors in the binding energy of the O<sub>2</sub> molecule associated with the large PAW radial cutoff were corrected using the binding energy calculated with a smaller radial cutoff of 0.6 &Aring;.<br />
<sup>b</sup>References 23 and 39&ndash;41.<br />
&nbsp; <sup>23 </sup>D. C. Reynolds, D. C. Look, B. Jogai, C. W. Litton, G. Cantwell, and W. C. Harsch, Phys. Rev. B 60, 2340 (1999).&nbsp;<br />
&nbsp; <sup>39 </sup>J. Albertsson, S. C. Abrahams, and A. Kvick, Acta Crystallogr., Sect. B: Struct. Sci. 45, 34 (1989).<br />
&nbsp; <sup>40 </sup>J. D. Cox, D. D. Wagman, and V. A. Medvedev, CODATA Key Values for Thermodynamics (Hemisphere, New York, 1989).&nbsp;<br />
&nbsp; <sup>41 </sup>W. G&ouml;pel, J. Pollmann, I. Ivanov, and B. Reihl, Phys. Rev. B 26, 3144 (1982).<br />
※ Material project: ZnO (mp-2133): Formation energy -1.801 eV<br />
<br />
※ point<br />
&nbsp; 以下の条件は可能な限り同じにする。同じポテンシャルファイルを用いる。k点のメッシュ数は逆格子のメッシュ間隔が可能な限り同じになるようにする。<br />
----------<br />
&nbsp; ecutwfc &nbsp;= 40 ,<br />
&nbsp; ecutrho &nbsp;= 160 ,<br />
&nbsp; occupations = 'smearing' ,<br />
&nbsp; degauss &nbsp;= 0.02 ,<br />
&nbsp; smearing = 'mp',<br />
&nbsp; nspin = 2 ,<br />
----------<br />
&nbsp; conv_thr = 1.0e-04 ,　&larr;（原子当たりで同じになると良いと思う）<br />
----------<br />
<br />
◇ pc spec<br />
1.&nbsp;lscpu<br />
----------<br />
Model name: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Intel(R) Core(TM) i5-8500 CPU @ 3.00GHz<br />
----------<br />
2.&nbsp;cat /proc/cpuinfo | grep processor | tail -1; cat /proc/cpuinfo | grep &quot;model name&quot; | tail -1; cat /proc/meminfo | head -1<br />
----------<br />
processor &nbsp; &nbsp; &nbsp; : 5<br />
model name &nbsp; &nbsp; &nbsp;: Intel(R) Core(TM) i5-8500 CPU @ 3.00GHz<br />
MemTotal: &nbsp; &nbsp; &nbsp; 16551208 kB<br />
----------<br />
※ Ref. ([cpuinfo][meminfo] 使用しているcpu, メモリ, OSを調べる: https://sites.google.com/site/afcinbash/home/admin/cpuinfo)<br />
-----------------------------------------------------------------------------<br />
■ ZnO (O vacancy) (PWscf) (underconstracting)<br />
※ a, b, c軸方向のそれぞれの格子定数の長さが10Å程度になるスーパーセルから計算する必要があります。可能であれば格子定数を徐々に大きくしてエネルギーの変化の傾向を見ることが望ましい。<br />
※&nbsp;計算コストが大きいのでまずは欠陥まわりの原子だけ動かすようにしてnon-spinのfixedで計算してみる。論文と近い結果にするためには全ての原子を動くようにさせないといけない。<br />
<br />
□ step 1 (ZnO, P6<sub>3</sub>mc (186), 3x3x2)<br />
0. wget https://www.quantum-espresso.org/upf_files/Zn.pbe-dnl-kjpaw_psl.1.0.0.UPF<br />
&nbsp;&nbsp;wget https://www.quantum-espresso.org/upf_files/O.pbe-n-kjpaw_psl.1.0.0.UPF<br />
1. gedit zno_3x3x2.in<br />
----------<br />
&amp;CONTROL<br />
&nbsp; calculation &nbsp;= 'scf' ,<br />
&nbsp; prefix &nbsp;= 'zno_3x3x2' ,<br />
&nbsp; outdir &nbsp;= './work/' ,<br />
&nbsp; pseudo_dir = './' ,<br />
/<br />
&amp;SYSTEM<br />
&nbsp; ibrav = 0<br />
&nbsp; A = &nbsp; &nbsp;3.107749<br />
&nbsp; nat = 72<br />
&nbsp; ntyp = 2<br />
&nbsp; ecutwfc &nbsp;= 40 ,<br />
&nbsp; ecutrho &nbsp;= 160 ,<br />
&nbsp; occupations = 'fixed' ,<br />
&nbsp; tot_charge = 0.0,<br />
&nbsp; nosym = .true. ,<br />
/<br />
&amp;ELECTRONS<br />
&nbsp; conv_thr = 5.3e-03 ,<br />
&nbsp; mixing_beta = 0.7 ,<br />
/<br />
&amp;IONS<br />
/<br />
CELL_PARAMETERS {alat}<br />
&nbsp; 2.971845000000000 &nbsp; 0.000000000000000 &nbsp; 0.000000000000000<br />
&nbsp;-1.485920000000000 &nbsp; 2.573669000000000 &nbsp; 0.000000000000000<br />
&nbsp; 0.000000000000000 &nbsp; 0.000000000000000 &nbsp; 3.203204000000000<br />
ATOMIC_SPECIES<br />
&nbsp; Zn &nbsp; 65.38000 &nbsp;Zn.pbe-dnl-kjpaw_psl.1.0.0.UPF<br />
&nbsp; &nbsp;O &nbsp; 15.99900 &nbsp; O.pbe-n-kjpaw_psl.1.0.0.UPF<br />
ATOMIC_POSITIONS {crystal}<br />
&nbsp; Zn&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.250274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.750274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.555555555555556&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.250274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.555555555555556&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.750274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.250274000000000 1 1 1<br />
&nbsp; Zn&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.750274000000000 1 1 1<br />
&nbsp; Zn&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.250274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.750274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.555555555555556&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.250274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.555555555555555&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.750274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.250274000000000 1 1 1<br />
&nbsp; Zn&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.750274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.750274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.250274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.555555555555555&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.250274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.250274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.555555555555556&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.750274000000000 1 1 1<br />
&nbsp; Zn&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.750274000000000 1 1 1<br />
&nbsp; Zn&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.000274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.555555555555555&nbsp;&nbsp; 0.500274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.000274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.555555555555555&nbsp;&nbsp; 0.500274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.000274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.555555555555555&nbsp;&nbsp; 0.500274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.555555555555555&nbsp;&nbsp; 0.000274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.500274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.555555555555555&nbsp;&nbsp; 0.000274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.500274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.555555555555555&nbsp;&nbsp; 0.000274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.500274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.500274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.000274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.000274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.000274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.500274000000000 0 0 0<br />
&nbsp; Zn&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.500274000000000 1 1 1<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.439881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.939881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.555555555555556&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.439881000000000 1 1 1<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.555555555555556&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.939881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.439881000000000 1 1 1<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.939881000000000 1 1 1<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.439881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.939881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.555555555555556&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.439881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.555555555555555&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.939881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.439881000000000 1 1 1<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.939881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.939881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.439881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.555555555555555&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.439881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.439881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.555555555555556&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.939881000000000 1 1 1<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.939881000000000 1 1 1<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.189881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.555555555555555&nbsp;&nbsp; 0.689881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.189881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.555555555555555&nbsp;&nbsp; 0.689881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.189881000000000 1 1 1<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.555555555555555&nbsp;&nbsp; 0.689881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.555555555555555&nbsp;&nbsp; 0.189881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.689881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.555555555555555&nbsp;&nbsp; 0.189881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.689881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.555555555555555&nbsp;&nbsp; 0.189881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.689881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.689881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.111111111111111&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.189881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.189881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.888888888888889&nbsp;&nbsp; 0.189881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.444444444444444&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.689881000000000 0 0 0<br />
&nbsp;&nbsp; O&nbsp;&nbsp; 0.777777777777778&nbsp;&nbsp; 0.222222222222222&nbsp;&nbsp; 0.689881000000000 0 0 0<br />
K_POINTS automatic<br />
&nbsp; 2 2 1 &nbsp;1 1 0<br />
----------<br />
2. export OMP_NUM_THREADS=1<br />
&nbsp;&nbsp;mpirun -np 4 &nbsp;$HOME/q-e-qe-6.4.1/bin/pw.x &lt; zno_3x3x2.in | tee zno_3x3x2.out<br />
3. grep &quot; &nbsp;total energy&quot; zno_3x3x2.out | tail -n 1<br />
&nbsp; (!&nbsp;&nbsp;&nbsp; total energy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp; -10274.95430608 Ry)<br />
4.&nbsp;grep &quot;highest occupied level&quot; zno_3x3x2_scf.out | tail -n 1<br />
&nbsp; (&nbsp;&nbsp;&nbsp;&nbsp; highest occupied level (ev):&nbsp;&nbsp;&nbsp;&nbsp; 9.7716)<br />
※ xcrysden で入力ファイルを読み込ませた後、 [Atoms Info]をクリックする、[Crystal-Conventional]をクリックする。欠陥の周囲の動かしたい原子をクリックして表示される ID と ATOMIC_POSITIONS（入力ファイルのATOMIC_POSITIONSの次の行から1, 2, 3と行を数えるとIDと対応する）を比較して入力ファイルの原子の後に1 1 1を追加する。動かさない部分は 0 0 0と記載する。これはscfの計算で記載していても問題はない。<br />
<br />
□ step 2 (O vacancy in ZnO, P6<sub>3</sub>mc (186), Neutral, 3x3x2)<br />
1. cp&nbsp;zno_3x3x2.in&nbsp;zno_vo0_3x3x2.in<br />
2. gedit zno_vo0_3x3x2.in<br />
----------(before)<br />
&nbsp; calculation &nbsp;= 'scf' ,<br />
&nbsp; prefix &nbsp;= 'zno_3x3x2' ,<br />
<br />
&nbsp; nat = 72<br />
<br />
&nbsp; &nbsp;O &nbsp; 0.777777777777778 &nbsp; 0.222222222222222 &nbsp; 0.689881000000000 0<br />
----------<br />
----------(after)<br />
&nbsp; calculation &nbsp;= 'relax' ,<br />
&nbsp; nstep = 900 ,<br />
&nbsp; prefix &nbsp;= 'zno_vo0_3x3x2' ,<br />
<br />
&nbsp; nat = 71<br />
----------<br />
3. export OMP_NUM_THREADS=1<br />
&nbsp;&nbsp;mpirun -np 4 &nbsp;$HOME/q-e-qe-6.4.1/bin/pw.x &lt; zno_vo0_3x3x2.in | tee zno_vo0_3x3x2.out<br />
4. grep &quot; &nbsp;total energy&quot; zno_vo0_3x3x2.out | tail -n 1<br />
&nbsp; (!&nbsp;&nbsp;&nbsp; total energy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp; -10233.33831490 Ry)<br />
5.&nbsp;grep &quot;highest occupied level&quot; zno_vo0_3x3x2.out | tail -n 1<br />
&nbsp; (&nbsp;&nbsp;&nbsp;&nbsp; highest occupied level (ev):&nbsp;&nbsp;&nbsp;&nbsp; 9.5913)<br />
6.&nbsp;formation enegy (defect) = E<sub>tot</sub>(ZnO_V<sub>O</sub>(0)) - E<sub>tot</sub>(ZnO) +&nbsp; E<sub>tot</sub>(O<sub>2</sub>)/2<br />
&nbsp; =&nbsp;-10233.33831490 - (-10274.95430608) + (-82.63929933)/2<br />
&nbsp; =&nbsp; <span class="qv3Wpe" id="cwos">0.29634 </span>[Ry] = <span class="qv3Wpe" id="cwos">0.29634 </span>* 13.6058 eV =&nbsp;<span class="qv3Wpe" id="cwos">4.032</span> [eV]<br />
&nbsp; 還元側極限（O-poor）: V<sub>O</sub><sup>0</sup> =&nbsp;<span class="qv3Wpe" id="cwos">4.032</span> + -2.7885 =&nbsp;<span class="qv3Wpe" id="cwos">1.2435</span> [eV]<br />
&nbsp; 酸化側極限（O-rich）: V<sub>O</sub><sup>0</sup> =&nbsp;<span class="qv3Wpe" id="cwos">4.032</span> + 0 = <span class="qv3Wpe" id="cwos">4.032 </span>[eV]<br />
※ 最小単位の構造での構造最適化の値を入力ファイルに利用する。この例では、格子定数のAとCELL_PARAMETERSのみを書きかえた。<br />
※ &Delta;&mu;(Zn) + &Delta;&mu;(O) = &Delta;G<sub>f</sub>(ZnO)<br />
&nbsp;&nbsp;&Delta;&mu;(O)の下限（&Delta;&mu;(Zn)=0,&nbsp;&Delta;&mu;(O) = &Delta;G<sub>f</sub>(ZnO))はZnOとZn金属が平衡した還元側極限に対応する。一方、上限（&Delta;&mu;(Zn)=&Delta;G<sub>f</sub>(ZnO）&Delta;&mu;(O)=0）は酸化側極限に対応する。<br />
※ F. Fabbri et al., Scientific Reports 4 (2015) 5158. (O-poor: ?0.83 eV, O-rich: ?3.5 eV)<br />
&nbsp; Quantum Espresso suite (=PWscf), DFT+U calculation.<br />
&nbsp;&nbsp;https://www.nature.com/articles/srep05158<br />
<br />
□ step 3 (O vacancy 2+ in ZnO, P6<sub>3</sub>mc (186), 3x3x2)<br />
1. cp&nbsp;zno_vo0_3x3x2.in zno_vo2_3x3x2.in<br />
2. gedit zno_vo2_3x3x2.in<br />
----------(before)<br />
&nbsp; prefix &nbsp;= 'zno_vo0_3x3x2' ,<br />
<br />
&nbsp; tot_charge = 0.0,<br />
----------<br />
----------(after)<br />
&nbsp; prefix &nbsp;= 'zno_vo2_3x3x2' ,<br />
<br />
&nbsp; tot_charge = 2.0,<br />
----------<br />
3. export OMP_NUM_THREADS=1<br />
&nbsp;&nbsp;mpirun -np 4 &nbsp;$HOME/q-e-qe-6.4.1/bin/pw.x &lt; zno_vo2_3x3x2.in | tee zno_vo2_3x3x2.out<br />
4. grep &quot; &nbsp;total energy&quot; zno_vo2_3x3x2.out | tail -n 1<br />
&nbsp; (&nbsp;&nbsp;&nbsp;&nbsp; total energy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp; -10234.68974464 Ry)<br />
5.&nbsp;grep &quot;highest occupied level&quot; zno_vo2_3x3x2.out | tail -n 1<br />
&nbsp; (&nbsp;&nbsp;&nbsp;&nbsp; highest occupied level (ev):&nbsp;&nbsp;&nbsp;&nbsp; 9.6066)<br />
6.&nbsp;formation enegy (defect) = E<sub>tot</sub>(ZnO_V<sub>O</sub>(2+)) - E<sub>tot</sub>(ZnO) +&nbsp; E<sub>tot</sub>(O<sub>2</sub>)/2 + q*(E<sub>VBM</sub> + E<sub>F</sub>)<br />
&nbsp; =&nbsp;-10234.68974464 - (-10274.95430608) + (-82.63929933)/2 + q*(E<sub>VBM</sub> + E<sub>F</sub>)<br />
&nbsp; =&nbsp;<span class="qv3Wpe" id="cwos">-1.055088</span> [Ry]&nbsp; + 2*(E<sub>VBM</sub> + E<sub>F</sub>) = <span class="qv3Wpe" id="cwos">-1.055088 </span>* 13.6058 [eV] + 2*(E<sub>VBM</sub> + E<sub>F</sub>)<sub> </sub>=&nbsp; <span class="qv3Wpe" id="cwos">-14.3553 </span>[eV] + q*(E<sub>VBM</sub> + E<sub>F</sub>)<br />
&nbsp; 還元側極限（O-poor）: V<sub>O</sub><sup>2+</sup> =&nbsp;<span class="qv3Wpe" id="cwos">-14.3553</span> + -2.7885 + q*(E<sub>VBM</sub> + E<sub>F</sub>) =&nbsp;<span class="qv3Wpe" id="cwos">-17.1438</span> + 2*(E<sub>VBM</sub> + E<sub>F</sub>) [eV]<br />
&nbsp; 酸化側極限（O-rich）: V<sub>O</sub><sup>2+</sup> = <span class="qv3Wpe" id="cwos">-14.3553 </span>+ 0 + q*(E<sub>VBM</sub> + E<sub>F</sub>) =&nbsp;<span class="qv3Wpe" id="cwos">-14.3553</span> + 2*(E<sub>VBM</sub> + E<sub>F</sub>) [eV]<br />
7. E<sub>F </sub><span class="qv3Wpe">at (0/+2) level</span><br />
<span class="qv3Wpe">&nbsp; 1.2435 = -17.1438</span> + 2*(E<sub>VBM</sub> + E<sub>F</sub>)<br />
<span class="qv3Wpe" id="cwos">&nbsp; </span>E<sub>F</sub> = (1.2435 + <span class="qv3Wpe" id="cwos">17.1438)/2 - </span>E<sub>VBM</sub><br />
※ P. Agoston et al., Phys. Rev. Lett. 103 (2009) 245501. のVASPでの計算条件に対してPWscfで近い条件にしている。<br />
※ S. B. Zhang et al., Phys. Rev. B 63 (2001) 075205.<br />
※&nbsp;Formation energies of charged defects - manual workflow (https://docs.quantumwise.com/tutorials/charged_defects/charged_defects.html)<br />
※ E<sub>VBM </sub>is the valence-band maximu (VBM) of the ideal (host) crystal.<br />
<br />
----------<br />
tot_charge (Default: 0.0)<br />
<font face="arial,helvetica,sans-serif">&nbsp; <span style="font-size:14px; text-align:left; text-indent:0px; -webkit-text-stroke-width:0px"><span style="color:#000000"><span style="text-transform:none"><span style="letter-spacing:normal"><span style="font-style:normal"><span style="font-variant:normal"><span style="font-weight:400"><span style="text-decoration:none"><span style="word-spacing:0px"><span style="display:inline !important"><span style="white-space:pre"><span style="orphans:2"><span style="float:none"><span style="background-color:#ffffff">tot_charge=+1 means one electron missing from the system</span></span></span></span></span></span></span></span></span></span></span></span></span></span></font><br />
&nbsp;&nbsp;<span style="font-size:14px; text-align:left; text-indent:0px; -webkit-text-stroke-width:0px"><span style="display:inline !important"><span style="float:none"><span style="background-color:#ffffff"><span style="color:#000000"><span style="font-family:arial,helvetica,sans-serif"><span style="font-style:normal"><span style="font-variant:normal"><span style="font-weight:400"><span style="letter-spacing:normal"><span style="orphans:2"><span style="text-decoration:none"><span style="text-transform:none"><span style="white-space:pre"><span style="word-spacing:0px">tot_charge=-1 means one additional electron</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><br />
----------<br />
<br />
※ point<br />
&nbsp; 3x3x3以上のスーパーセルとFNVセルサイズ補正法（Freysoldt et al., PRL 2009）などの補正を入れて計算するのが望ましい。補正法のコードとしては下記がある。可能であればHSEでも計算してみる。<br />
&nbsp; GaAsの方は左欄の[sxdefectalign]で試しに計算してみた結果を示している。文献と大きく違わない結果になっている。ZnOの方はV<sub>o</sub><sup>0</sup>は文献値と近い結果になっているがV<sub>o</sub><sup>2+</sup>は上手くいっていない（可能な限り論文の条件に近づけて比較したいがメモリーもCPUも足らない）。<br />
・sxdefectalign (manual: https://sxrepo.mpie.de/projects/sphinx-add-ons/files) (HP:&nbsp;https://sxrepo.mpie.de/)<br />
&nbsp; Quantum Espresso (= PWscf), VASP<br />
・CoFFEE (arXiv:&nbsp;https://arxiv.org/pdf/1705.01491.pdf) (code CoFFEE_1.1.tar.gz :&nbsp;https://data.mendeley.com/datasets/s2x4d542dc/1)<br />
&nbsp;&nbsp;Quantum Espresso (= PWscf)<br />
・PyCDT (arXiv: https://arxiv.org/abs/1611.07481) (code: https://bitbucket.org/mbkumar/pycdt/src/master/)<br />
&nbsp; VASP<br />
※ nscfだと神崎先生のpythonコードを使う必要なく前回の構造（nscfで書き入れている入力ファイルに関係無く）を読み取ってくれる（？）のだろうが、私が試した方法ではnscfでは全エネルギーが表示されていなかった。そのため、CoFFEEの入力ファイルにもあるようにscfで計算することにした。<br />
<br />
[D1]&nbsp; 半導体点欠陥の第一原理計算<br />
&nbsp;&nbsp;https://www.jstage.jst.go.jp/article/materia/55/5/55_55.221/_pdf<br />
-----------------------------------------------------------------------------<br />
■ ZnO (O vacancy) (PWscf) (underconstracting)<br />
※ 以下の入力において全て nosym = .true., とするところを nosym = ture, と誤って記載していた。原子も上に記載の欠陥の周りだけ動くようにしていたのでVo<sup>2+</sup>の再現が悪い結果となっている。注意してほしい。<br />
<br />
□ step 1 (ZnO, P6<sub>3</sub>mc (186), 3x3x2)<br />
0. wget https://www.quantum-espresso.org/upf_files/Zn.pbe-dnl-kjpaw_psl.1.0.0.UPF<br />
&nbsp;&nbsp;wget https://www.quantum-espresso.org/upf_files/O.pbe-n-kjpaw_psl.1.0.0.UPF<br />
1. gedit zno_3x3x2.in<br />
----------<br />
&amp;CONTROL<br />
&nbsp; calculation &nbsp;= 'scf' ,<br />
&nbsp; prefix &nbsp;= 'zno_3x3x2' ,<br />
&nbsp; outdir &nbsp;= './work/' ,<br />
&nbsp; pseudo_dir = './' ,<br />
/<br />
&amp;SYSTEM<br />
&nbsp; ibrav = 0<br />
&nbsp; A = &nbsp; &nbsp;3.107749<br />
&nbsp; nat = 72<br />
&nbsp; ntyp = 2<br />
&nbsp; ecutwfc &nbsp;= 40 ,<br />
&nbsp; ecutrho &nbsp;= 160 ,<br />
&nbsp; occupations = 'smearing' ,<br />
&nbsp; degauss &nbsp;= 0.02 ,<br />
&nbsp; smearing = 'mp',<br />
&nbsp; exxdiv_treatment = 'gygi-baldereschi' ,<br />
&nbsp; x_gamma_extrapolation = .true. ,<br />
&nbsp; nosym = .true. ,<br />
&nbsp; tot_charge = 0.0 ,<br />
/<br />
&amp;ELECTRONS<br />
&nbsp; conv_thr = 5.3e-03 ,<br />
&nbsp; mixing_beta = 0.7 ,<br />
/<br />
&amp;IONS<br />
/<br />
CELL_PARAMETERS {alat}<br />
&nbsp; 2.971845000000000 &nbsp; 0.000000000000000 &nbsp; 0.000000000000000<br />
&nbsp;-1.485920000000000 &nbsp; 2.573669000000000 &nbsp; 0.000000000000000<br />
&nbsp; 0.000000000000000 &nbsp; 0.000000000000000 &nbsp; 3.203204000000000<br />
ATOMIC_SPECIES<br />
&nbsp; Zn &nbsp; 65.38000 &nbsp;Zn.pbe-dnl-kjpaw_psl.1.0.0.UPF<br />
&nbsp; &nbsp;O &nbsp; 15.99900 &nbsp; O.pbe-n-kjpaw_psl.1.0.0.UPF<br />
ATOMIC_POSITIONS {crystal}<br />
&nbsp; Zn &nbsp; 0.222222222222222 &nbsp; 0.111111111111111 &nbsp; 0.250274000000000<br />
&nbsp; Zn &nbsp; 0.222222222222222 &nbsp; 0.444444444444444 &nbsp; 0.750274000000000<br />
&nbsp; Zn &nbsp; 0.555555555555556 &nbsp; 0.111111111111111 &nbsp; 0.250274000000000<br />
&nbsp; Zn &nbsp; 0.555555555555556 &nbsp; 0.444444444444444 &nbsp; 0.750274000000000<br />
&nbsp; Zn &nbsp; 0.888888888888889 &nbsp; 0.111111111111111 &nbsp; 0.250274000000000<br />
&nbsp; Zn &nbsp; 0.888888888888889 &nbsp; 0.444444444444444 &nbsp; 0.750274000000000<br />
&nbsp; Zn &nbsp; 0.222222222222222 &nbsp; 0.444444444444444 &nbsp; 0.250274000000000<br />
&nbsp; Zn &nbsp; 0.222222222222222 &nbsp; 0.777777777777778 &nbsp; 0.750274000000000<br />
&nbsp; Zn &nbsp; 0.555555555555556 &nbsp; 0.444444444444444 &nbsp; 0.250274000000000<br />
&nbsp; Zn &nbsp; 0.555555555555555 &nbsp; 0.777777777777778 &nbsp; 0.750274000000000<br />
&nbsp; Zn &nbsp; 0.888888888888889 &nbsp; 0.444444444444444 &nbsp; 0.250274000000000<br />
&nbsp; Zn &nbsp; 0.888888888888889 &nbsp; 0.777777777777778 &nbsp; 0.750274000000000<br />
&nbsp; Zn &nbsp; 0.222222222222222 &nbsp; 0.111111111111111 &nbsp; 0.750274000000000<br />
&nbsp; Zn &nbsp; 0.222222222222222 &nbsp; 0.777777777777778 &nbsp; 0.250274000000000<br />
&nbsp; Zn &nbsp; 0.555555555555555 &nbsp; 0.777777777777778 &nbsp; 0.250274000000000<br />
&nbsp; Zn &nbsp; 0.888888888888889 &nbsp; 0.777777777777778 &nbsp; 0.250274000000000<br />
&nbsp; Zn &nbsp; 0.555555555555556 &nbsp; 0.111111111111111 &nbsp; 0.750274000000000<br />
&nbsp; Zn &nbsp; 0.888888888888889 &nbsp; 0.111111111111111 &nbsp; 0.750274000000000<br />
&nbsp; Zn &nbsp; 0.111111111111111 &nbsp; 0.222222222222222 &nbsp; 0.000274000000000<br />
&nbsp; Zn &nbsp; 0.111111111111111 &nbsp; 0.555555555555555 &nbsp; 0.500274000000000<br />
&nbsp; Zn &nbsp; 0.444444444444444 &nbsp; 0.222222222222222 &nbsp; 0.000274000000000<br />
&nbsp; Zn &nbsp; 0.444444444444444 &nbsp; 0.555555555555555 &nbsp; 0.500274000000000<br />
&nbsp; Zn &nbsp; 0.777777777777778 &nbsp; 0.222222222222222 &nbsp; 0.000274000000000<br />
&nbsp; Zn &nbsp; 0.777777777777778 &nbsp; 0.555555555555555 &nbsp; 0.500274000000000<br />
&nbsp; Zn &nbsp; 0.111111111111111 &nbsp; 0.555555555555555 &nbsp; 0.000274000000000<br />
&nbsp; Zn &nbsp; 0.111111111111111 &nbsp; 0.888888888888889 &nbsp; 0.500274000000000<br />
&nbsp; Zn &nbsp; 0.444444444444444 &nbsp; 0.555555555555555 &nbsp; 0.000274000000000<br />
&nbsp; Zn &nbsp; 0.444444444444444 &nbsp; 0.888888888888889 &nbsp; 0.500274000000000<br />
&nbsp; Zn &nbsp; 0.777777777777778 &nbsp; 0.555555555555555 &nbsp; 0.000274000000000<br />
&nbsp; Zn &nbsp; 0.777777777777778 &nbsp; 0.888888888888889 &nbsp; 0.500274000000000<br />
&nbsp; Zn &nbsp; 0.111111111111111 &nbsp; 0.222222222222222 &nbsp; 0.500274000000000<br />
&nbsp; Zn &nbsp; 0.111111111111111 &nbsp; 0.888888888888889 &nbsp; 0.000274000000000<br />
&nbsp; Zn &nbsp; 0.444444444444444 &nbsp; 0.888888888888889 &nbsp; 0.000274000000000<br />
&nbsp; Zn &nbsp; 0.777777777777778 &nbsp; 0.888888888888889 &nbsp; 0.000274000000000<br />
&nbsp; Zn &nbsp; 0.444444444444444 &nbsp; 0.222222222222222 &nbsp; 0.500274000000000<br />
&nbsp; Zn &nbsp; 0.777777777777778 &nbsp; 0.222222222222222 &nbsp; 0.500274000000000<br />
&nbsp; &nbsp;O &nbsp; 0.222222222222222 &nbsp; 0.111111111111111 &nbsp; 0.439881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.222222222222222 &nbsp; 0.444444444444444 &nbsp; 0.939881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.555555555555556 &nbsp; 0.111111111111111 &nbsp; 0.439881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.555555555555556 &nbsp; 0.444444444444444 &nbsp; 0.939881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.888888888888889 &nbsp; 0.111111111111111 &nbsp; 0.439881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.888888888888889 &nbsp; 0.444444444444444 &nbsp; 0.939881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.222222222222222 &nbsp; 0.444444444444444 &nbsp; 0.439881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.222222222222222 &nbsp; 0.777777777777778 &nbsp; 0.939881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.555555555555556 &nbsp; 0.444444444444444 &nbsp; 0.439881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.555555555555555 &nbsp; 0.777777777777778 &nbsp; 0.939881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.888888888888889 &nbsp; 0.444444444444444 &nbsp; 0.439881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.888888888888889 &nbsp; 0.777777777777778 &nbsp; 0.939881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.222222222222222 &nbsp; 0.111111111111111 &nbsp; 0.939881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.222222222222222 &nbsp; 0.777777777777778 &nbsp; 0.439881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.555555555555555 &nbsp; 0.777777777777778 &nbsp; 0.439881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.888888888888889 &nbsp; 0.777777777777778 &nbsp; 0.439881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.555555555555556 &nbsp; 0.111111111111111 &nbsp; 0.939881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.888888888888889 &nbsp; 0.111111111111111 &nbsp; 0.939881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.111111111111111 &nbsp; 0.222222222222222 &nbsp; 0.189881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.111111111111111 &nbsp; 0.555555555555555 &nbsp; 0.689881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.444444444444444 &nbsp; 0.222222222222222 &nbsp; 0.189881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.444444444444444 &nbsp; 0.555555555555555 &nbsp; 0.689881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.777777777777778 &nbsp; 0.222222222222222 &nbsp; 0.189881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.777777777777778 &nbsp; 0.555555555555555 &nbsp; 0.689881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.111111111111111 &nbsp; 0.555555555555555 &nbsp; 0.189881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.111111111111111 &nbsp; 0.888888888888889 &nbsp; 0.689881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.444444444444444 &nbsp; 0.555555555555555 &nbsp; 0.189881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.444444444444444 &nbsp; 0.888888888888889 &nbsp; 0.689881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.777777777777778 &nbsp; 0.555555555555555 &nbsp; 0.189881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.777777777777778 &nbsp; 0.888888888888889 &nbsp; 0.689881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.111111111111111 &nbsp; 0.222222222222222 &nbsp; 0.689881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.111111111111111 &nbsp; 0.888888888888889 &nbsp; 0.189881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.444444444444444 &nbsp; 0.888888888888889 &nbsp; 0.189881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.777777777777778 &nbsp; 0.888888888888889 &nbsp; 0.189881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.444444444444444 &nbsp; 0.222222222222222 &nbsp; 0.689881000000000<br />
&nbsp; &nbsp;O &nbsp; 0.777777777777778 &nbsp; 0.222222222222222 &nbsp; 0.689881000000000<br />
K_POINTS automatic<br />
&nbsp; 2 2 1 &nbsp;1 1 0<br />
----------<br />
2. export OMP_NUM_THREADS=1<br />
&nbsp;&nbsp;mpirun -np 4 &nbsp;$HOME/q-e-qe-6.4.1/bin/pw.x &lt; zno_3x3x2.in | tee zno_3x3x2.out<br />
3. cp zno_3x3x2.in zno_3x3x2_scf.in<br />
4. gedit&nbsp;zno_3x3x2_scf.in<br />
----------(before)<br />
K_POINTS automatic<br />
&nbsp; 2 2 1 1 1 0<br />
----------<br />
----------(after)<br />
&nbsp; input_dft='hse', nqx1=1,&nbsp;nqx2=1,&nbsp;nqx3=1,<br />
&nbsp;&nbsp;exx_fraction = 0.375,<br />
<br />
K_POINTS automatic<br />
&nbsp; 2 2 2 1 1 1<br />
----------<br />
5.&nbsp;mpirun -np 4 &nbsp;$HOME/q-e-qe-6.4.1/bin/pw.x &lt; zno_3x3x2_scf.in | tee zno_3x3x2_scf.out<br />
6. grep &quot; &nbsp;total energy&quot; zno_3x3x2_scf.out | tail -n 1<br />
&nbsp; (!&nbsp;&nbsp;&nbsp; total energy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp; -10274.95222400 Ry)<br />
7.&nbsp;grep &quot;Fermi&quot; zno_3x3x2_scf.out | tail -n 1<br />
&nbsp; (&nbsp;&nbsp;&nbsp;&nbsp; the Fermi energy is&nbsp;&nbsp;&nbsp;&nbsp; 9.8437 ev)<br />
※ HSE （&amp;SYSTEM に記載する）<br />
&nbsp;&nbsp;input_dft='hse', nqx1=1,&nbsp;nqx2=1,&nbsp;nqx3=1,<br />
&nbsp;&nbsp;exx_fraction = 0.375,<br />
&nbsp; exxdiv_treatment = 'gygi-baldereschi' ,<br />
&nbsp; x_gamma_extrapolation = .true. ,<br />
&nbsp; ZnOでは&alpha;=0.375とあるので、exx_fraction = 0.375, も記載することが必要になると考えられる。<br />
※ Gau-PBE（&amp;SYSTEM に記載する）<br />
&nbsp; input_dft='gaup', nqx1=1,&nbsp;nqx2=1,&nbsp;nqx3=1,<br />
&nbsp; exxdiv_treatment = 'none' ,<br />
&nbsp; x_gamma_extrapolation = .false. ,<br />
&nbsp; [FIG 2- uploaded by Giacomo Giorgi] を見ると HSEよりもGapを再現しているようである。しかし、ZnOやMgO, NaClにおいてはまだいくらか実験値との差がある。<br />
※ nqx1, nqx2, nqx3 は scfで正しく計算できたときのなかで一番小さいk点数と同じか、計算が重い場合はそれよりも少し小さいくらいにする。<br />
<br />
□ step 2 (O vacancy in ZnO, P6<sub>3</sub>mc (186), Neutral, 3x3x2)<br />
1. cp&nbsp;zno_3x3x2.in&nbsp;zno_vo0_3x3x2.in<br />
2. gedit zno_vo0_3x3x2.in<br />
----------(before)<br />
&nbsp; calculation = 'scf'<br />
&nbsp; prefix &nbsp;= 'zno_3x3x2' ,<br />
<br />
&nbsp; nat = 72<br />
<br />
&nbsp; &nbsp;O &nbsp; 0.777777777777778 &nbsp; 0.222222222222222 &nbsp; 0.689881000000000<br />
----------<br />
----------(after)<br />
&nbsp; calculation = 'relax'<br />
&nbsp; nstep = 900 ,<br />
&nbsp; prefix &nbsp;= 'zno_vo0_3x3x2' ,<br />
<br />
&nbsp; nat = 71<br />
----------<br />
3. export OMP_NUM_THREADS=1<br />
&nbsp;&nbsp;mpirun -np 4 &nbsp;$HOME/q-e-qe-6.4.1/bin/pw.x &lt; zno_vo0_3x3x2.in | tee zno_vo0_3x3x2.out<br />
4. ./pwoutr2in.py zno_vo0_3x3x2<br />
&nbsp; (sudo apt install python<br />
&nbsp;&nbsp; chmod +x pwoutr2in.py)<br />
&nbsp; (xcrysden --pwo&nbsp;zno_vo0_3x3x2.out)<br />
5. cp zno_vo0_3x3x2.new.in zno_vo0_3x3x2_scf.in<br />
6. gedit&nbsp;zno_vo0_3x3x2_scf.in<br />
----------(before)<br />
&nbsp; calculation = 'relax'<br />
&nbsp; nstep = 900 ,<br />
<br />
K_POINTS automatic<br />
&nbsp; 2 2 1 1 1 0<br />
----------<br />
----------(after)<br />
&nbsp; calculation = 'scf'<br />
<br />
&nbsp; input_dft='hse', nqx1=1,&nbsp;nqx2=1,&nbsp;nqx3=1,<br />
&nbsp;&nbsp;exx_fraction = 0.375,<br />
<br />
K_POINTS automatic<br />
&nbsp; 2 2 2 1 1 1<br />
----------<br />
7.&nbsp;mpirun -np 4 &nbsp;$HOME/q-e-qe-6.4.1/bin/pw.x &lt; zno_vo0_3x3x2_scf.in | tee zno_vo0_3x3x2_scf.out<br />
8. grep &quot; &nbsp;total energy&quot; zno_vo0_3x3x2_scf.out | tail -n 1<br />
&nbsp; (!&nbsp;&nbsp;&nbsp; total energy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp; -10233.33456127 Ry)<br />
9.&nbsp;grep &quot;Fermi&quot; zno_vo0_3x3x2_scf.out | tail -n 1<br />
&nbsp; (&nbsp;&nbsp;&nbsp;&nbsp; the Fermi energy is&nbsp;&nbsp;&nbsp; 11.4210 ev)<br />
10.&nbsp;formation enegy (defect) = E<sub>tot</sub>(ZnO_V<sub>O</sub>(0)) - E<sub>tot</sub>(ZnO) +&nbsp; E<sub>tot</sub>(O<sub>2</sub>)/2<br />
&nbsp; =&nbsp;-10233.33456127 - (-10274.95222400) + (-82.63929933)/2<br />
&nbsp; =&nbsp;<span class="qv3Wpe" id="cwos">0.298013065</span> [Ry] =&nbsp; <span class="qv3Wpe" id="cwos">0.298013065 </span>* 13.6058 [eV] =&nbsp;<span class="qv3Wpe" id="cwos">4.0547</span> [eV]<br />
&nbsp; 還元側極限（O-poor）: V<sub>O</sub><sup>0</sup> =&nbsp;<span class="qv3Wpe" id="cwos">4.0547</span> + -2.7885 =&nbsp;<span class="qv3Wpe" id="cwos">1.2662</span> [eV]<br />
&nbsp; 酸化側極限（O-rich）: V<sub>O</sub><sup>0</sup> =&nbsp;<span class="qv3Wpe" id="cwos">4.0547</span> + 0 =&nbsp;<span class="qv3Wpe" id="cwos">4.0547</span> [eV]<br />
10. impurity level: &nbsp; =&nbsp; 11.4210 - 9.8437 [eV]<br />
※ 最小単位の構造での構造最適化の値を入力ファイルに利用する。この例では、格子定数のAとCELL_PARAMETERSのみを書きかえた。<br />
※ &Delta;&mu;(Zn) + &Delta;&mu;(O) = &Delta;G<sub>f</sub>(ZnO)<br />
&nbsp;&nbsp;&Delta;&mu;(O)の下限（&Delta;&mu;(Zn)=0,&nbsp;&Delta;&mu;(O) = &Delta;G<sub>f</sub>(ZnO))はZnOとZn金属が平衡した還元側極限に対応する。一方、上限（&Delta;&mu;(Zn)=&Delta;G<sub>f</sub>(ZnO）&Delta;&mu;(O)=0）は酸化側極限に対応する。<br />
※ pwout2in.pyで&quot;Final optimization result was not found in this output file !&quot;とある場合は構造最適化が完全に終了していない。再度上記の3を行う。<br />
<br />
□ step 3 (O vacancy 2+ in ZnO, P6<sub>3</sub>mc (186), 3x3x2)<br />
1. cp&nbsp;zno_vo0_3x3x2.in zno_vo2_3x3x2.in<br />
2. gedit zno_vo2_3x3x2.in<br />
----------(before)<br />
&nbsp; prefix &nbsp;= 'zno_vo0_3x3x2' ,<br />
<br />
&nbsp; tot_charge = 0.0,<br />
----------<br />
----------(after)<br />
&nbsp; prefix &nbsp;= 'zno_vo2_3x3x2' ,<br />
<br />
&nbsp; tot_charge = 2.0,<br />
----------<br />
3. export OMP_NUM_THREADS=1<br />
&nbsp;&nbsp;mpirun -np 4 &nbsp;$HOME/q-e-qe-6.4.1/bin/pw.x &lt; zno_vo2_3x3x2.in | tee zno_vo2_3x3x2.out<br />
4. ./pwoutr2in.py zno_vo2_3x3x2<br />
&nbsp; (xcrysden --pwo&nbsp;zno_vo2_3x3x2.out)<br />
5. cp zno_vo2_3x3x2.new.in zno_vo2_3x3x2_scf.in<br />
6. gedit&nbsp;zno_vo2_3x3x2_scf.in<br />
----------(before)<br />
&nbsp; calculation = 'relax'<br />
<br />
K_POINTS automatic<br />
&nbsp; 2 2 1 1 1 0<br />
----------<br />
----------(after)<br />
&nbsp; calculation = 'scf'<br />
<br />
&nbsp; input_dft='hse', nqx1=1,&nbsp;nqx2=1,&nbsp;nqx3=1,<br />
&nbsp;&nbsp;exx_fraction = 0.375,<br />
<br />
K_POINTS automatic<br />
&nbsp; 2 2 2 1 1 1<br />
----------<br />
7.&nbsp;mpirun -np 4 &nbsp;$HOME/q-e-qe-6.4.1/bin/pw.x &lt; zno_vo2_3x3x2_scf.in | tee zno_vo2_3x3x2_scf.out<br />
8. grep &quot; &nbsp;total energy&quot; zno_vo2_3x3x2_scf.out | tail -n 1<br />
&nbsp; (!&nbsp;&nbsp;&nbsp; total energy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =&nbsp; -10234.72812396 Ry)<br />
9.&nbsp;grep &quot;Fermi&quot; zno_vo2_3x3x2_scf.out | tail -n 1<br />
&nbsp; (&nbsp;&nbsp;&nbsp;&nbsp; the Fermi energy is&nbsp;&nbsp;&nbsp;&nbsp; 9.3811 ev)<br />
10.&nbsp;formation enegy (defect) = E<sub>tot</sub>(ZnO_V<sub>O</sub>(2+)) - E<sub>tot</sub>(ZnO) +&nbsp; E<sub>tot</sub>(O<sub>2</sub>)/2 + q*(E<sub>VBM</sub> + E<sub>F</sub>)<br />
&nbsp; = -10234.72812396 - (-10274.95222400) + (-82.63929933)/2 + q*(E<sub>VBM</sub> + E<sub>F</sub>)<br />
&nbsp; =&nbsp;<span class="qv3Wpe" id="cwos">-1.0955</span> Ry&nbsp; + 2*(E<sub>VBM</sub> + E<sub>F</sub>)<sub>&nbsp;</sub> =&nbsp;<span class="qv3Wpe" id="cwos">-1.0955</span> * 13.6058 eV + 2*(E<sub>VBM</sub> + E<sub>F</sub>)<sub> </sub>= <span class="qv3Wpe" id="cwos">-14.9051</span> eV + 2*(E<sub>VBM</sub> + E<sub>F</sub>)<br />
&nbsp; 還元側極限（O-poor）: V<sub>O</sub><sup>2+</sup> =&nbsp; <span class="qv3Wpe" id="cwos">-14.9051</span> + -2.7885 + q*(E<sub>VBM</sub> + E<sub>F</sub>) =&nbsp;<span class="qv3Wpe" id="cwos">-17.6936</span> + 2*(E<sub>VBM</sub> + E<sub>F</sub>) [eV]<br />
&nbsp; 酸化側極限（O-rich）: V<sub>O</sub><sup>2+</sup> = <span class="qv3Wpe" id="cwos">-14.9051</span> + 0 + q*(E<sub>VBM</sub> + E<sub>F</sub>) =&nbsp;<span class="qv3Wpe" id="cwos">-14.9051</span> + 2*(E<sub>VBM</sub> + E<sub>F</sub>) [eV]<br />
11. E<sub>F </sub><span class="qv3Wpe">at (0/+2) level</span><br />
<span class="qv3Wpe">&nbsp; </span><span class="qv3Wpe" id="cwos">1.2662</span><span class="qv3Wpe"> = </span><span class="qv3Wpe" id="cwos">-17.6936</span> + 2*(E<sub>VBM</sub> + E<sub>F</sub>)<br />
<span class="qv3Wpe" id="cwos">&nbsp; </span>E<sub>F</sub> = (<span class="qv3Wpe" id="cwos">1.2662</span> + <span class="qv3Wpe" id="cwos">17.6936)/2 - </span>E<sub>VBM</sub><br />
<br />
□ step 4 (1+ in ZnO, P6<sub>3</sub>mc (186), 3x3x2)<br />
1. cp&nbsp;zno_3x3x2.in zno_m1e_3x3x2.in<br />
2. gedit zno_m1e_3x3x2.in<br />
----------(before)<br />
&nbsp; prefix &nbsp;= 'zno_3x3x2' ,<br />
<br />
&nbsp; tot_charge = 0.0,<br />
----------<br />
----------(after)<br />
&nbsp; prefix &nbsp;= 'zno_m1e_3x3x2' ,<br />
<br />
&nbsp; tot_charge = 1.0,<br />
----------<br />
3. export OMP_NUM_THREADS=1<br />
&nbsp;&nbsp;mpirun -np 4 &nbsp;$HOME/q-e-qe-6.4.1/bin/pw.x &lt; zno_m1e_3x3x2.in | tee zno_m1e_3x3x2.out<br />
4. cp zno_m1e_3x3x2.in zno_m1e_3x3x2_scf.in<br />
5. gedit&nbsp;zno_m1e_3x3x2_scf.in<br />
----------(before)<br />
K_POINTS automatic<br />
&nbsp; 2 2 1 1 1 0<br />
----------<br />
----------(after)<br />
&nbsp; input_dft='hse', nqx1=1,&nbsp;nqx2=1,&nbsp;nqx3=1,<br />
&nbsp;&nbsp;exx_fraction = 0.375,<br />
<br />
K_POINTS automatic<br />
&nbsp; 2 2 2 1 1 1<br />
----------<br />
6.&nbsp;mpirun -np 4 &nbsp;$HOME/q-e-qe-6.4.1/bin/pw.x &lt; zno_m1e_3x3x2_scf.in | tee zno_m1e_3x3x2_scf.out<br />
7. grep &quot; &nbsp;total energy&quot; zno_m1e_3x3x2_scf.out | tail -n 1<br />
8.&nbsp;E<sub>VBM</sub> =&nbsp;E<sub>tot</sub>(ZnO) -&nbsp;E<sub>tot</sub>(ZnO_(1+)) = ( (-10274.95430608) - (-10275.66811453) )*13.6058 = 9.711935 [eV]<br />
※ step1の Fermi energy 9.8437 eVとほとんど変わらない。<br />
<br />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">□ sxdefectalign</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">1. gedit inp_pris</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">---------</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&amp;INPUTPP</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; prefix='</span>zno_3x3x2<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">'</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
&nbsp;&nbsp; outdir &nbsp;= './work/' ,<br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; filplot='pris.pp'</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; plot_num = 11</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">/</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&amp;PLOT</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; nfile=1</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; filepp(1)='pris.pp'</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; iflag=3</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; output_format=6</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; fileout='v_elec_pristine.cube'</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">/</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">---------</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">2. ~/qe-6.5/bin/pp.x &lt; inp_pris</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">3. gedit inp_defe</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">---------</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&amp;INPUTPP</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; prefix='</span>zno_vo2_3x3x2<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">'</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; </span>outdir &nbsp;= './work/' ,<br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; filplot='relax_defe.pp'</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; plot_num = 11</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">/</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&amp;PLOT</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; nfile=1</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; filepp(1)='relax_defe.pp'</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; iflag=3</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; output_format=6</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; fileout='v_elec_defect.cube'</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">/</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">---------</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">4. ~/qe-6.5/bin/pp.x &lt; inp_defe</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">5. ./sxdefectalign -q -2 --eps 8.5 --vdef v_elec_defect.cube --vref v_elec_pristine.cube --ecut 40 --qe --average 5.2</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; (a1. wget https://sxrepo.mpie.de/attachments/download/20/sxdefectalign.bz2</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp;&nbsp; a2. bunzip2 sxdefectalign.bz2</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp;&nbsp; a3. chmod +x sxdefectalign)<br />
----------</span><br />
=== Intermediate results (unscreened) ===<br />
Isolated energy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 1.59577<br />
Periodic energy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 1.26285<br />
Difference (Hartree)&nbsp; : -0.332924<br />
Difference (eV)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : -9.05932<br />
+-----------------------------------------------------------------------------<br />
Calculation performed with epsilon = 8.5<br />
+-----------------------------------------------------------------------------<br />
Defect correction (eV): 1.0658 (incl. screening &amp; alignment)<br />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">----------</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">6. xmgrace -nxy vline-eV-a0.dat</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; xmgrace -nxy vline-eV-a1.dat</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; xmgrace -nxy vline-eV-a2.dat</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">&nbsp; (you estimate a plateau value of C=-0.15 eV for the green line.)</span><br style="color: rgb(0, 0, 0); font-family: verdana,tahoma,&quot;ｍｓ ゴシック&quot;,&quot;ｍｓ ｐゴシック&quot;,&quot;ヒラギノ角ゴ pro w3&quot;,osaka?等幅,osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;" />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">7. ./sxdefectalign -q -2 --eps 8.5 --vdef v_elec_defect.cube --vref v_elec_pristine.cube --ecut 40 --qe --average 5.2 -C -0.15<br />
----------</span><br />
=== Intermediate results (unscreened) ===<br />
Isolated energy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 1.59577<br />
Periodic energy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 1.26285<br />
Difference (Hartree)&nbsp; : -0.332924<br />
Difference (eV)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : -9.05932<br />
+-----------------------------------------------------------------------------<br />
Calculation performed with epsilon = 8.5<br />
+-----------------------------------------------------------------------------<br />
Defect correction (eV): 0.765803 (incl. screening &amp; alignment)<br />
<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: black; font-family: verdana,tahoma,&quot;ＭＳ ゴシック&quot;,&quot;ＭＳ Ｐゴシック&quot;,&quot;ヒラギノ角ゴ Pro W3&quot;,Osaka?等幅,Osaka,平成角ゴシック,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; line-height: 1.5; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;">----------</span><br />
<br />
----------<br />
tot_charge (Default: 0.0)<br />
<font face="arial,helvetica,sans-serif">&nbsp; <span style="text-align: left; color: rgb(0, 0, 0); text-transform: none; text-indent: 0px; letter-spacing: normal; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; word-spacing: 0px; display: inline !important; white-space: pre; orphans: 2; float: none; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">tot_charge=+1 means one electron missing from the system</span></font><br />
&nbsp;&nbsp;<span style="display: inline !important; float: none; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: arial,helvetica,sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: pre; word-spacing: 0px;">tot_charge=-1 means one additional electron</span><br />
----------<br />
-----------------------------------------------------------------------------<br />
■ pwoutr2in.py ([calculation = relax] only)<br />
<br />
--------------------<br />
#!/usr/bin/python<br />
import sys,math<br />
<br />
# pwoutr2in.py<br />
# original pwout2in.py made by mkanzaki@me.com<br />
# pwoutr2in.py modified by student<br />
# Utility code for Quantum-Espsresso. (qe-6.5)<br />
# This code converts pw.x output (relax calculation) to new input file.<br />
# Usage:<br />
# &gt;./pwoutr2in.py test<br />
# Then test.new.in will be produced.<br />
# test.in and test.out must exist.<br />
#<br />
<br />
cell = ['' for i in range(4)]<br />
position = ['' for i in range(1000)]<br />
<br />
# conversion for radian<br />
rd = math.pi/180.0<br />
# conversion factor for atomic unit to angstrom<br />
bohr = 0.5291772108<br />
<br />
# reading output file<br />
# check xtl file name is given or not<br />
if len(sys.argv) == 1:<br />
&nbsp;&nbsp; &nbsp;print 'No file name provided!'<br />
&nbsp;&nbsp; &nbsp;print 'for example: &gt; ./pwoutr2in.py test'<br />
&nbsp;&nbsp; &nbsp;print 'test.out and test.in must exist.'<br />
&nbsp;&nbsp; &nbsp;exit()<br />
try:<br />
&nbsp;&nbsp; &nbsp;f1 = sys.argv[1] + '.in'<br />
&nbsp;&nbsp; &nbsp;file1 = open(f1,'r')<br />
&nbsp;&nbsp; &nbsp;f2 = sys.argv[1] + '.out'<br />
&nbsp;&nbsp; &nbsp;file2 = open(f2,'r')<br />
except IOError, (errno, msg):<br />
&nbsp;&nbsp; &nbsp;print 'File open error!'<br />
&nbsp;&nbsp; &nbsp;exit()<br />
# Get file name<br />
f3 = sys.argv[1] + '.new.in'<br />
#f3 = 'temp.in'<br />
# Open new file .in<br />
file3 = open(f3,'w')<br />
<br />
# find a line containing &quot;Final&quot; in .out file<br />
while True:<br />
&nbsp;&nbsp; &nbsp;ftext = file2.readline()<br />
&nbsp;&nbsp; &nbsp;if 'Final' in ftext :<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;break<br />
&nbsp;&nbsp; &nbsp;if ftext==&quot;&quot;:<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print 'Final optimization result was not found in this output file!'<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;file1.close()<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;file2.close()<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;file3.close()<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;exit()&nbsp;&nbsp; &nbsp;<br />
# find read atomic position line in .out file<br />
while True:<br />
&nbsp;&nbsp; &nbsp;ftext = file2.readline()<br />
&nbsp;&nbsp; &nbsp;if 'ATOMIC_POSITIONS' in ftext :<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;break<br />
# read atomic positions in .out file<br />
i = 1<br />
while True:<br />
&nbsp;&nbsp; &nbsp;ftext = file2.readline()<br />
&nbsp;&nbsp; &nbsp;if 'End final coordinates' in ftext :<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;break<br />
&nbsp;&nbsp; &nbsp;else:<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;position[i] = ftext<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;i = i + 1<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#print str(i)<br />
natom = i<br />
file2.close()<br />
<br />
# read original .in file&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br />
while True:<br />
&nbsp;&nbsp; &nbsp;ftext = file1.readline()<br />
&nbsp;&nbsp; &nbsp;if 'ATOMIC_POSITIONS' in ftext :<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;break<br />
&nbsp;&nbsp; &nbsp;file3.write(ftext)<br />
file3.write(ftext)<br />
for i in range(1,natom): # write new positions<br />
&nbsp;&nbsp; &nbsp;file3.write(position[i])<br />
while True:<br />
&nbsp;&nbsp; &nbsp;ftext = file1.readline()<br />
&nbsp;&nbsp; &nbsp;if 'K_POINTS' in ftext :<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;break<br />
file3.write(ftext)<br />
ftext = file1.readline()<br />
file3.write(ftext)<br />
file1.close()<br />
file3.close()<br />
--------------------<br />
-----------------------------------------------------------------------------</div>
</div>
