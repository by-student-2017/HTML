GULP potential parameter fitting&nbsp;<br />
------------------------------------------------------------------------------<br />
■ github<br />
1. git clone&nbsp;https://github.com/by-student-2017/csh.git<br />
2. cd csh/GULP<br />
3. ls<br />
&nbsp; (you can see powell.py, nm.py and baysian.py, etc)<br />
------------------------------------------------------------------------------<br />
■ Powell method<br />
<br />
□ Powell (1 parameter fitting)<br />
1. powell.py<br />
----------<br />
from scipy import optimize<br />
import numpy as np<br />
import commands<br />
<br />
file_tmp = 'mgh2_tmp.gin'<br />
file_inp = 'mgh2.gin'<br />
file_out = 'mgh2.got'<br />
<br />
gulp_adress = &quot;$HOME/gulp-5.1/Src/gulp&quot;<br />
<br />
keyword = &quot;Frequency&quot;<br />
target = 180.0<br />
x0 = [1437.0]<br />
b1 = np.array([1000,1600])<br />
<br />
def f(x):<br />
<br />
&nbsp; fi = open(file_tmp,'r')<br />
&nbsp; text = fi.read().replace('XXXX',str(x[0]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; fi.close<br />
<br />
&nbsp; with open(file_inp,'w') as f:<br />
&nbsp; &nbsp; print &gt;&gt; f, text<br />
<br />
&nbsp; commands.getoutput(gulp_adress+&quot; &lt; &quot;+file_inp+&quot; &gt; &quot;+file_out)<br />
<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR&lt;=420){printf($5)}else{}}' mgh2.got&quot;<br />
&nbsp; y_str = commands.getoutput(get_data)<br />
<br />
&nbsp; y = ((float(y_str)-target)/target)**2<br />
&nbsp; print y, x[0]<br />
<br />
&nbsp; return y<br />
<br />
res = optimize.minimize(f,x0,method='Powell',bounds=b1)<br />
#res = optimize.fmin_bfgs(f,x0)<br />
#res = optimize.fmin_cg(f,x0)<br />
----------<br />
2. sed -i 's/\r//g' powell.py<br />
&nbsp; (sudo apt install nkf)<br />
&nbsp; (nkf -Lu powell.py)<br />
3. python powell.py<br />
◇ mgh2_tmp.gin<br />
-----<br />
opti conp prop phon inten noden dispersion<br />
cell<br />
4.5119 4.5119 3.0157 90.0 90.0 90.0<br />
frac<br />
Mg core &nbsp;0.000000 &nbsp; 0.000000 &nbsp; 0.500000 &nbsp;1.836<br />
H &nbsp;core &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 -0.409<br />
H &nbsp;shel &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 -0.509<br />
space<br />
136<br />
buck<br />
H shel Mg core 1012.0 0.24675 &nbsp;0.00 0.0 12.800<br />
buck<br />
H shel H &nbsp;shel 5558.0 0.23258 22.12 0.0 12.800<br />
buck<br />
H core Mg core XXXX 0.24675 &nbsp;0.00 0.0 12.800<br />
spring<br />
0 74.92<br />
-----<br />
<br />
------------------------------------------------------------------------------<br />
■ Nelder-Mead method<br />
<br />
□ Nelder-Mead method (2 parameters fitting)<br />
1. nm.py<br />
----------<br />
from scipy import optimize<br />
import numpy as np<br />
import commands<br />
<br />
file_tmp = 'mgh2_tmp.gin'<br />
file_inp = 'mgh2.gin'<br />
file_out = 'mgh2.got'<br />
<br />
gulp_adress = &quot;$HOME/gulp-5.1/Src/gulp&quot;<br />
<br />
keyword = &quot;Frequency&quot;<br />
target1 = 180.65<br />
target2 = 238.18<br />
x0 = [1.5,-0.5]<br />
b1 = np.array([[0,2.2],[-1,1]])<br />
<br />
def f(x):<br />
<br />
&nbsp; fi = open(file_tmp,'r')<br />
&nbsp; text = fi.read().replace('XXX0',str(x[0]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace('XXX1',str(x[1]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; x2 = -(x[0]/2 + x[1])<br />
&nbsp; text = text.replace('XXX2',str(x2).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; fi.close<br />
<br />
&nbsp; with open(file_inp,'w') as f:<br />
&nbsp; &nbsp; print &gt;&gt; f, text<br />
<br />
&nbsp; commands.getoutput(gulp_adress+&quot; &lt; &quot;+file_inp+&quot; &gt; &quot;+file_out)<br />
<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR&lt;=420){printf($5)}else{}}' mgh2.got&quot;<br />
&nbsp; y1_str = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR&lt;=420){printf($6)}else{}}' mgh2.got&quot;<br />
&nbsp; y2_str = commands.getoutput(get_data)<br />
<br />
&nbsp; y = ((float(y1_str)-target1)/target1)**2 + ((float(y2_str)-target2)/target2)**2<br />
&nbsp; print y, x<br />
<br />
&nbsp; return y<br />
<br />
res = optimize.minimize(f,x0,method='Nelder-Mead',bounds=b1)<br />
#res = optimize.fmin_bfgs(f,x0)<br />
#res = optimize.fmin_cg(f,x0)<br />
----------<br />
2. sed -i 's/\r//g' nm.py<br />
&nbsp; (sudo apt install nkf)<br />
&nbsp; (nkf -Lu nm.py)<br />
3. python nm.py<br />
◇ mgh2_tmp.gin<br />
-----<br />
opti conp prop phon inten noden dispersion<br />
cell<br />
4.5119 4.5119 3.0157 90.0 90.0 90.0<br />
frac<br />
Mg core &nbsp;0.000000 &nbsp; 0.000000 &nbsp; 0.500000 &nbsp;XXX0<br />
H &nbsp;core &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 &nbsp;XXX1<br />
H &nbsp;shel &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 &nbsp;XXX2<br />
space<br />
136<br />
buck<br />
H shel Mg core 1012.0 0.24675 &nbsp;0.00 0.0 12.800<br />
buck<br />
H shel H &nbsp;shel 5558.0 0.23258 22.12 0.0 12.800<br />
buck<br />
H core Mg core 1435.38 0.24675 &nbsp;0.00 0.0 12.800<br />
spring<br />
0 74.92<br />
-----<br />
<br />
<br />
□ Nelder-Mead method (7 parameter fitting for 15 output data)<br />
1. nm.py<br />
----------<br />
from scipy import optimize<br />
import numpy as np<br />
import commands<br />
<br />
file_tmp = 'mgh2_tmp.gin'<br />
file_inp = 'mgh2.gin'<br />
file_out = 'mgh2.got'<br />
<br />
gulp_adress = &quot;$HOME/gulp-5.1/Src/gulp&quot;<br />
<br />
keyword = &quot;Frequency&quot;<br />
target = [180.65, 238.18, 299.64, 299.64, 488.61, 709.34, 738.37, 878.45, 988.57, 988.57, 1121.2, 1206.34, 1309.89, 1396.78, 1472.68]<br />
y_str = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] # initial data<br />
<br />
# fitting parameters<br />
x0 = [1.76, -0.426, 1012.0, 5519.0, 1458.0, 21.21] # initial data<br />
b1 = np.array([[0,2.2],[-1,1],[950,1800],[5500,6000],[950,1800],[15,30]]) # boundary<br />
<br />
def f(x):<br />
<br />
&nbsp; fi = open(file_tmp,'r')<br />
&nbsp; text = fi.read().replace('XXX0',str(x[0]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace('XXX1',str(x[1]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; xc1 = -(x[0]/2 + x[1])<br />
&nbsp; text = text.replace('XXX2',str(xc1).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace('XXX3',str(x[2]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace('XXX4',str(x[3]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace('XXX5',str(x[4]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace('XXX6',str(x[5]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; fi.close<br />
<br />
&nbsp; with open(file_inp,'w') as f:<br />
&nbsp; &nbsp; print &gt;&gt; f, text<br />
<br />
&nbsp; commands.getoutput(gulp_adress+&quot; &lt; &quot;+file_inp+&quot; &gt; &quot;+file_out)<br />
<br />
&nbsp; get_line = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot;){printf \&quot;%i \&quot;,NR }else{}}' &quot;+file_out<br />
&nbsp; line = commands.getoutput(get_line)<br />
&nbsp; line_list = line.rstrip().split(&quot; &quot;)<br />
&nbsp; #print line_list, len(line_list)<br />
<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[0]+&quot;){printf($5)}else{}}' &quot;+file_out<br />
&nbsp; y_str[0] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[0]+&quot;){printf($6)}else{}}' &quot;+file_out<br />
&nbsp; y_str[1] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[0]+&quot;){printf($7)}else{}}' &quot;+file_out<br />
&nbsp; y_str[2] = commands.getoutput(get_data)<br />
&nbsp; #<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($2)}else{}}' &quot;+file_out<br />
&nbsp; y_str[3] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($3)}else{}}' &quot;+file_out<br />
&nbsp; y_str[4] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($4)}else{}}' &quot;+file_out<br />
&nbsp; y_str[5] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($5)}else{}}' &quot;+file_out<br />
&nbsp; y_str[6] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($6)}else{}}' &quot;+file_out<br />
&nbsp; y_str[7] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($7)}else{}}' &quot;+file_out<br />
&nbsp; y_str[8] = commands.getoutput(get_data)<br />
&nbsp; #<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($2)}else{}}' &quot;+file_out<br />
&nbsp; y_str[9] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($3)}else{}}' &quot;+file_out<br />
&nbsp; y_str[10] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($4)}else{}}' &quot;+file_out<br />
&nbsp; y_str[11] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($5)}else{}}' &quot;+file_out<br />
&nbsp; y_str[12] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($6)}else{}}' &quot;+file_out<br />
&nbsp; y_str[13] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($7)}else{}}' &quot;+file_out<br />
&nbsp; y_str[14] = commands.getoutput(get_data)<br />
&nbsp; print y_str<br />
<br />
&nbsp; y = ((float(y_str[0])-target[0])/target[0])**2 + ((float(y_str[1])-target[1])/target[1])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[2])-target[2])/target[2])**2 + ((float(y_str[3])-target[3])/target[3])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[4])-target[4])/target[4])**2 + ((float(y_str[5])-target[5])/target[5])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[6])-target[6])/target[6])**2 + ((float(y_str[7])-target[7])/target[7])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[8])-target[8])/target[7])**2 + ((float(y_str[9])-target[9])/target[9])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[10])-target[10])/target[8])**2 + ((float(y_str[11])-target[11])/target[11])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[12])-target[12])/target[12])**2 + ((float(y_str[13])-target[13])/target[13])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[14])-target[14])/target[14])**2<br />
&nbsp; print y, x<br />
&nbsp; print &quot;------------------------&quot;<br />
<br />
&nbsp; return y<br />
<br />
res = optimize.minimize(f,x0,method='Nelder-Mead',bounds=b1)<br />
#res = optimize.minimize(f,x0,method='Powell',bounds=b1)<br />
#res = optimize.minimize(f,x0,method='BFGS',bounds=b1)<br />
----------<br />
2. sed -i 's/\r//g' nm.py<br />
&nbsp; (sudo apt install nkf)<br />
&nbsp; (nkf -Lu nm.py)<br />
3. python nm.py<br />
◇ mgh2_tmp.gin<br />
-----<br />
opti conp prop phon inten noden dispersion<br />
cell<br />
4.5119 4.5119 3.0157 90.0 90.0 90.0<br />
frac<br />
Mg core &nbsp;0.000000 &nbsp; 0.000000 &nbsp; 0.500000 &nbsp;XXX0<br />
H &nbsp;core &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 &nbsp;XXX1<br />
H &nbsp;shel &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 &nbsp;XXX2<br />
space<br />
136<br />
buck<br />
H shel Mg core XXX3 0.24675 &nbsp;0.00 0.0 12.800<br />
buck<br />
H shel H &nbsp;shel XXX4 0.23258 &nbsp;XXX6 0.0 12.800<br />
buck<br />
H core Mg core XXX5 0.24675 &nbsp;0.00 0.0 12.800<br />
spring<br />
0 74.92<br />
-----<br />
<br />
◇ phonon of MgH2 (Gamma point) on Abinit code<br />
0.0 0.0 0.0 180.65 238.18 299.64<br />
299.64 488.61 709.34 738.37 878.45 988.57<br />
988.57 1121.2 1206.34 1309.89 1396.78 1472.68<br />
----------Memo<br />
grep -c &quot;Frequency&quot; mgh2.got<br />
grep -e &quot;Frequency&quot; -n mgh2.got | sed -e 's/:.*//g'<br />
grep -e &quot;Frequency&quot; -n mgh2.got | sed -e 's/.*://g' | sed -e 's/Frequency//g'<br />
----------<br />
<br />
<br />
□ Nelder-Mead method (13 parameters fitting for 15 output data)<br />
1. nm.py<br />
----------<br />
from scipy import optimize<br />
import numpy as np<br />
import commands<br />
import sys<br />
<br />
file_tmp = 'mgh2_tmp.gin'<br />
file_inp = 'mgh2.gin'<br />
file_out = 'mgh2.got'<br />
<br />
gulp_adress = &quot;$HOME/gulp-5.1/Src/gulp&quot;<br />
<br />
limit = 0.5<br />
<br />
keyword = &quot;Frequency&quot;<br />
target = [180.65, 238.18, 299.64, 299.64, 488.61, 709.34, 738.37, 878.45, 988.57, 988.57, 1121.2, 1206.34, 1309.89, 1396.78, 1472.68]<br />
y_str = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] # initial data<br />
<br />
# fitting parameters<br />
x0 = [1.74, -0.431, 1024.0, 5585.0, 1273.0, 0.2442, 0.2353, 0.2497, 10.3, 0.0, 19, 45] # initial data<br />
b1 = np.array([[0,2.2],[-1,1],[950,1800],[5500,6000],[950,1800],[0.2,0.3],[0.2,0.3],[0.2,0.3],[0,30],[0,30],[0,30],[0,150]]) # boundary<br />
<br />
def f(x):<br />
<br />
&nbsp; fi = open(file_tmp,'r')<br />
&nbsp; text = fi.read().replace('XXX0',str(x[0]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace('XXX1',str(x[1]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; xc1 = -(x[0]/2 + x[1])<br />
&nbsp; text = text.replace('XXX2',str(xc1).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace('XXX3',str(x[2]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace('XXX4',str(x[3]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace('XXX5',str(x[4]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace('XXX6',str(x[5]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace('XXX7',str(x[6]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace('XXX8',str(x[7]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace('XXX9',str(x[8]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace('XX10',str(x[9]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace('XX11',str(x[10]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; text = text.replace('XX12',str(x[11]).replace(&quot;[&quot;,&quot;&quot;).replace(&quot;]&quot;,&quot;&quot;))<br />
&nbsp; fi.close<br />
<br />
&nbsp; with open(file_inp,'w') as f:<br />
&nbsp; &nbsp; print &gt;&gt; f, text<br />
<br />
&nbsp; commands.getoutput(gulp_adress+&quot; &lt; &quot;+file_inp+&quot; &gt; &quot;+file_out)<br />
<br />
&nbsp; get_line = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot;){printf \&quot;%i \&quot;,NR }else{}}' &quot;+file_out<br />
&nbsp; line = commands.getoutput(get_line)<br />
&nbsp; line_list = line.rstrip().split(&quot; &quot;)<br />
&nbsp; #print line_list, len(line_list)<br />
<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[0]+&quot;){printf($5)}else{}}' &quot;+file_out<br />
&nbsp; y_str[0] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[0]+&quot;){printf($6)}else{}}' &quot;+file_out<br />
&nbsp; y_str[1] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[0]+&quot;){printf($7)}else{}}' &quot;+file_out<br />
&nbsp; y_str[2] = commands.getoutput(get_data)<br />
&nbsp; #<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($2)}else{}}' &quot;+file_out<br />
&nbsp; y_str[3] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($3)}else{}}' &quot;+file_out<br />
&nbsp; y_str[4] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($4)}else{}}' &quot;+file_out<br />
&nbsp; y_str[5] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($5)}else{}}' &quot;+file_out<br />
&nbsp; y_str[6] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($6)}else{}}' &quot;+file_out<br />
&nbsp; y_str[7] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($7)}else{}}' &quot;+file_out<br />
&nbsp; y_str[8] = commands.getoutput(get_data)<br />
&nbsp; #<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($2)}else{}}' &quot;+file_out<br />
&nbsp; y_str[9] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($3)}else{}}' &quot;+file_out<br />
&nbsp; y_str[10] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($4)}else{}}' &quot;+file_out<br />
&nbsp; y_str[11] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($5)}else{}}' &quot;+file_out<br />
&nbsp; y_str[12] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($6)}else{}}' &quot;+file_out<br />
&nbsp; y_str[13] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($7)}else{}}' &quot;+file_out<br />
&nbsp; y_str[14] = commands.getoutput(get_data)<br />
&nbsp; print y_str<br />
<br />
&nbsp; y = ((float(y_str[0])-target[0])/target[0])**2 + ((float(y_str[1])-target[1])/target[1])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[2])-target[2])/target[2])**2 + ((float(y_str[3])-target[3])/target[3])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[4])-target[4])/target[4])**2 + ((float(y_str[5])-target[5])/target[5])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[6])-target[6])/target[6])**2 + ((float(y_str[7])-target[7])/target[7])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[8])-target[8])/target[7])**2 + ((float(y_str[9])-target[9])/target[9])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[10])-target[10])/target[8])**2 + ((float(y_str[11])-target[11])/target[11])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[12])-target[12])/target[12])**2 + ((float(y_str[13])-target[13])/target[13])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[14])-target[14])/target[14])**2<br />
&nbsp; print y, x<br />
&nbsp; print &quot;------------------------&quot;<br />
<br />
&nbsp; if (y &lt; limit):<br />
&nbsp; &nbsp; sys.exit()<br />
<br />
&nbsp; return y<br />
<br />
res = optimize.minimize(f,x0,method='Nelder-Mead',bounds=b1)<br />
#res = optimize.minimize(f,x0,method='TNC',bounds=b1)<br />
#res = optimize.minimize(f,x0,method='Powell',bounds=b1)<br />
#res = optimize.minimize(f,x0,method='BFGS',bounds=b1)<br />
----------<br />
2. sed -i 's/\r//g' nm.py<br />
&nbsp; (sudo apt install nkf)<br />
&nbsp; (nkf -Lu nm.py)<br />
3. python nm.py<br />
◇ mgh2_tmp.gin<br />
-----<br />
opti conp prop phon inten noden dispersion<br />
cell<br />
4.5119 4.5119 3.0157 90.0 90.0 90.0<br />
frac<br />
Mg core &nbsp;0.000000 &nbsp; 0.000000 &nbsp; 0.500000 &nbsp;XXX0<br />
H &nbsp;core &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 &nbsp;XXX1<br />
H &nbsp;shel &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 &nbsp;XXX2<br />
space<br />
136<br />
buck<br />
H shel Mg core XXX3 XXX6 &nbsp;XXX9 0.0 12.800<br />
buck<br />
H shel H &nbsp;shel XXX4 XXX7 &nbsp;XX10 0.0 12.800<br />
buck<br />
H core Mg core XXX5 XXX8 &nbsp;XX11 0.0 12.800<br />
spring<br />
0 XX12 0<br />
-----<br />
◇ Result<br />
['203.6002', '252.7876', '347.6182', '347.6182', '494.9434', '494.9434', '699.2810', '992.8154', '1005.3407', '1005.3407', '1096.0303', '1261.3739', '1261.3739', '1263.1809', '1397.4101']<br />
0.198965970701 [ 1.74000e+00 -4.31000e-01 &nbsp;1.02400e+03 &nbsp;5.58500e+03 &nbsp;1.27300e+03<br />
&nbsp; 2.44200e-01 &nbsp;2.35300e-01 &nbsp;2.62185e-01 &nbsp;1.03000e+01 &nbsp;0.00000e+00<br />
&nbsp; 1.90000e+01 &nbsp;4.50000e+01]<br />
-----(mgh2.gin)<br />
opti conp prop phon inten noden dispersion<br />
cell<br />
4.5119 4.5119 3.0157 90.0 90.0 90.0<br />
frac<br />
Mg core &nbsp;0.000000 &nbsp; 0.000000 &nbsp; 0.500000 &nbsp;1.74<br />
H &nbsp;core &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 &nbsp;-0.431<br />
H &nbsp;shel &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 &nbsp;-0.439<br />
space<br />
136<br />
buck<br />
H shel Mg core 1024.0 0.2442 &nbsp;10.3 0.0 12.800<br />
buck<br />
H shel H &nbsp;shel 5585.0 0.2353 &nbsp;0.0 0.0 12.800<br />
buck<br />
H core Mg core 1273.0 0.262185 &nbsp;19.0 0.0 12.800<br />
spring<br />
0 45.0 0<br />
-----<br />
2. ~/gulp-5.1/Src/gulp &lt; mgh2.gin | tee mgh2.got<br />
3. gnuplot<br />
&nbsp; set xzeroaxis<br />
&nbsp; set yrange[-50:1500]<br />
&nbsp; set arrow from 100,-50 to 100,1500 nohead<br />
&nbsp; set arrow from 200,-50 to 200,1500 nohead<br />
&nbsp; set arrow from 400,-50 to 400,1500 nohead<br />
&nbsp; plot &quot;mgh2.disp&quot; w p pt 7 ps 0.1<br />
4. q<br />
5. gnuplot<br />
&nbsp; plot &quot;mgh2.dens&quot; w i<br />
6. q<br />
※ Gamma - X - M - Gamma - Z - R - A<br />
&nbsp; 0.0 0.0 0.0 to 0.0 0.5 0.0 to 0.5 0.5 0.0 to 0.0 0.0 0.0 to 0.0 0.0 0.5 to 0.0 0.5 0.5 to 0.5 0.5 0.5<br />
[P1] Shel Model に基づく Pb (Zr, Ti) O3 の原子間ポテンシャルの開発<br />
&nbsp; https://www.jstage.jst.go.jp/article/kikaia1979/72/718/72_718_817/_pdf<br />
□ Raman<br />
---------<br />
opti conp prop phon inten noden raman<br />
cell<br />
4.5119 4.5119 3.0157 90.0 90.0 90.0<br />
frac<br />
Mg core &nbsp;0.000000 &nbsp; 0.000000 &nbsp; 0.500000 &nbsp;1.74<br />
H &nbsp;core &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 &nbsp;-0.431<br />
H &nbsp;shel &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 &nbsp;-0.439<br />
space<br />
136<br />
rdirection 1.0 1.0 1.0 &nbsp;1.0 -0.5 1.0<br />
buck<br />
H shel Mg core 1024.0 0.2442 &nbsp;10.3 0.0 12.800<br />
buck<br />
H shel H &nbsp;shel 5585.0 0.2353 &nbsp;0.0 0.0 12.800<br />
buck<br />
H core Mg core 1273.0 0.262185 &nbsp;19.0 0.0 12.800<br />
spring<br />
0 45.0 0<br />
---------<br />
&nbsp; Frequencies (cm-1) and IR/Raman Intensities :<br />
<br />
&nbsp; Frequency &nbsp; &nbsp; &nbsp;-0.0000 &nbsp; -0.0000 &nbsp; &nbsp;0.0000 &nbsp;203.6002 &nbsp;252.7876 &nbsp;347.6182<br />
&nbsp; IR Intensity &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.2736<br />
&nbsp; &nbsp; &nbsp;in X &nbsp; &nbsp; &nbsp; &nbsp; 0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.1054<br />
&nbsp; &nbsp; &nbsp;in Y &nbsp; &nbsp; &nbsp; &nbsp; 0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.1683<br />
&nbsp; &nbsp; &nbsp;in Z &nbsp; &nbsp; &nbsp; &nbsp; 0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000<br />
&nbsp; Raman Intsty &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;3.2389 &nbsp; &nbsp;0.0000<br />
<br />
&nbsp; Frequency &nbsp; &nbsp; 347.6182 &nbsp;494.9434 &nbsp;494.9434 &nbsp;699.2810 &nbsp;992.8154 1005.3407<br />
&nbsp; IR Intensity &nbsp; &nbsp;0.2736 &nbsp; &nbsp;0.6156 &nbsp; &nbsp;0.6156 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;2.0080 &nbsp; &nbsp;0.0000<br />
&nbsp; &nbsp; &nbsp;in X &nbsp; &nbsp; &nbsp; &nbsp; 0.1683 &nbsp; &nbsp;0.2109 &nbsp; &nbsp;0.4047 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000<br />
&nbsp; &nbsp; &nbsp;in Y &nbsp; &nbsp; &nbsp; &nbsp; 0.1054 &nbsp; &nbsp;0.4047 &nbsp; &nbsp;0.2109 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000<br />
&nbsp; &nbsp; &nbsp;in Z &nbsp; &nbsp; &nbsp; &nbsp; 0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;2.0080 &nbsp; &nbsp;0.0000<br />
&nbsp; Raman Intsty &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp;259.6240<br />
<br />
&nbsp; Frequency &nbsp; &nbsp;1005.3407 1096.0303 1261.3739 1261.3739 1263.1809 1397.4101<br />
&nbsp; IR Intensity &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.7708 &nbsp; &nbsp;0.7708 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000<br />
&nbsp; &nbsp; &nbsp;in X &nbsp; &nbsp; &nbsp; &nbsp; 0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.4402 &nbsp; &nbsp;0.3306 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000<br />
&nbsp; &nbsp; &nbsp;in Y &nbsp; &nbsp; &nbsp; &nbsp; 0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.3306 &nbsp; &nbsp;0.4402 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000<br />
&nbsp; &nbsp; &nbsp;in Z &nbsp; &nbsp; &nbsp; &nbsp; 0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000<br />
&nbsp; Raman Intsty &nbsp; 94.1869 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp;219.8695 &nbsp; &nbsp;7.1793<br />
---------(Myabe)<br />
・B1g: 252.7876<br />
・Eg : 1005.3407<br />
・Eg : 1005.3407<br />
・A1g: 1263.1809<br />
・B2g: 1397.4101<br />
---------(Myabe)<br />
・B1g<br />
rdirection 1.0 1.0 0.0 &nbsp;1.0 -1.0 0.0<br />
・Eg<br />
rdirection 0.0 1.0 1.0 &nbsp;0.0 1.0 1.0<br />
rdirection 1.0 0.0 1.0 &nbsp;1.0 0.0 1.0<br />
・A1g<br />
rdirection 1.0 1.0 1.0 &nbsp;1.0 1.0 1.0<br />
・B2g<br />
rdirection 1.0 1.0 0.0 &nbsp;1.0 1.0 0.0<br />
------------------------------------------------------------------------------<br />
■ baysian<br />
<br />
□ baysian (13 parameters fitting for 15 output data)<br />
0. pip install bayesian-optimization<br />
1. baysian.py<br />
----------<br />
from bayes_opt import BayesianOptimization<br />
import numpy as np<br />
import commands<br />
import sys<br />
<br />
file_tmp = 'mgh2_tmp.gin'<br />
file_inp = 'mgh2.gin'<br />
file_out = 'mgh2.got'<br />
<br />
gulp_adress = &quot;$HOME/gulp-5.1/Src/gulp&quot;<br />
<br />
#limit = 0.3<br />
<br />
keyword = &quot;Frequency&quot;<br />
target = [180.65, 238.18, 299.64, 299.64, 488.61, 709.34, 738.37, 878.45, 988.57, 988.57, 1121.2, 1206.34, 1309.89, 1396.78, 1472.68]<br />
y_str = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0] # initial data<br />
<br />
# fitting parameters<br />
x0 &nbsp;= 1.83<br />
x1 &nbsp;= -0.426<br />
x2 &nbsp;= 1012.0<br />
x3 &nbsp;= 5519.0<br />
x4 &nbsp;= 1258.0<br />
x5 &nbsp;= 0.24675<br />
x6 &nbsp;= 0.23258<br />
x7 &nbsp;= 0.24675<br />
x8 &nbsp;= 10.3<br />
x9 &nbsp;= 0.0<br />
x10 = 19<br />
x11 = 45.0<br />
pbounds = {<br />
&nbsp; &nbsp;'x0': (1.6,1.85),<br />
&nbsp; &nbsp;'x1': (-0.52,-0.42),<br />
&nbsp; &nbsp;'x2': (980,1100),<br />
&nbsp; &nbsp;'x3': (5450,5600),<br />
&nbsp; &nbsp;'x4': (1240,1300),<br />
&nbsp; &nbsp;'x5': (0.24,0.248),<br />
&nbsp; &nbsp;'x6': (0.23,0.235),<br />
&nbsp; &nbsp;'x7': (0.24,0.248),<br />
&nbsp; &nbsp;'x8': (10,20),<br />
&nbsp; &nbsp;'x9': (0,10),<br />
&nbsp; 'x10': (15,20),<br />
&nbsp; 'x11': (2,80),<br />
} # boundary<br />
<br />
def descripter(x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11):<br />
<br />
&nbsp; fi = open(file_tmp,'r')<br />
&nbsp; text = fi.read().replace('XXX0',str(x0))<br />
&nbsp; text = text.replace('XXX1',str(x1))<br />
&nbsp; xc1 = -(x0/2 + x1)<br />
&nbsp; text = text.replace('XXX2',str(xc1))<br />
&nbsp; text = text.replace('XXX3',str(x2))<br />
&nbsp; text = text.replace('XXX4',str(x3))<br />
&nbsp; text = text.replace('XXX5',str(x4))<br />
&nbsp; text = text.replace('XXX6',str(x5))<br />
&nbsp; text = text.replace('XXX7',str(x6))<br />
&nbsp; text = text.replace('XXX8',str(x7))<br />
&nbsp; text = text.replace('XXX9',str(x8))<br />
&nbsp; text = text.replace('XX10',str(x9))<br />
&nbsp; text = text.replace('XX11',str(x10))<br />
&nbsp; text = text.replace('XX12',str(x11))<br />
&nbsp; fi.close<br />
<br />
&nbsp; with open(file_inp,'w') as f:<br />
&nbsp; &nbsp; print &gt;&gt; f, text<br />
<br />
&nbsp; commands.getoutput(gulp_adress+&quot; &lt; &quot;+file_inp+&quot; &gt; &quot;+file_out)<br />
<br />
&nbsp; get_line = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot;){printf \&quot;%i \&quot;,NR }else{}}' &quot;+file_out<br />
&nbsp; line = commands.getoutput(get_line)<br />
&nbsp; line_list = line.rstrip().split(&quot; &quot;)<br />
&nbsp; #print line_list, len(line_list)<br />
<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[0]+&quot;){printf($5)}else{}}' &quot;+file_out<br />
&nbsp; y_str[0] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[0]+&quot;){printf($6)}else{}}' &quot;+file_out<br />
&nbsp; y_str[1] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[0]+&quot;){printf($7)}else{}}' &quot;+file_out<br />
&nbsp; y_str[2] = commands.getoutput(get_data)<br />
&nbsp; #<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($2)}else{}}' &quot;+file_out<br />
&nbsp; y_str[3] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($3)}else{}}' &quot;+file_out<br />
&nbsp; y_str[4] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($4)}else{}}' &quot;+file_out<br />
&nbsp; y_str[5] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($5)}else{}}' &quot;+file_out<br />
&nbsp; y_str[6] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($6)}else{}}' &quot;+file_out<br />
&nbsp; y_str[7] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[1]+&quot;){printf($7)}else{}}' &quot;+file_out<br />
&nbsp; y_str[8] = commands.getoutput(get_data)<br />
&nbsp; #<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($2)}else{}}' &quot;+file_out<br />
&nbsp; y_str[9] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($3)}else{}}' &quot;+file_out<br />
&nbsp; y_str[10] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($4)}else{}}' &quot;+file_out<br />
&nbsp; y_str[11] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($5)}else{}}' &quot;+file_out<br />
&nbsp; y_str[12] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($6)}else{}}' &quot;+file_out<br />
&nbsp; y_str[13] = commands.getoutput(get_data)<br />
&nbsp; get_data = &quot;awk '{if($1==\&quot;&quot;+keyword+&quot;\&quot; &amp;&amp; NR==&quot;+line_list[2]+&quot;){printf($7)}else{}}' &quot;+file_out<br />
&nbsp; y_str[14] = commands.getoutput(get_data)<br />
&nbsp; #print y_str<br />
<br />
&nbsp; y = 1 / ( ((float(y_str[0])-target[0])/target[0])**2 + ((float(y_str[1])-target[1])/target[1])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[2])-target[2])/target[2])**2 + ((float(y_str[3])-target[3])/target[3])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[4])-target[4])/target[4])**2 + ((float(y_str[5])-target[5])/target[5])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[6])-target[6])/target[6])**2 + ((float(y_str[7])-target[7])/target[7])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[8])-target[8])/target[7])**2 + ((float(y_str[9])-target[9])/target[9])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[10])-target[10])/target[8])**2 + ((float(y_str[11])-target[11])/target[11])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[12])-target[12])/target[12])**2 + ((float(y_str[13])-target[13])/target[13])**2 \<br />
&nbsp; &nbsp; + ((float(y_str[14])-target[14])/target[14])**2 )<br />
&nbsp; #print y,x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11<br />
&nbsp; #print &quot;------------------------&quot;<br />
<br />
&nbsp; #if (y &lt; limit):<br />
&nbsp; # &nbsp;sys.exit()<br />
<br />
&nbsp; return y<br />
<br />
optimizer = BayesianOptimization(f=descripter, pbounds=pbounds)<br />
optimizer.maximize(init_points=3, n_iter=10)<br />
#optimizer.maximize()<br />
----------<br />
2. sed -i 's/\r//g' baysian.py<br />
&nbsp; (sudo apt install nkf)<br />
&nbsp; (nkf -Lu baysian.py)<br />
3. python baysian.py<br />
◇ mgh2_tmp.gin<br />
-----<br />
opti conp prop phon inten noden dispersion<br />
cell<br />
4.5119 4.5119 3.0157 90.0 90.0 90.0<br />
frac<br />
Mg core &nbsp;0.000000 &nbsp; 0.000000 &nbsp; 0.500000 &nbsp;XXX0<br />
H &nbsp;core &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 &nbsp;XXX1<br />
H &nbsp;shel &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 &nbsp;XXX2<br />
space<br />
136<br />
buck<br />
H shel Mg core XXX3 XXX7 &nbsp;0.00 0.0 12.800<br />
buck<br />
H shel H &nbsp;shel XXX4 XXX8 &nbsp;XXX6 0.0 12.800<br />
buck<br />
H core Mg core XXX5 XXX9 &nbsp;0.00 0.0 12.800<br />
spring<br />
0 XX10 0<br />
#shrink<br />
#4 4 4<br />
#kpoints<br />
#8 8 8<br />
#dispersion 1 500<br />
#0.0 0.0 0.0 to 0.0 0.5 0.0 to 0.5 0.5 0.0 to 0.0 0.0 0.0 to 0.0 0.0 0.5<br />
#output phon mgh2<br />
-----<br />
◇ Result<br />
| &nbsp; iter &nbsp; &nbsp;| &nbsp;target &nbsp; | &nbsp; &nbsp;x0 &nbsp; &nbsp; | &nbsp; &nbsp;x1 &nbsp; &nbsp; | &nbsp; &nbsp;x10 &nbsp; &nbsp;| &nbsp; &nbsp;x11 &nbsp; &nbsp;| &nbsp; &nbsp;x2 &nbsp; &nbsp; | &nbsp; &nbsp;x3 &nbsp; &nbsp; | &nbsp; &nbsp;x4 &nbsp; &nbsp; | &nbsp; &nbsp;x5 &nbsp; &nbsp; | &nbsp; &nbsp;x6 &nbsp; &nbsp; | &nbsp; &nbsp;x7 &nbsp; &nbsp; | &nbsp; &nbsp;x8 &nbsp; &nbsp; | &nbsp; &nbsp;x9 &nbsp; &nbsp; |<br />
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------<br />
| &nbsp;1 &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp;0.6117 &nbsp; | &nbsp;1.773 &nbsp; &nbsp;| -0.4248 &nbsp; | &nbsp;17.74 &nbsp; &nbsp;| &nbsp;69.97 &nbsp; &nbsp;| &nbsp;1.008e+0 | &nbsp;5.455e+0 | &nbsp;1.252e+0 | &nbsp;0.2429 &nbsp; | &nbsp;0.2345 &nbsp; | &nbsp;0.2422 &nbsp; | &nbsp;15.34 &nbsp; &nbsp;| &nbsp;4.403 &nbsp; &nbsp;|<br />
| &nbsp;2 &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp;1.017 &nbsp; &nbsp;| &nbsp;1.607 &nbsp; &nbsp;| -0.4918 &nbsp; | &nbsp;17.67 &nbsp; &nbsp;| &nbsp;65.97 &nbsp; &nbsp;| &nbsp;1.083e+0 | &nbsp;5.532e+0 | &nbsp;1.253e+0 | &nbsp;0.2444 &nbsp; | &nbsp;0.2336 &nbsp; | &nbsp;0.2476 &nbsp; | &nbsp;17.86 &nbsp; &nbsp;| &nbsp;4.4 &nbsp; &nbsp; &nbsp;|<br />
| &nbsp;3 &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp;0.3936 &nbsp; | &nbsp;1.848 &nbsp; &nbsp;| -0.4743 &nbsp; | &nbsp;18.61 &nbsp; &nbsp;| &nbsp;75.93 &nbsp; &nbsp;| &nbsp;1.079e+0 | &nbsp;5.585e+0 | &nbsp;1.271e+0 | &nbsp;0.2402 &nbsp; | &nbsp;0.2308 &nbsp; | &nbsp;0.2432 &nbsp; | &nbsp;13.29 &nbsp; &nbsp;| &nbsp;3.539 &nbsp; &nbsp;|<br />
| &nbsp;4 &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp;1.722 &nbsp; &nbsp;| &nbsp;1.6 &nbsp; &nbsp; &nbsp;| -0.52 &nbsp; &nbsp; | &nbsp;15.0 &nbsp; &nbsp; | &nbsp;2.0 &nbsp; &nbsp; &nbsp;| &nbsp;1.1e+03 &nbsp;| &nbsp;5.45e+03 | &nbsp;1.3e+03 &nbsp;| &nbsp;0.248 &nbsp; &nbsp;| &nbsp;0.23 &nbsp; &nbsp; | &nbsp;0.248 &nbsp; &nbsp;| &nbsp;20.0 &nbsp; &nbsp; | &nbsp;10.0 &nbsp; &nbsp; |<br />
| &nbsp;5 &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp;0.3803 &nbsp; | &nbsp;1.85 &nbsp; &nbsp; | -0.42 &nbsp; &nbsp; | &nbsp;20.0 &nbsp; &nbsp; | &nbsp;2.0 &nbsp; &nbsp; &nbsp;| &nbsp;1.1e+03 &nbsp;| &nbsp;5.45e+03 | &nbsp;1.24e+03 | &nbsp;0.24 &nbsp; &nbsp; | &nbsp;0.235 &nbsp; &nbsp;| &nbsp;0.24 &nbsp; &nbsp; | &nbsp;10.0 &nbsp; &nbsp; | &nbsp;0.0 &nbsp; &nbsp; &nbsp;|<br />
| &nbsp;6 &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp;0.8025 &nbsp; | &nbsp;1.621 &nbsp; &nbsp;| -0.4898 &nbsp; | &nbsp;19.7 &nbsp; &nbsp; | &nbsp;65.34 &nbsp; &nbsp;| &nbsp;1.083e+0 | &nbsp;5.531e+0 | &nbsp;1.255e+0 | &nbsp;0.2422 &nbsp; | &nbsp;0.2336 &nbsp; | &nbsp;0.2463 &nbsp; | &nbsp;17.8 &nbsp; &nbsp; | &nbsp;5.042 &nbsp; &nbsp;|<br />
| &nbsp;7 &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp;1.726 &nbsp; &nbsp;| &nbsp;1.6 &nbsp; &nbsp; &nbsp;| -0.52 &nbsp; &nbsp; | &nbsp;15.0 &nbsp; &nbsp; | &nbsp;2.0 &nbsp; &nbsp; &nbsp;| &nbsp;1.078e+0 | &nbsp;5.45e+03 | &nbsp;1.3e+03 &nbsp;| &nbsp;0.248 &nbsp; &nbsp;| &nbsp;0.23 &nbsp; &nbsp; | &nbsp;0.248 &nbsp; &nbsp;| &nbsp;20.0 &nbsp; &nbsp; | &nbsp;10.0 &nbsp; &nbsp; |<br />
| &nbsp;8 &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp;1.722 &nbsp; &nbsp;| &nbsp;1.6 &nbsp; &nbsp; &nbsp;| -0.52 &nbsp; &nbsp; | &nbsp;15.0 &nbsp; &nbsp; | &nbsp;28.69 &nbsp; &nbsp;| &nbsp;1.089e+0 | &nbsp;5.45e+03 | &nbsp;1.3e+03 &nbsp;| &nbsp;0.248 &nbsp; &nbsp;| &nbsp;0.23 &nbsp; &nbsp; | &nbsp;0.248 &nbsp; &nbsp;| &nbsp;20.0 &nbsp; &nbsp; | &nbsp;10.0 &nbsp; &nbsp; |<br />
| &nbsp;9 &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp;1.714 &nbsp; &nbsp;| &nbsp;1.6 &nbsp; &nbsp; &nbsp;| -0.52 &nbsp; &nbsp; | &nbsp;15.0 &nbsp; &nbsp; | &nbsp;12.54 &nbsp; &nbsp;| &nbsp;1.089e+0 | &nbsp;5.481e+0 | &nbsp;1.3e+03 &nbsp;| &nbsp;0.248 &nbsp; &nbsp;| &nbsp;0.23 &nbsp; &nbsp; | &nbsp;0.248 &nbsp; &nbsp;| &nbsp;20.0 &nbsp; &nbsp; | &nbsp;10.0 &nbsp; &nbsp; |<br />
| &nbsp;10 &nbsp; &nbsp; &nbsp; | &nbsp;0.4702 &nbsp; | &nbsp;1.85 &nbsp; &nbsp; | -0.42 &nbsp; &nbsp; | &nbsp;15.0 &nbsp; &nbsp; | &nbsp;26.14 &nbsp; &nbsp;| &nbsp;1.054e+0 | &nbsp;5.47e+03 | &nbsp;1.3e+03 &nbsp;| &nbsp;0.248 &nbsp; &nbsp;| &nbsp;0.23 &nbsp; &nbsp; | &nbsp;0.24 &nbsp; &nbsp; | &nbsp;10.0 &nbsp; &nbsp; | &nbsp;0.0 &nbsp; &nbsp; &nbsp;|<br />
| &nbsp;11 &nbsp; &nbsp; &nbsp; | &nbsp;1.714 &nbsp; &nbsp;| &nbsp;1.6 &nbsp; &nbsp; &nbsp;| -0.52 &nbsp; &nbsp; | &nbsp;15.0 &nbsp; &nbsp; | &nbsp;48.43 &nbsp; &nbsp;| &nbsp;1.1e+03 &nbsp;| &nbsp;5.479e+0 | &nbsp;1.3e+03 &nbsp;| &nbsp;0.248 &nbsp; &nbsp;| &nbsp;0.23 &nbsp; &nbsp; | &nbsp;0.248 &nbsp; &nbsp;| &nbsp;20.0 &nbsp; &nbsp; | &nbsp;10.0 &nbsp; &nbsp; |<br />
| &nbsp;12 &nbsp; &nbsp; &nbsp; | &nbsp;1.722 &nbsp; &nbsp;| &nbsp;1.6 &nbsp; &nbsp; &nbsp;| -0.52 &nbsp; &nbsp; | &nbsp;15.0 &nbsp; &nbsp; | &nbsp;78.01 &nbsp; &nbsp;| &nbsp;1.1e+03 &nbsp;| &nbsp;5.45e+03 | &nbsp;1.3e+03 &nbsp;| &nbsp;0.248 &nbsp; &nbsp;| &nbsp;0.23 &nbsp; &nbsp; | &nbsp;0.248 &nbsp; &nbsp;| &nbsp;20.0 &nbsp; &nbsp; | &nbsp;10.0 &nbsp; &nbsp; |<br />
| &nbsp;13 &nbsp; &nbsp; &nbsp; | &nbsp;1.548 &nbsp; &nbsp;| &nbsp;1.6 &nbsp; &nbsp; &nbsp;| -0.52 &nbsp; &nbsp; | &nbsp;15.0 &nbsp; &nbsp; | &nbsp;80.0 &nbsp; &nbsp; | &nbsp;1.1e+03 &nbsp;| &nbsp;5.45e+03 | &nbsp;1.256e+0 | &nbsp;0.248 &nbsp; &nbsp;| &nbsp;0.23 &nbsp; &nbsp; | &nbsp;0.248 &nbsp; &nbsp;| &nbsp;20.0 &nbsp; &nbsp; | &nbsp;10.0 &nbsp; &nbsp; |<br />
=========================================================================================================================================================================<br />
-----(mgh2.gin) (iter No. 7)<br />
opti conp prop phon inten noden dispersion<br />
cell<br />
4.5119 4.5119 3.0157 90.0 90.0 90.0<br />
frac<br />
Mg core &nbsp;0.000000 &nbsp; 0.000000 &nbsp; 0.500000 &nbsp;1.6<br />
H &nbsp;core &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 &nbsp;-0.52<br />
H &nbsp;shel &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 &nbsp;-0.28<br />
space<br />
136<br />
buck<br />
H shel Mg core 1078.0 0.248 &nbsp;20.0 0.0 12.800<br />
buck<br />
H shel H &nbsp;shel 5450.0 0.23 &nbsp;10.0 0.0 12.800<br />
buck<br />
H core Mg core 1300.0 0.248 &nbsp;15.0 0.0 12.800<br />
spring<br />
0 2.0 0<br />
dispersion 1 500<br />
0.0 0.0 0.0 to 0.0 0.5 0.0 to 0.5 0.5 0.0 to 0.0 0.0 0.0 to 0.0 0.0 0.5<br />
output phon mgh2<br />
-----<br />
2. ~/gulp-5.1/Src/gulp &lt; mgh2.gin | tee mgh2.got<br />
3. gnuplot<br />
&nbsp; set xzeroaxis<br />
&nbsp; set yrange[-50:1500]<br />
&nbsp; set arrow from 100,-50 to 100,1500 nohead<br />
&nbsp; set arrow from 200,-50 to 200,1500 nohead<br />
&nbsp; set arrow from 300,-50 to 300,1500 nohead<br />
&nbsp; set arrow from 400,-50 to 400,1500 nohead<br />
&nbsp; plot &quot;mgh2.disp&quot; w p pt 7 ps 0.1<br />
4. q<br />
5. gnuplot<br />
&nbsp; plot &quot;mgh2.dens&quot; w i<br />
6. q<br />
※ Gamma - X - M - Gamma - Z - R - A<br />
&nbsp; 0.0 0.0 0.0 to 0.0 0.5 0.0 to 0.5 0.5 0.0 to 0.0 0.0 0.0 to 0.0 0.0 0.5 to 0.0 0.5 0.5 to 0.5 0.5 0.5<br />
□ Raman (MgH2)<br />
----------<br />
opti conp prop phon inten noden raman<br />
cell<br />
4.5119 4.5119 3.0157 90.0 90.0 90.0<br />
frac<br />
Mg core &nbsp;0.000000 &nbsp; 0.000000 &nbsp; 0.500000 &nbsp;1.6<br />
H &nbsp;core &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 &nbsp;-0.52<br />
H &nbsp;shel &nbsp;0.195920 &nbsp; 0.195920 &nbsp; 0.000000 &nbsp;-0.28<br />
space<br />
136<br />
rdirection 1.0 1.0 1.0 &nbsp;1.0 -0.5 1.0<br />
buck<br />
H shel Mg core 1078.0 0.248 &nbsp;20.0 0.0 12.800<br />
buck<br />
H shel H &nbsp;shel 5450.0 0.23 &nbsp;10.0 0.0 12.800<br />
buck<br />
H core Mg core 1300.0 0.248 &nbsp;15.0 0.0 12.800<br />
spring<br />
0 2.0 0<br />
----------<br />
&nbsp; Frequencies (cm-1) and IR/Raman Intensities :<br />
<br />
&nbsp; Frequency &nbsp; &nbsp; &nbsp;-0.0000 &nbsp; -0.0000 &nbsp; &nbsp;0.0000 &nbsp;255.5466 &nbsp;306.8523 &nbsp;368.9511<br />
&nbsp; IR Intensity &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0925<br />
&nbsp; &nbsp; &nbsp;in X &nbsp; &nbsp; &nbsp; &nbsp; 0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0086<br />
&nbsp; &nbsp; &nbsp;in Y &nbsp; &nbsp; &nbsp; &nbsp; 0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0839<br />
&nbsp; &nbsp; &nbsp;in Z &nbsp; &nbsp; &nbsp; &nbsp; 0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000<br />
&nbsp; Raman Intsty &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0016 &nbsp; &nbsp;0.0000<br />
<br />
&nbsp; Frequency &nbsp; &nbsp; 368.9511 &nbsp;645.8834 &nbsp;645.8834 &nbsp;924.4431 &nbsp;982.8417 &nbsp;988.5978<br />
&nbsp; IR Intensity &nbsp; &nbsp;0.0925 &nbsp; &nbsp;0.9358 &nbsp; &nbsp;0.9358 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;1.5903 &nbsp; &nbsp;0.0000<br />
&nbsp; &nbsp; &nbsp;in X &nbsp; &nbsp; &nbsp; &nbsp; 0.0839 &nbsp; &nbsp;0.1710 &nbsp; &nbsp;0.7649 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000<br />
&nbsp; &nbsp; &nbsp;in Y &nbsp; &nbsp; &nbsp; &nbsp; 0.0086 &nbsp; &nbsp;0.7649 &nbsp; &nbsp;0.1710 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000<br />
&nbsp; &nbsp; &nbsp;in Z &nbsp; &nbsp; &nbsp; &nbsp; 0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;1.5903 &nbsp; &nbsp;0.0000<br />
&nbsp; Raman Intsty &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;6.8076<br />
<br />
&nbsp; Frequency &nbsp; &nbsp; 988.5978 1101.4659 1197.6891 1197.6891 1200.9463 1437.7299<br />
&nbsp; IR Intensity &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.5973 &nbsp; &nbsp;0.5973 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000<br />
&nbsp; &nbsp; &nbsp;in X &nbsp; &nbsp; &nbsp; &nbsp; 0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.2259 &nbsp; &nbsp;0.3714 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000<br />
&nbsp; &nbsp; &nbsp;in Y &nbsp; &nbsp; &nbsp; &nbsp; 0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.3714 &nbsp; &nbsp;0.2259 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000<br />
&nbsp; &nbsp; &nbsp;in Z &nbsp; &nbsp; &nbsp; &nbsp; 0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000<br />
&nbsp; Raman Intsty &nbsp; 23.2860 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; &nbsp;0.0000 &nbsp; 14.1517 &nbsp; &nbsp;0.6678<br />
---------(Myabe)<br />
・B1g: 306.8523<br />
・Eg : 988.5978<br />
・Eg : 988.5978<br />
・A1g: 1200.9463<br />
・B2g: 1437.7299<br />
---------(Myabe)<br />
・B1g<br />
rdirection 1.0 1.0 0.0 &nbsp;1.0 -1.0 0.0<br />
・Eg<br />
rdirection 0.0 1.0 1.0 &nbsp;0.0 1.0 1.0<br />
rdirection 1.0 0.0 1.0 &nbsp;1.0 0.0 1.0<br />
・A1g<br />
rdirection 1.0 1.0 1.0 &nbsp;1.0 1.0 1.0<br />
・B2g<br />
rdirection 1.0 1.0 0.0 &nbsp;1.0 1.0 0.0<br />
------------------------------------------------------------------------------<br />
◆ BFGS<br />
<br />
□ L-BFGS-B<br />
0. wget http://users.iems.northwestern.edu/~nocedal/Software/Lbfgsb.3.0.tar.gz<br />
1. tar zxvf Lbfgsb.3.0.tar.gz<br />
2. cd Lbfgsb.3.0<br />
3. make<br />
[B1] http://users.iems.northwestern.edu/~nocedal/lbfgsb.html<br />
[B2] http://hackage.haskell.org/package/l-bfgs-b<br />
<br />
□ libLBFGS: a library of Limited-memory Broyden-Fletcher-Goldfarb-Shanno (L-BFGS)&nbsp;<br />
0. wget http://users.iems.northwestern.edu/~nocedal/Software/lbfgs_um.tar.gz<br />
1. tar zxvf lbfgs_um.tar.gz<br />
2. cd lbfgs_um<br />
3. sed -i 's/f77/gfortran -O2/g' makefile<br />
4. make<br />
[B3] http://www.chokkan.org/software/liblbfgs/<br />
[B4] http://users.iems.northwestern.edu/~nocedal/lbfgs.html<br />
------------------------------------------------------------------------------