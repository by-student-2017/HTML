　ここでは、第一原理計算における理論の学習の仕方を説明する。<br />
　生物・化学系と機械・材料・物理系（特に置換による材料開発）などでは求められる計算精度が異なるので学習の効率化のためにお薦めする方法を分けた。<br />
※ 機械系で潤滑油などを研究している場合は生物・化学系に近いこともある。<br />
------------------------------------------------------------------------------<br />
1)『電子構造論による化学の探究』での「付録Aの理論的背景」を読む<br />
　これで分子軌道法は十分である。もう少しプログラミングまで踏み込みたい場合は、京都大名誉教授の足立裕彦先生が書かれた書籍を読み込むと良い。<br />
<br />
2) 計算精度と密度汎関数法の理解<br />
・（生物・化学系の方）山口兆ら『錯体化学会選書10 金属錯体の量子・計算化学』三共出版 を読む<br />
・（機械・材料・物理系の方）『固体の中の電子』で密度汎関数の記述の部分を読む<br />
　これで密度汎関数の理解はLDAからGGA、PBEまで具体的に理解が出来る。この本は、第一原理計算をしていて、何か気になった場合に、その都度、読み込んでいけば良い。さらに密度汎関数法が気になる場合は、文献[<a href="http://rare-events.org/tsuneda/Kyoto-text.pdf">http://rare-events.org/tsuneda/Kyoto-text.pdf</a>&nbsp;（常田貴夫「<span id="btAsinTitle">密度汎関数法の基礎」KS物理専門書 </span>）や<a href="http://www.tddft.org/TDDFT2014/school/Burke2.pdf">http://www.tddft.org/TDDFT2014/school/Burke2.pdf</a>]を参照<br />
<br />
3. 実習を含めた理解<br />
A)&nbsp;講習を受けに行く（可能であればこちらを選択する方がよい）<br />
・（物理系の方）『分子軌道法の場合はDVX&alpha;研究会の「夏の学校」に参加<br />
　分子軌道法を理解したい場合は『DV-X&alpha;法による電子状態計算 -そのプログラムと解説-』を読むと良い<br />
・（物理系の方）KKR及びバンド計算の場合はCMD（主に大阪大学で開催）に参加<br />
　KKRやバンド計算をFortranでプログラミングする場合の詳細がよく分かるようになる<br />
B) 自習する<br />
・（生物・化学系の方）武次徹也『新版 すぐできる 量子化学計算 ビギナーズマニュアル』KS化学専門書<br />
・（生物系の方）長岡正隆『すぐできる 分子シミュレーション ビギナーズマニュアル』KS化学専門書<br />
　片岡氏のwebサイト（<a href="http://www.mcmd.ne.jp/md/">http://www.mcmd.ne.jp/md/</a>）も有名です。&nbsp;<br />
・（生物・生命系の方）佐藤文俊ら『プログラムで実践する 生体分子量子化学計算 ProteinDF/ABINIT-MPの基礎と応用』森北出版<br />
・（生物・生命系の方）中野達也ら『フラグメント分子軌道法入門 ― ABNIT-MPによるタンパク質の非経験的量子化学計算』アドバンスドソフト<br />
・（物理系の方）足立裕彦ら『はじめての電子状態計算』三共出版<br />
・（機械・材料・物理系の方）泉聡志ら『機械・材料設計に生かす 実践分子動力学シミュレーション』森北出版<br />
<br />
4) AbinitやWIEN2kなどのマニュアル類や説明を読む<br />
<br />
5)　上記でまだ分からないことがあれば下記のHPを参照する<br />
A. 中山先生の<a href="http://homepage3.nifty.com/mnakayama/research/tips/qm.htm">http://homepage3.nifty.com/mnakayama/research/tips/qm.htm</a>&nbsp;の概要を参照<br />
　その他は、実際に計算する場合に気になったところを読んでいけば良い<br />
B. ノーベル賞を受賞したホーエンベルンとコーンの理論を理解したければ、<br />
　尾形先生の<a href="http://www-tph.cheme.kyoto-u.ac.jp/c/ms2007/note/ogata2/chap2_DFT.pdf">http://www-tph.cheme.kyoto-u.ac.jp/c/ms2007/note/ogata2/chap2_DFT.pdf</a>&nbsp;を参照<br />
C. スピン軌道相互作用： <a href="http://202.11.2.126/iwaya/ryoushi/h19/12-2.pdf">http://202.11.2.126/iwaya/ryoushi/h19/12-2.pdf</a><br />
D. 『バンド理論―物質科学の基礎として 』でさらに詳細に密度汎関数法を理解（これはかなり理解が難しい）<br />
E. 日野理『実践　量子化学計算プログラミング―アドバンスソフトシミュレーションシリーズ［2］』アドバンスソフトを読めば、具体的な励起状態計算のプログラミング方法が理解できるようになる。<br />
F.&nbsp;擬ポテンシャル法：平面波の係数とそのエネルギーを得るために対角化してそれらを計算するのではなく、共役勾配法（ Conjugate Gradient Method&nbsp;: CG法 ）を用いて最もエネルギーが低くなる平面波の係数を探す問題に変えて高速化している。通常の対角化計算&rarr;最急降下法&rarr;共役勾配法 の順に計算速度が速くなる。下記では擬ポテンシャル作成コード atomの記述もある。<br />
･ <a href="http://www.cmp.sanken.osaka-u.ac.jp/~koun/o2knano/docs/user.pdf">http://www.cmp.sanken.osaka-u.ac.jp/~koun/o2knano/docs/user.pdf</a><br />
･ <a href="http://www.cmp.sanken.osaka-u.ac.jp/~koun/o2knano/docs/user2.pdf">http://www.cmp.sanken.osaka-u.ac.jp/~koun/o2knano/docs/user2.pdf</a>　<br />
･ <a href="http://www.cmp.sanken.osaka-u.ac.jp/~koun/o2knano/docs/user3.pdf">http://www.cmp.sanken.osaka-u.ac.jp/~koun/o2knano/docs/user3.pdf</a>&nbsp;<br />
･ <a href="http://rmp.aps.org/abstract/RMP/v64/i4/p1045_1">http://rmp.aps.org/abstract/RMP/v64/i4/p1045_1</a><br />
･&nbsp;<a href="http://flex.phys.tohoku.ac.jp/riron/ronbun/m04mesa.pdf">http://flex.phys.tohoku.ac.jp/riron/ronbun/m04mesa.pdf</a><br />
G. KKR法： 下記を参照するのが良いだろう。英語版の方が記述が豊富な場合もあるのでチェックしておくと良い（KKRは全電子計算法なのでMCDなどの計算も可能である）。<br />
･ <a href="http://pmt.sakura.ne.jp/wiki/index.php?title=Main_Page">http://pmt.sakura.ne.jp/wiki/index.php?title=Main_Page</a>&nbsp;での Doument for AkaiKKR<br />
･ <a href="http://kkr.phys.sci.osaka-u.ac.jp/jp/document.cgi">http://kkr.phys.sci.osaka-u.ac.jp/jp/document.cgi</a>, <a href="http://www.dyn.ap.eng.osaka-u.ac.jp/CMD/CMD4/CMD4_TEXT/CMD4_MACHIKANEYAMA2000_1.pdf">http://www.dyn.ap.eng.osaka-u.ac.jp/CMD/CMD4/CMD4_TEXT/CMD4_MACHIKANEYAMA2000_1.pdf</a><br />
･ <a href="http://olymp.cup.uni-muenchen.de/index.php?option=com_remository&amp;Itemid=20&amp;func=startdown&amp;id=51&amp;lang=en">http://olymp.cup.uni-muenchen.de/index.php?option=com_remository&amp;Itemid=20&amp;func=startdown&amp;id=51&amp;lang=en</a><br />
･ <a href="http://repo.lib.hosei.ac.jp/bitstream/10114/3486/1/07R6108_%E6%B5%A6%E5%B1%B1%E6%81%92%E5%A4%AA%E9%83%8E.pdf">http://repo.lib.hosei.ac.jp/bitstream/10114/3486/1/07R6108_%E6%B5%A6%E5%B1%B1%E6%81%92%E5%A4%AA%E9%83%8E.pdf</a><br />
H. 笠井秀明ら『計算機マテリアルデザイン入門』大阪大学出版会<br />
　かなりレベルが高いががんばって読み込んで欲しい。<br />
I. 白井先生 <a href="http://www.cmp.sanken.osaka-u.ac.jp/~koun/">http://www.cmp.sanken.osaka-u.ac.jp/~koun/</a> にある講義資料を読んでみる。<br />
・ 密度汎関数理論： <a href="http://www.cmp.sanken.osaka-u.ac.jp/~koun/Lecs/dft.pdf">http://www.cmp.sanken.osaka-u.ac.jp/~koun/Lecs/dft.pdf</a><br />
・ <a href="http://www.cmp.sanken.osaka-u.ac.jp/~koun/Lecs/var_main.pdf">http://www.cmp.sanken.osaka-u.ac.jp/~koun/Lecs/var_main.pdf</a><br />
・ 講義資料： <a href="http://www.cmp.sanken.osaka-u.ac.jp/~koun/Lecs/Material_Design13.pdf">http://www.cmp.sanken.osaka-u.ac.jp/~koun/Lecs/Material_Design13.pdf</a><br />
J. 赤井久純ら『マテリアルデザインへの応用』シュプリンがー・ジャパン<br />
　かなりレベルが高いががんばって読み込んで欲しい。<br />
K. <a href="http://rare-events.org/tsuneda/Kyoto-text.pdf">http://rare-events.org/tsuneda/Kyoto-text.pdf</a> （必要な情報が纏められている）<br />
L.&nbsp; 上記で理解が出来なかった場合は『物質の電子状態 上』と『物質の電子状態 下』や『Electronic Structure - Basic Theory and Practical Methods』（Richard M. Martin Cambridge University Press）、藤原毅夫『固体電子構造論』内田老鶴圃を参照する。<br />
<br />
その他：<br />
全体の理解に役立つ： <a href="http://ci.nii.ac.jp/els/110007161500.pdf?id=ART0009115362&amp;type=pdf&amp;lang=jp&amp;host=cinii&amp;order_no=&amp;ppv_type=0&amp;lang_sw=&amp;no=1378024711&amp;cp">http://ci.nii.ac.jp/els/110007161500.pdf?id=ART0009115362&amp;type=pdf&amp;lang=jp&amp;host=cinii&amp;order_no=&amp;ppv_type=0&amp;lang_sw=&amp;no=1378024711&amp;cp</a>=<br />
個別の計算問題： <a href="https://www.jstage.jst.go.jp/browse/jsssj/28/3/_contents/-char/ja/">https://www.jstage.jst.go.jp/browse/jsssj/28/3/_contents/-char/ja/</a><br />
<a href="https://www.jstage.jst.go.jp/article/jsssj/28/3/28_3_129/_pdf">https://www.jstage.jst.go.jp/article/jsssj/28/3/28_3_129/_pdf</a><br />
<a href="https://www.jstage.jst.go.jp/article/jsssj/28/3/28_3_135/_pdf">https://www.jstage.jst.go.jp/article/jsssj/28/3/28_3_135/_pdf</a><br />
<a href="https://www.jstage.jst.go.jp/article/jsssj/28/3/28_3_144/_pdf">https://www.jstage.jst.go.jp/article/jsssj/28/3/28_3_144/_pdf</a><br />
<a href="https://www.jstage.jst.go.jp/article/jsssj/28/3/28_3_150/_pdf">https://www.jstage.jst.go.jp/article/jsssj/28/3/28_3_150/_pdf</a><br />
<a href="https://www.jstage.jst.go.jp/article/jsssj/28/3/28_3_160/_pdf">https://www.jstage.jst.go.jp/article/jsssj/28/3/28_3_160/_pdf</a><br />
-----------------------------------------------------------------------<br />
□&nbsp;一点計算（全エネルギー計算）[1]<br />
　一つの構造を固定したエネルギー計算<br />
<br />
□ Born-Oppenheimer(BO)近似（断熱近似）の妥当性 [1]<br />
　BO近似は、安定分子に関する限り、非常によい近似になっている。電子の質量をm、考えている分子の原子核の代表的な質量をMとすると、BO近似の誤差は次式のオーダーとなる。<br />
　(m/M)<sup>6/4</sup><br />
つまり、単純な質量比で想定されるより、はるかによい近似になっている。この事実は記憶に値する。この評価は、BornとOppenheimerの原論文で展開されている摂動論の解析によって得られた。<br />
<br />
□&nbsp;CCSD(T) [1]<br />
・cc-pCVQZ以上では、1 kacl/mol誤差内の化学的精度が期待できる（簡単な閉殻分子からなる等電子対化学反応熱に対する平均絶対誤差の規定関数依存性）。<br />
・原子化エネルギーに対する正規分布関数を見ると、CCSD(T)-F12法では2 kJ/molの精度で原子化エネルギーを計算することが可能である。<br />
・化学的精度（数 kcal/molのオーダー）[2]<br />
<br />
□ 結合の種類と形成要因。エネルギー範囲の単位はkcal/mol（=0.04337 eV）。Tは運動エネルギー [2]
<table border="1" cellpadding="1" cellspacing="1" style="width: 557.13px;">
	<tbody>
		<tr>
			<td style="width: 131.72px; text-align: center;">種類</td>
			<td style="width: 246.72px; text-align: center;">形成要因</td>
			<td style="width: 77.27px; text-align: center;">エネルギー範囲</td>
			<td style="width: 85.27px; text-align: center;">&nbsp;</td>
		</tr>
		<tr>
			<td style="width: 131.72px; text-align: center;">化学結合</td>
			<td style="width: 246.72px; text-align: center;">&nbsp;</td>
			<td style="width: 77.27px; text-align: center;">&nbsp;</td>
			<td style="width: 85.27px; text-align: center;">&nbsp;</td>
		</tr>
		<tr>
			<td style="width: 131.72px; text-align: center;">共有結合</td>
			<td style="width: 246.72px; text-align: center;">軌道混成によるT減少</td>
			<td style="width: 77.27px; text-align: center;">50 - 200</td>
			<td style="width: 85.27px; text-align: center;">H-H</td>
		</tr>
		<tr>
			<td style="width: 131.72px; text-align: center;">配位結合</td>
			<td style="width: 246.72px; text-align: center;">軌道混成によるT減少（と分子間力）</td>
			<td style="width: 77.27px; text-align: center;">1 - 100</td>
			<td style="width: 85.27px; text-align: center;">Mg<sup>2+</sup>(H<sub>2</sub>O)<sub>6</sub></td>
		</tr>
		<tr>
			<td style="width: 131.72px; text-align: center;">イオン結合</td>
			<td style="width: 246.72px; text-align: center;">電荷間の静電相互作用</td>
			<td style="width: 77.27px; text-align: center;">10 - 100</td>
			<td style="width: 85.27px; text-align: center;">Na<sup>+</sup>Cl<sup>-</sup></td>
		</tr>
		<tr>
			<td style="width: 131.72px; text-align: center;">金属結合</td>
			<td style="width: 246.72px; text-align: center;">軌道混成+擬縮退効果によるT減少</td>
			<td style="width: 77.27px; text-align: center;">1 - 20</td>
			<td style="width: 85.27px; text-align: center;">-Fe-Fe-</td>
		</tr>
		<tr>
			<td style="width: 131.72px; text-align: center;">水素結合</td>
			<td style="width: 246.72px; text-align: center;">1電子移動励起配置混合によるT減少</td>
			<td style="width: 77.27px; text-align: center;">1 - 10</td>
			<td style="width: 85.27px; text-align: center;">(H<sub><font size="2">2</font></sub>O<sub><font size="2">2</font></sub>)<sub><font size="2">2</font></sub></td>
		</tr>
		<tr>
			<td style="width: 131.72px; text-align: center;">分子間力</td>
			<td style="width: 246.72px; text-align: center;">&nbsp;</td>
			<td style="width: 77.27px; text-align: center;">&nbsp;</td>
			<td style="width: 85.27px; text-align: center;">&nbsp;</td>
		</tr>
		<tr>
			<td style="width: 131.72px; text-align: center;">イオン・双極子</td>
			<td style="width: 246.72px; text-align: center;">電荷・分極の静電相互作用</td>
			<td style="width: 77.27px; text-align: center;">1 - 15</td>
			<td style="width: 85.27px; text-align: center;">Na<sup><font size="2">+</font></sup>・H<sub>2</sub>O</td>
		</tr>
		<tr>
			<td style="width: 131.72px; text-align: center;">イオン・誘起双極子</td>
			<td style="width: 246.72px; text-align: center;">電荷・励起分極の静電相互作用</td>
			<td style="width: 77.27px; text-align: center;">0.1 - 1</td>
			<td style="width: 85.27px; text-align: center;">Na<sup>+</sup>・C<sub>6</sub>H<sub>6</sub></td>
		</tr>
		<tr>
			<td style="width: 131.72px; text-align: center;">分散力</td>
			<td style="width: 246.72px; text-align: center;">励起分極・励起分極の静電相互作用</td>
			<td style="width: 77.27px; text-align: center;">0.1 - 10</td>
			<td style="width: 85.27px; text-align: center;">Ar-Ar</td>
		</tr>
		<tr>
			<td style="width: 131.72px; text-align: center;">双極子・双極子</td>
			<td style="width: 246.72px; text-align: center;">分極・分極の静電相互作用</td>
			<td style="width: 77.27px; text-align: center;">0.1 - 4</td>
			<td style="width: 85.27px; text-align: center;">SO<sub>2</sub>-SO<sub>2</sub></td>
		</tr>
		<tr>
			<td style="width: 131.72px; text-align: center;">双極子・誘起双極子</td>
			<td style="width: 246.72px; text-align: center;">分極・励起分極の静電相互作用</td>
			<td style="width: 77.27px; text-align: center;">0.1 - 1</td>
			<td style="width: 85.27px; text-align: center;">HCl・C<sub>6</sub>H<sub>6</sub></td>
		</tr>
		<tr>
			<td style="width: 131.72px; text-align: center;">疎水効果</td>
			<td style="width: 246.72px; text-align: center;">&nbsp;</td>
			<td style="width: 77.27px; text-align: center;">&nbsp;</td>
			<td style="width: 85.27px; text-align: center;">&nbsp;</td>
		</tr>
		<tr>
			<td style="width: 131.72px; text-align: center;">疎水結合</td>
			<td style="width: 246.72px; text-align: center;">エントロピーによる統計力学的安定性</td>
			<td style="width: 77.27px; text-align: center;">&lt; 3</td>
			<td style="width: 85.27px;">タンパク質間</td>
		</tr>
	</tbody>
</table>
<br />
□ 時間スケール [1]<br />
・アト秒（10<sup>-18</sup>秒）：電子の運動<br />
・フェムト秒（10<sup>-15</sup>秒）：分子の振動<br />
　水のような分子は10<sup>-14</sup>秒ぐらいで1回振動する<br />
・フェムト秒から十ピコ秒：溶液らしい性質が現われる時間スケール<br />
　温度が下がると運動時間スケールは100ピコ秒程度から数百ナノ秒まで一気に遅くなる<br />
　ATPを合成するという化学反応のダイナミクス自体はフェムト秒の振動がきっかけになる<br />
・100ナノ秒：水素結合の組み替え運動（-40℃くらいまで凍らない過冷却状態）<br />
　分子内や分子間の振動は温度にあまり依存しないが、クラスタリングや水素結合の組み替えは温度に依存する<br />
　単純な系でも、温度を変えると運動の空間スケールや時間スケールが変わり、特異な熱力学的な性質が生まれることがある<br />
・マイクロ秒：酵素反応における酵素の構造変化<br />
・ミリ秒から秒：タンパク質の動き（メカニカルな運動）<br />
　タンパク質やDNAのような高分子は、基本的に長さに依存して、どんどん遅い時間スケールで運動するようになる。おそらく、タンパク質が高分子であるという特性が遅さに影響を与えているのでしょう<br />
　単純な系でも、温度を変えると運動の空間スケールや時間スケールが変わり、特異な熱力学的な性質が生まれることがある<br />
<br />
□ 信頼度（2014年近辺）[1]<br />
　大きな分子に対して、何をもって信頼とするか。方法論的には、第一原理に基づいていて、電子状態理論の立場からいうと、信頼度はあります。ただ、やはり、大きな分子になってくると、ゆらぎのような効果や温度が重要になる。そういったものは、電子状態の立場からは取り込めていない。そういう意味で、信頼度はそこに依存してくるでしょう。<br />
<br />
[1] 日本化学会『巨大分子系の計算化学』化学同人<br />
[2] 山口兆ら『錯体化学会選書10 金属錯体の量子・計算化学』三共出版<br />
※ 2012年の様子を見ると、DFT（構造最適化）&rarr; cc-pCVQZ(or cc-pVQZ)以上の基底関数 + CCSD(T)（一点計算）が良いようだ。計算結果が化学的精度に近づいてきている。<br />
※ ansatz（経験的推論、または、仮説と上記などの書籍で訳される）<br />
-----------------------------------------------------------------------<br />
■ 圧力による相転移<br />
<br />
　このような議論で基本的に重要な量として、体積&Omega;と温度Tを独立変数とする自由エネルギーF(&Omega;,T)=E(&Omega;,T) - TS(&Omega;,T), あるいは圧力Pと温度Tを独立変数とするGibbsの自由エネルギーG(P,T)=H(P,T) - TS(P,T)がある。<br />
　エンタルピーHは、<br />
　H = E + P&Omega;<br />
で与えられる。温度T=0では、圧力一定で構造が安定な条件はエンタルピーが最小であることである。<br />
　E(&Omega;)を計算し、２つの相それぞれのE(&Omega;)曲線の共通接線をGibbsの方法で引けば、その傾きがこの２つの相の間の相転移を引き起こす圧力を与える。<br />
<br />
R.M.マーチンら「物質の電子状態（上）」丸善<br />
-----------------------------------------------------------------------<br />
■ 弾性：応力とひずみの関係<br />
<br />
　例えば、縦軸を応力/ひずみ=t<sub>11</sub>/&eta;<sub>11</sub>、横軸をひずみ&eta;<sub>11</sub>とした図で、線の傾きから弾性定数が求められる。非線形な変化分は非線形定数を決める。<br />
　非線形ひずみに対してはLagrangeの応力ひずみを使えば線形の普通の表式に還元されるので、最も便利である。<br />
　線形の弾性定数は多くの材料について計算されていて、その値は一般に実験値と非常によく一致しており、ずれは大体5-10%である。非線形定数については測定がずっと難しくなるので、理論値は予測値に過ぎない場合が多い。<br />
<br />
R.M.マーチンら「物質の電子状態（上）」丸善<br />
-----------------------------------------------------------------------<br />
■ フォノンと変位型相転移<br />
　理論と実験の周波数の一致の程度は通常は約5%以内である。<br />
<br />
◇ 凍結フォノン（フローズンフォノン）法<br />
　原子の位置の関数として全エネルギーを直接計算する方法。これは「凍結フォノン」法と呼ばれることも多い。<br />
「凍結フォノン」という言葉は、核が位置｛RI｝に凍結されているという仮定の下で全エネルギーや力を計算する直接的な方法を意味している。<br />
　この方法は他の問題の場合とまったく同じ計算手法が使えるという大きい利点がある。例えば、同じプログラムで（ほんの少し異なった入力をするだけで）フォノンの分散曲線、表面と界面の構造などその他の多くの特性を計算できる。<br />
<br />
◇ 応答関数法（またはDFPT）<br />
　エネルギーの任意の次数の導関数を陽に計算する。これは「応答関数」または「Green関数」法と呼ばれている。<br />
　応答関数を使った方法とは、平衡位置からの変位のべきで展開することにより力の定数を計算するという方法を意味する。この方法の大きい利点は、実験で測定可能であり、1960年代に定式化された応答関数の理論に基づいていることにある。最近の発展により式の表現が計算に非常に使いやすい形になり、現在ではフォノンの分散曲線の計算はごく普通にできるようになった。<br />
　遷移金属については実験との一致はそれほど良くない。同様の結果が多くの材料について見られるが、実験の周波数に関して5%以内で一致している。<br />
　応答関数法は、誘電関数、有効電荷、電子-フォノン行列要素、等々の計算には特に効率が良い。<br />
　全ての調和振動子の力の定数、弾性定数、等々はエネルギーの２次微分のみを含んでおり、２次の摂動論を使えばこれら全てが求められるからである。さらに、このことは、多くの場合、全エネルギーそのものよりも小さい変化の方がより正確に計算できるという事実にも基づいている。<br />
<br />
R.M.マーチンら「物質の電子状態（上）」丸善<br />
-----------------------------------------------------------------------<br />
■ 電気伝導度と光学的性質<br />
<br />
　誘電関数と電気伝導度は凝縮物質物理では最も重要な応答関数である。なぜならこの２つは物質の光学的性質、電気伝導、および多くの技術的応用を決めるものだからである。また、光学スペクトルは電子励起を研究する際に最も広く使われている測定手段であろう。<br />
　分極性あるいは導電性の物質が存在する場合のMaxellの方程式の現象論的定式化は周波数に依存する複素誘電関数または複素電気伝導度を使って行われる。半導体GaAsの光学スペクトルでは、厳密交換であるEXXや電子-正孔相互作用を取り入れた「GW」準粒子で実験とよい一致を示す。<br />
　さらに、２粒子を扱うBethe-Salpeter方程式（BSE）を解いて電子-正孔相互作用を取り込んだものは、全体としてずっとよく実験と一致するようになっている。<br />
　電子-正孔相互作用の効果は、GaF<sub>2</sub>のような広いバンドギャップを持つ物質ではさらに大きくなる。この場合には定性的な変化が生じ、吸収の大部分は束縛された励起子状態の方に移る。同様の結果がLiFや他の広いバンドギャップを持つ絶縁体についても見られている。<br />
　電子数が変わらない場合の励起スペクトルの計算には、時間依存密度汎関数（TDDFT）と呼ばれる方法がある。<br />
　これは時間依存シュレーディンガー方程式に従って、原理的にはn(t)の厳密な解を与える。この方法は近似的交換相関汎関数と共に使われ、分子やクラスターのような小さな系の光学スペクトルや固体中の磁気励起に対してはかなりの成功を収めている。<br />
<br />
R.M.マーチンら「物質の電子状態（上）」丸善<br />
-----------------------------------------------------------------------<br />
■ 結晶における分極の計算<br />
<br />
　分極の計算例としては、有効電荷を考えるのが適切である。というのは、実験では光学フォノンの縦モードと横モードの振動数の分離から有効電荷を測定できるので、理論の結果と比較できるからである。<br />
　例えば、いくつかのグループが、強誘電体への転移を示すBaTiO3などのペロブスカイトで異常有効電荷を算出している。このような物質には、いくつかの赤外（IR）活性モードがあり、すべてのIRモードはお互いに相互作用をして混ざっているので、実験から直接原子の個々の有効電荷を決めることは不可能である。<br />
　これらの結果は、理論的モデルから格子動力学についての情報を使ってのみいろいろな原子からの寄与に分解できる。これとは逆に、非経験的計算では、原子の有効電荷と振動モードが決められ、固有モードの有効電荷が直接計算され、実験と比較できる。計算結果によれば、これらのIRモードは強く混ざっており、その結果最低の横光学（TO）モードは最高の縦光学（LO）モードと最も密接に結びついており、そのモードの有効電荷を非常に大きくしている。すなわち、強誘電相転移において結晶をソフトにするフォノンである。ペロブスカイト構造のBサイトの原子と、その原子に向かう線に沿って動いているO原子の異常に大きい有効電荷は共有結合の結果であると解釈されている。<br />
　線形応答法を使っても、本質的には同じ結果が得られている。しかし、Berry位相法は強誘電状態でも発現する有限の分極に直接適用できるという利点がある。<br />
　線形と非線形の感受率の計算例では、Wannier関数とBloch軌道間の変換及び[2n+1]定理を使って行われる。<br />
<br />
※[2n+1]定理とは、0からn次までのすべての次数に対する波動関数が分かっていれば2n+1次までのエネルギーが求められるというものである。<br />
<br />
R. M. マーチンら「物質の電子状態（下）」丸善<br />
-----------------------------------------------------------------------<br />
■ 自発分極<br />
<br />
　自発分極は反転対称の中心がない結晶ではどの結晶にでも起きる。<br />
<br />
R. M. マーチンら「物質の電子状態（下）」丸善<br />
-----------------------------------------------------------------------<br />
■ 実空間での計算法<br />
<br />
　密度の計算において既に指摘したように、多くの演算は実空間で行った方が簡単である。例えば、もし&psi;(R)がグリッド上で具体的に分かっていれば、n(r)=&Sigma;｜&psi;(R)｜<sup>2</sup>の計算には平面波法で必要であったFFTなどは必要がない。HartreeポテンシャルはFFT法でも実空間多重グリッド法でも求めることができ、後者は高度に最適化されている。ポアソン方程式とシュレーディンガー方程式の解を求めるには実空間での方法は有限な系に対しては特に有利である。有限な系では波動関数は境界の外では消え、クーロンポテンシャルは一般には周期的境界条件には従わないからである。<br />
　実空間での計算によるKohn-Sham方程式の解はフーリエ変換が不必要であるということ以外は平面波の場合と同じ形式になる。<br />
<br />
R.M.マーチンら「物質の電子状態（下）」丸善<br />
-----------------------------------------------------------------------<br />
■ DFPT(勉強不足なので誤っているところがあるかもしれません)<br />
<br />
　調和振動子近似の範囲内では、周波数&omega;の振動モードは変位<br />
　u<sub>i</sub>(t) = R<sub>i</sub>(t) - R<sub>0i</sub>(t) &equiv; u<sub>i</sub>*exp(i*&omega;*t)<br />
によって記述でき、それを使えば下記の古典的連立運動方程式<br />
　M<sub>i</sub>*&part;<sup>2</sup>Ri/&part;t<sup>2</sup> = F<sub>i</sub>(R) = -&part;E(R)/&part;R<sub>i</sub><br />
に対して、<br />
　-&omega;<sup>2</sup>*M<sub>i</sub>*u<sub>i</sub> = -&Sigma;(&part;E(R)/(&part;R<sub>i</sub>&part;R<sub>j</sub>))<br />
となる。全振動状態に対する解は、各々が周波数&omega;を持つ独立な振動子の集合であり、古典的方程式<br />
　det｜(&part;E(R)/(&part;R<sub>i</sub>&part;R<sub>j</sub>))/&radic;(M<sub>i</sub>M<sub>j</sub>)-&omega;<sup>2</sup>｜=0<br />
によって決められる。ここで、質量M<sub>i</sub>とM<sub>j</sub>に対する依存性は対称的な形で入っている。<br />
　&part;E(R)/(&part;R<sub>i</sub>&part;R<sub>j</sub>) = &part;E<sub>ij</sub>(R)/(&part;R<sub>i</sub>&part;R<sub>j</sub>) + &int;((&part;<sup>2</sup>V<sub>ext</sub>(r)/(&part;R<sub>i</sub>&part;R<sub>j</sub>))*n(r))dr + &int;((n(r)/&part;R<sub>i</sub>)*(&part;V<sub>ext</sub>(r)/&part;R<sub>j</sub>))dr<br />
右辺の最初の2項は無摂動の密度のみを含んでいる。しかし、最後の項では(n(r)/&part;R<sub>i</sub>)の情報が必要である。<br />
<br />
　任意の周期的外部摂動&Delta;V<sub>ext</sub>(r)に対する応答の計算用のDFPTアルゴリズムは、(n(r)/&part;R<sub>i</sub>)で用いられる&Delta;&psi;を得るために1次の摂動論より得られる式、さらに、その式の中で用いられる&Delta;V、(n(r)/&part;R<sub>i</sub>)の3つからなる連立方程式を解くことである。<br />
　DFPT方程式は、与えられた波数ベクトル、例えば、フォノンの波数ベクトルで、ブロッホの定理に従う原子変位（の固有ベクトル）を持つ摂動のある結晶の場合には、驚くほど簡単になる。<br />
<br />
　これらの計算は、効率の良い平面波法では標準的な高速フーリエ変換を使って行うことができる。<br />
<br />
R.M.マーチンら「物質の電子状態（上）」丸善<br />
-----------------------------------------------------------------------<br />
■ 開殻原子：非球対称ポテンシャル<br />
<br />
「開殻」という用語はスピンが対をなさず、あるいは、与えられた角運動量lの状態m=-l, ...,lが完全には詰まっていない場合を指す。従って分類をするのであれば与えられた全角運動量J={j,m<sub>j</sub>}を持つ多重項で行うのが良い。ここでJは空間（L={l,m<sub>j</sub>}）とスピン(S={s,m<sub>s</sub>})の一次結合である。一般には複数の行列式でできた波動関数を扱わねばならない。たとえ外部ポテンシャル（原子では核のポテンシャル）が球対称であっても、有効独立粒子ポテンシャルVeff(r)は軌道の占有状態に依存するので球対称ではない。簡単化できることといえば量子化軸を選んでポテンシャルVeff(r)=Veff(r,&Theta;)が軸対称性を持つようにすることぐらいである。幸いなことに、Slaterの方法は対称性を使って適切な多重項を選ぶことにより、必要な計算すべてを動径方向だけの計算に簡約する仕方を示している。このような対処の仕方に一般的な法則はないが、いろいろな場合を集めたものが文献の付録に載っている。原子の中ではVeffは完全に動径のみの関数Veff(r)が、あるいは円筒座標の関数Veff(r,&Theta;)の場合のみを考えればよい。開殻問題に対しては、以下のような精度の異なるいろいろな近似がある。<br />
・制限付き：問題を球対称（球対称ではない項にについては角度平均をとってVeff(r)とする）、<br />
かつスピンによらない（スピン状態について平均をとり、軌道が各スピンについて同じになるようにする）として扱う。<br />
これは閉殻、スピン=0の系、に対しては正しい形式であり、注意深く扱えば開殻に対する近似と見なすこともできる。<br />
・スピン非制限：球対称であるがポテンシャルと軌道はスピンに依存するとして扱う。これは殻が半分占有され、<br />
スピンが最大値をとり、各スピンが別々に閉殻構造をとっているときに正しい式である。<br />
・非制限：問題をそのまま扱う。そこでは全mlとmsのみが良い量子数である。この場合にはSlaterの方法を使って問題を簡単化することができる。<br />
<br />
◇開殻構造に対する方程式<br />
　完全に非制限の場合には、電子-電子相互作用項のために一段と複雑になる。軸を選んで密度n(r,&Theta;)とポテンシャルVxc(r,&Theta;)が軸対称となるようにする。Kohn-Sham法においては、波動関数は球面調和関数で展開される。また、Vxc(r)とn(r)の関数が非線形であるため、Vxc(r,&Theta;)の球面調和関数による展開においてLにはカットオフの最大値が存在しないので、Vxc(r,&Theta;)の角度積分は数値的に行わなければならない。さらに、Coulombポテンシャルは多重極モーメントを持ち、Poisson方程式の解は球対称の場合のようには簡単ではない。開殻構造の場合には、Hartree-Fock方程式の方が、交換項が球面調和関数の有限な和で展開できるため、実際には簡単である。電子-電子相互作用の行列要素を計算するためには球面調和関数を使ったよく知られた展開を使うことができ、それはr1とr2を含む項に因数分解される。<br />
　角度の積分は解析的に行うことができ、Gaunt係数が出てくる。これは文献に具体的な式が与えられている。<br />
　動径方向のHartree-Fock方程式は動径関数に関するエネルギーの汎関数微分から出てくる。<br />
　Hartreeポテンシャルのlimi成分をGaunt係数とGlebsch-Gordan係数の関係式を使って表すことができる。同様に、状態ni,li,mi,&sigma;iに作用する交換ポテンシャルも表すことができる。<br />
<br />
◇相対論的Dirac方程式とスピン軌道相互作用<br />
　重い原子では相対論的効果を無視することはできない。幸い、この効果は内殻の深いところで生じるので、相対論的方程式は球対称と仮定して解くことができる。その結果は分子や固体において本質的な修正なしに使うことができる。固体や分子に関する実際の計算では、相対論的効果は補強法（補強法ではこの計算は1個の原子の場合と等価である）の中に直接に、<br />
あるいは別の方法、例えば擬ポテンシャルの中に間接的に、取り込むことができる。相対論的効果は原子の相対論の計算結果を使って擬ポテンシャルを作ることにより、擬ポテンシャルの中に組み込むことができる。そして、非相対論のシュレーディンガー方程式の中でこの擬ポテンシャルを使えば、相対論的効果を含んだ価電子状態を求めることができる。<br />
<br />
R. M. マーチンら「物質の電子状態（上）」丸善<br />
-----------------------------------------------------------------------<br />
■ Chebyshev多項式<br />
<br />
Taylor級数は、変数のべきによる展開である。<br />
　f(x) &rarr; c<sub>0</sub> + c<sub>1</sub>*x + c<sub>2</sub>*x<sup>2</sup> + ... + c<sub>N</sub>*x<sup>M</sup><br />
フェルミ演算子の展開の式で必要とされているような演算子の展開を使い利点は、引き続いて出てくる各項がx<sup>n+1</sup>=x*x<sup>n</sup>を順に行えば簡単に得られることである。しかし、高次のべきでは不安定性の問題が出てくることがあり、xが大きくなるにつれ収束は悪くなる。一方、第1種のChebyshev多項式T<sub>n</sub>(x)は、領域[-1,+1]で直交するように定義されているため、この領域上では、どんな関数でもT<sub>n</sub>(x)の線形結合として一意に展開することができる。さらに、この展開をすると、その全領域で関数f(x)の近似展開の誤差の絶対値の最大値が最小になるという性質があり、さらにその多項式は再帰的に計算することができるという特性がある。多項式は、最初の2項と他の項を表す漸化式<br />
　T<sub>0</sub>(x)=1, T<sub>1</sub>(x)=x, T<sub>n+1</sub>(x)=2*x*T<sub>n</sub>(x)-T<sub>n-1</sub>(x)<br />
を定義することで表現できる。最終的な展開式は<br />
　f(x) &rarr; c<sub>0</sub>/2 + &sum;(C<sub>n</sub>*T<sub>n</sub>(x))<br />
と書ける。最初の数項を導出し、その直交性を示すのは簡単な演習問題となる。<br />
　Chebyshev展開法は、もし基底の集合が小さければ、例えばNbasisがNより2桁大きい程度の強束縛モデルであれば、非常に効率の良い方法である。しかし、限界のないスペクトルに対してはうまくいかない。というのは、多項式展開は、スペクトルの幅が広ければそれだけ高次までとらなければならないからである。典型的な平面波計算では、エネルギー領域が広く、かつN<sub>basis</sub>≫Nなので、高次のべきが必要になる。<br />
<br />
◇密度行列の逆べき展開<br />
　高エネルギーで適切に収束する演算子を使い、限界のないスペクトルを扱う方法がいくつかある。その1つは逆べき法でありそれは本質的にはGreen関数法であり、リカージョン法と密接に関係している。まずFermi関数を次式のように展開する。<br />
　F[H] = 1/(1+exp[&beta;*[H-&mu;]]) &rarr; &sum;(&omega;i/[H-zi])<br />
経路積分について良く知られた関係式を使えば、実軸上の極についての和は、複素平面上の極を囲む積分に変換できる。複素平面上のziに極を持つ各項に対して、逆演算子G<sub>i</sub>(z<sub>i</sub>)は、1次方程式(H-z<sub>i</sub>)G<sub>i</sub>(z<sub>i</sub>)=Iを基底を使って解くことにより求められる。実空間の基底関数を使えば、演算子G<sub>i</sub>(z<sub>i</sub>)は大きい複素数ziに対してはより局在化しており、このことは計算には都合が良い。その最大の範囲は経路が実軸と公差するところである。絶縁体における経路積分を精確に記述するために必要な極の数はM<sub>pole</sub>&prop;(&mu;-E<sub>min</sub>)/E<sub>gap</sub>である。金属ではギャップがなく、実軸付近の積分の正確な計算には間隔がTに比例するより密な極の分布が必要である。この方法の利点は、べき展開とは異なって、高いエネルギースペクトルとは無関係に常に収束することである。多重散乱Green関数計算のなどに使われている。<br />
※ Chebyshev多項式展開は、全エネルギーや状態密度のような示量性の量の統計的な見積もりを求めるためにランダムなベクトルと共に使うこともできる。これは「最大エントロピー」法あるいはこれに関連した方法である。この方法は対角和をとることができないような非常に大きい行列に対しては有効である。<br />
※ Fermi分布関数を、超幾何関数を使って収束の早い連分数展開で表すことが可能である。<br />
<br />
R. M. マーチンら「物質の電子状態（上）」丸善<br />
-----------------------------------------------------------------------<br />
■ 数値計算法<br />
　下記の方法は、波動関数の反復法による改善（反復的対角化）、Kohn-Sham自己無撞着ループにおける電荷密度の更新、および構造緩和における原子の変位の計算に主として使われている。問題の規模や性質は多様であるので、それぞれに応じてより適した方法がある。<br />
<br />
◇ 数値積分とNumerov法<br />
　物理学において特別重要な役割を演じる２次微分方程式の例であり、この他の例としてはKohn-Sham方程式やHartree-Fock方程式の自己無撞着解を求める際に解かねばならないPoisson方程式などがある。これらの方程式はグリッド上で離散化し、２次微分に対する数値的近似を使って積分できる。効率の良い方法は、原点からは外向きに、無限大からは内向きに、接合点まで方程式を積分するNumerovのアルゴリズムである。その解は波動関数とその微分がある選ばれた半径Rcで一致するという条件によって与えられる。波動関数の振幅は一致するように調整できるので（全体の振幅は規格化によって決められる）、実際には&phi;の対数微分を表す比が一致すればよい。<br />
　誤差がh<sup>6</sup>オーダーの方法がNumerov法として知られている。<br />
　Numerov法の基礎にある考え方はどの次元にも拡張可能であり、そのグリッド点の作る図形は「Mehrstellen」と呼ばれている。要点は、微分方程式そのものを使い、もとの差分方程式より高い次数で成り立つ運動エネルギーとポテンシャルエネルギーに対する表式を見つけることである。<br />
<br />
◇ 最急降下(SD)法<br />
　最急降下方向を目的とする関数Fに対する微分で得るために、SD法では各ステップの始点では直線探索の方向は関数の等高線と直交する。この方法は「（Zeno）ゼノンのパラドックス」の具体例であり、厳密に最小値に到達することはない。<br />
　SD法は、もし関数Fが変数ごとに異なる依存性を示し、その結果、最小点の周囲で細長く長い谷を作るような場合には、特に悪い方法である。<br />
<br />
◇ 共役勾配法<br />
　驚くべきことに思えるかもしれないが、いつも「下り坂」の最急降下方向に従って進むよりも、最小点に速く到達する方法がある。最初のステップの後では、その点での勾配だけでなく、その前の点での値と勾配も得ている。この付加情報を使えば、直線探索によってより低いエネルギーに導くためのより適切な方向を選ぶことができる。事実、N次元の２次汎関数に対しては、共役勾配（CG）法を使えばNステップで最小値に到達することが保証される。<br />
　CG法はもっと複雑な汎関数（例えば、Kohn-Sham汎関数など）にも適用でき、汎関数は最小値の近傍で２次形式であるので、多くの利点が期待される。２次形式ではない問題にCG法を使うには、共役方向を定義し、該当の非線形汎関数に直線探索を行うことである。新しい勾配が現在の方向に直交するためには直線探索が済んでいなければならず、その結果、汎関数は各方向について順に最小化されることになるので、CGアルゴリズムにとっては直線探索は本質的な事柄である。<br />
<br />
◇ 準Newton-Raphson法<br />
　方程式 <strong>F</strong>(<strong>x</strong>)=<strong>x</strong> を解く問題を考える。ここで<strong>x</strong>は多次元のベクトルである。例えば、出力密度n<sub>out</sub>(<strong>r</strong>)（これは入力密度n<sub>in</sub>(r)の関数である）が入力密度n<sub>in</sub>(<strong>r</strong>)に等しいようなKohn-Sham方程式の解を求める問題である。<br />
　もし密度が<em>M</em>個の関数の集合で、n<sub>in</sub>(<strong>r</strong>)=&Sigma;<sub>k</sub><sup>M</sup><em>x</em><sup>k</sup><em>h</em><sup>k</sup>(<strong>r</strong>)、ただし、x={<em>x</em><sup>k</sup>}のように展開されていれば、この問題は厳密にF(x)=xの形となる。これは、残差のノルム｜<strong>R</strong>[<strong>x</strong>]｜の最小化問題となり、ここで、<br />
　<strong>R</strong>[<strong>x</strong>]&equiv;<strong>F</strong>(<strong>x</strong>)-<strong>x</strong><br />
である。もし<strong>R</strong>が<strong>x</strong>の線形関数であり、そのJacobi行列<br />
　<strong>J</strong>&equiv;&part;<strong>R</strong>/&part;<strong>x</strong><br />
がわかっている領域を扱うのであれば、残差を最小化する準Newton-Raphson法が使用できる。<br />
　ステップiでの<strong>x</strong><sub>i</sub>を扱うと、次の反復で<strong>R</strong><sub>i+1</sub>=0となる値は、<br />
　<strong>x</strong><sub>i+1</sub>=<strong>x</strong><sub>i</sub>-<strong>J</strong><sup>-1</sup><strong>R</strong><sub>i</sub><br />
である。<br />
　問題は、一般的にはJacobi行列は未知であり（あるいは逆をとることが困難であり）、関数空間（Krylovの部分空間）において解に至るまで反復するという他の方法に頼らねばならないことである。<br />
<br />
◇ PulayのDIIS法<br />
　DIIS(discrete inversion in the iterative subspace)法の根底にある考え方は、それまでに生成した全てのベクトルの最適な結合を使って、すなわち、全Krylov部分空間を使って、どのステップiにおいても残差を最小にすることである。それ以前の全ステップの結果から新しいベクトルの係数を求め、それを残差の式に代入すれば、各ステップiでの新しい最適ベクトルが得られる。極度に大規模な問題、例えばシュレーディンガー方程式の多くの固有ベクトルを扱うなど、に対してはベクトルの多数の集合を保存するのは不可能である。しかし、密度混合では、特に密度の少数の厄介な成分についてだけであれば、数段階前の密度は保存できる。<br />
　KresseとFurthmullerは、上記のPulayのDIIS法が修正Broyden法に密接に関係したJacobi行列の更新と等価であることを示した。さら、van LentheとPulayはDavidsonとDIISのアルゴリズムを各ステップでたった３個のベクトルを使って実行できることを示した。<br />
<br />
◇ BroydenのJacobi行列更新法<br />
　Broyden法は、反復法を使う過程で逆Jacobi行列を順次生成する方法である。修正Broyden法は１度に２つの状態のみを陽に扱うということを除けばDIIS法と似ている。この方法は広く使われている。平面波法では密度のほんの少しの厄介な成分だけをこの方法で扱えばよい。しかし、多くの計算で必要となる大きいグリッド上の電荷密度の更新などの、Jacobi行列全部の保存ができないときには役に立たない。<br />
　修正Broyden法は、VanderbiltとLouieにより提案され、Johnsonにより記憶容量が少なくて済むSrivistavaの方法の利点を取り入れるように改良された。その考え方は、引き続く２つのステップが同じ結果を出すという条件はあまりに厳しすぎるというもので、改良されたアルゴリズムでは、それ以前の反復時の情報を取り入れることができる。<br />
<br />
◇伝統的なハウスホルダー３重対角化法<br />
　伝統的なハウスホルダー３重対角化法を使ってエルミート行列のスペクトル特性を直接決定するためには、N^3でスケールされる計算量がいる。<br />
<br />
R. M. マーチンら「物質の電子状態（下）」丸善<br />
-----------------------------------------------------------------------<br />
■ 電子状態の反復計算法<br />
　エネルギーの最小化対残差の最小化、あるいは単一ベクトルの更新対部分空間全体の反復、等々。これらの方法は１つの共通の枠組みに入れることができ、そこでの重要な特性は：<br />
・行列の対角化を、反復（Krylov）部分空間におけうｒ波動関数&psi;iの反復方程式で置き換える。<br />
・波動関数（多分さらに以前の波動関数）と勾配（dE/d&psi;=H&psi;，このステップのアルゴリズムは方法により異なる）を使い新しい波動関数を求める。<br />
・平面波の場合は、密行列の乗算を高速フーリエ変換（FFT）で置き換える。<br />
<br />
◇ なぜ反復法を使うのか？<br />
　電子状態の計算は基底関数の形によって２つのグループに分けられる。LCAOやLMTOなどの方法は、サイズNbという最小基底の構築を目標にして構築されている。基底の構築に努力が払われ、そのれは問題の種類に応じて高度に最適化されることになる。非常に大きい系を除いては、ハミルトニアンは小さく、サイズN<sub>b</sub>*N<sub>b</sub>の密行列で表され、伝統的な密行列対角化という手法に適している。その場合の計算労力は、求める固有ベクトルの数をNeとすれば、Nb<sup>3</sup>またはNe*N<sub>b</sub><sup>2</sup>とスケールされる。&nbsp;一方、平面波のような一般的な基底とグリッドを使う方法では、しばしば欲しい固有状態の数よりずっと多数（N<sub>e</sub>&gt;&gt;N<sub>b</sub>）の基底関数が絡んでくる。ハミルトニアンは非常に簡単に作成され、疎にすることができる。すなわち、<br />
行列要素は主としてゼロであり、ゼロ以外の要素のみを計算したり保存したりすればよい。小規模の問題を除けば、反復法が非常に効率が良く、この場合にはN<sub>b</sub>*N<sub>b</sub>のハミルトニアンは明確に作られることはなく、計算量は、N<sub>e</sub><sup>2</sup>*N<sub>b</sub>またはN<sub>e</sub><sup>2</sup>*N<sub>b</sub>*ln(N<sub>b</sub>)でスケールされる。このような手法は、平面波法、実空間法、有限差分法、有限要素法、多重グリッド法、ウェーブレット法に適用されたとき最も成功を収めてきた。<br />
　APW, LAPW, およびPAW法はある程度この中間にあり、両者の利点をとることができるかもしれない。<br />
<br />
◇ 前処理<br />
「前処理」についての基本的な考え方は、関数の変数依存性を修正し、より等方的にすることである。つまり、異なる変数に関する曲率をより均一にすることであり、それは収束性改善の考え方そのものである。電子状態計算で遭遇する問題には、最初の定式化が非常に悪い条件になってしまっていることがしばしばある。しかし、物理的な観点から、そのような条件の改善の仕方を見つけるのは容易である。一般に、どの形式を選ぶかは問題によって異なる。<br />
<br />
◇ 反復法での（Krylovの）部分空間<br />
　反復法はある演算子Aを繰り返し適用し新しいベクトルを作ることに基づいている。<br />
（省略）<br />
　各繰り返しにおいて具体的に取り扱われるKrylov部分空間の範囲は、方法によって異なっている。Jacobiアルゴリズムのような簡単な緩和法では新しい近似固有ベクトルを前ステップの近似固有ベクトルをのみを使って求めている。これは最急降下最小化法とにている。この他のLanczos法, Davidson法, RMM-DIIS法などでは、それまでの繰り返しで発生した全部分空間を使っている。一般には非常に大きい問題では全Krylov部分空間を保持しておくのは膨大な負荷がかかる。しかし広く使われている<br />
　Lanczos法や共役勾配（CG）最小化法は全部分空間法であり、近似固有ベクトルは直前の２つの近似固有ベクトルをのみを使って求めているとしても、それ以前の全ベクトルに直交する（あるいは共役な）新しいベクトルを生成できる。従って、これらの方法は、繰り返しの各ステップで必要事項が多少増してはいるが、簡単な緩和法よりはるかに強力である。　Davidson法は、もともとは全部分空間を保持する必要があったが、CG法を使って3個のベクトルを必要とする形式に変えることもできる。<br />
<br />
◇ Lanczos法<br />
　Lanczos法は、現代の計算機を使って固有値問題を解く最初の反復法の１つであった。それは物理的な解釈や類似性を引き出す道具としては非常に単純であり、驚くほど強力である。そのアルゴリズムは自動的に直交基底（Krylovの、あるいは反復部分空間）を生成し、そこでは与えられた演算子Aは３重対角行列になる。（電子状態の問題ではA=Hであり、Hはハミルトニアンであることが多い）。大きい行列の、小さい（あるいは大きい）方からいくつかの固有エネルギーとそれらの固有ベクトルの生成にはとりわけ強力である。<br />
　最も簡単なバージョンでは、欲しい固有ベクトルの数が増加すると、数値的な丸め誤差により発生する偽りの解という「Lanczos病」に悩まされるが、これは何回かの反復ステップの後で、直交化を行えば容易に制御できる。さらに、これは連分数として定式化でき、そこからスペクトル分布のモーメントを求める強力な方法が導かれる。<br />
　各ベクトル&psi;<sub>n</sub>は帰納法で示されるように、他の全てのベクトルに直交している。<br />
　ステップMまで進めば、３重対角行列が得られ、計算時間がO(M)で、次数Mの３重対角行列の固有値を求めるための標準的なルーチンがある。そのアイディアは簡単で、多項式の再帰的集合で定義された関数の根の形で表すことができる。固有ベクトルは固有値が分かれば逆反復によって簡単に求めることができる。もし最初の基底にN個のベクトルがあれば、この３重対角行列形でハミルトニアンを生成するためにはNステップが必要である。<br />
　この方法で重要な点は、スペクトルの最小値と最大値の近くの固有値と固有ベクトルは、行列全体を生成しなくても非常に正確に決められることである。なぜ最大値と最小値のスペクトルが一番最初に生成されるかは、次のことに注意すればわかる。もし固有ベクトルの線形結合である試行ベクトル&psi;から始めたとすれば、３重対角化のための各ステップはHを演算することであり、それは試行状態の平均エネルギーからエネルギー的に最も離れた固有ベクトルの重みを増す操作である。平均エネルギーはスペクトルの中央あたりになければならないので、両端の状態は最も効率良くはじき出される。数百万の状態が係わる典型的な場合には、アルゴリズムの数ステップで、十分に高い精度で基底状態を求めることができる。<br />
　Lanczosアルゴリズムが使える方法には多くのヴァリエーションがある。例えば、再帰的関係式はサイズM*Mの行列を生成するために使用でき、それを対角化すれば欲しい状態、例えば最低の固有状態などを求めることができる。このようにして求められた状態は、次の反復のための初期ベクトルとして使用でき、望みの精度が達成されるまでこれを繰り返す。この方法はとりわけ安定であり、いくつかの状態を求めるためにまとめた形で使えば便利である。この手法はM=2のような小さいMに対しても使うことができ、多くのベクトルを保存する必要がないので、基底状態を求めるためには特に効率のよいアルゴリズムとなる。<br />
　多体問題のように極端に大きい問題では、少数の数値的な固有値を求めるためにLanczos法が広く使われており、この場合にはそれは「厳密な対角化」と同意義である。<br />
　大規模電子状態計算における最も完璧な応用例は、WangとZungerが示したもので、彼らは偽状態の発生を避ける手段を組み込んでいる。<br />
　Arnoldi法は、Gram-Schmidt法によって各ベクトル&psi;nをそれ以前のすべてのベクトルに明確に直交させるLanczos法の変形である。この方法は不安定性を除き、望みの通りの多数の固有ベクトルの計算を可能にする。この方法は非エルミート行列にも適用できる。<br />
　Lanczos法の３重対角行列形式の見事な結果は、動的相関関数のスペクトルの複素周波数zの関数として表した連分数表式である。これからリカージョン法が導かれる。<br />
<br />
補足：クリロフ（Krylov）部分空間対角化法[1]<br />
　Aとしてハミルトニアン演算子Hを採用（A&equiv;H）すれば、ランチョス・プロセスは最初に与えられたハミルトニアンを３重対角化する操作であり、３重対角化行列の大きさnが十分大きければ、生成されたクリロフ部分空間は｜i&gt;が関係する状態を十分再現するに足るだけのベクトル成分を含んでいると期待される。nが元の空間の大きさNに等しければ、すべての状態成分が含まれていると期待できる。このようにランチョス・プロセスでエルミート行列を３重対角化する方法をランチョス法という。<br />
　物理的に興味のある状態（局在軌道）|i&gt;から出発し、ランチョス・プロセスを経てハミルトニアンを対角化し（H<sup><font size="2">&Kappa;(i)</font></sup>と書く）、対応した基底{|&omega;<sub>&alpha;</sub><sup>(i)</sup>&gt;}を得る。<br />
　H<sup><font size="2">&Kappa;(i)</font></sup>|&omega;<font size="2"><sub>&alpha;</sub><sup>(i)</sup></font>&gt; = &epsilon;<sub>&alpha;</sub>|&omega;<sub><font size="2">&alpha;</font></sub>&gt;<br />
ただし、そのときの次数nは適当に選んだ小さな数である。これから密度行列は<br />
　&rho;<sup>&Kappa;(i)</sup> = &Sigma;|&omega;<sub>&alpha;</sub>&gt;&lt;&omega;<sub><font size="2">&alpha;</font></sub>|<br />
となる。これがクリロフ部分空間直接対角法である。出発の状態が上手に選択されていれば有効な手法であり、計算付加はオーダーNとなる。<br />
　グリーン関数G(E)=(E-H)<sup>-1</sup>算するオーダーN手法として知られる連分数展開もこの枠内の方法である。また、多電子系や強く相互作用するスピン系の基底状態を数値的に求める場合にもランチョス法が用いられる。<br />
※ ランチョス・プロセスを経てハミルトニアンを対角化するまではオーダーNではないじゃないかというご指摘があるかと思います。尾形先生が文献[2]のp.37で実際にどれぐらいのオーダーになるかを示してくれています。<br />
参考文献<br />
[1] 藤原毅夫「固体電子構造論」内田老鶴圃<br />
[2] <a href="https://www.slideshare.net/cms_initiative/cmsib8-n1">https://www.slideshare.net/cms_initiative/cmsib8-n1</a><br />
[3] <a href="https://www.slideshare.net/cms_initiative/cmsib8-n1-35468213?next_slideshow=1">https://www.slideshare.net/cms_initiative/cmsib8-n1-35468213?next_slideshow=1</a><br />
[4] <a href="https://www.slideshare.net/tmaehara/krylov-19503034">https://www.slideshare.net/tmaehara/krylov-19503034</a><br />
[5] <a href="https://www.slideshare.net/cms_initiative/cmsia-2015-1">https://www.slideshare.net/cms_initiative/cmsia-2015-1</a><br />
<br />
◇ Davidson法<br />
　Davidsonは、現在、電子状態問題に広く適用されている方法を考案した。その変形版は沢山ある。要点は、Davidson法はLanczos法に密接に関連しているが、演算子が対角優位な問題に対してさらに効率を高めていることである。対角優位な問題は、例えば平面波アルゴリズムにおけるように、電子状態問題ではよくあることである。<br />
　表式は摂動理論によく似ており、ハミルトニアンの対角部が優位であれば急速に収束する反復法に向いていることがわかる。<br />
<br />
◇ RMM-DIIS （部分空間での残差最小化法）<br />
　これまでに述べてきた方法（および以下で述べる最小化法）では、基底状態は大局的な最小値であるから、まったく問題なく最低状態に収束する。<br />
　より高い状態を求めるためには、Lanczos法のように暗に、または明確な直交化によって、直交性を確かなものにしなければならない。Pulayが提案した残差最小化法（RMM）ではこの条件を除き、エネルギーではなく「残差ベクトル」のノルムを最小化するので、スペクトル中で試行固有値&epsilon;に最も近い固有値を持つ状態に収束する。Pulay法はそれまでの反復で生成された全Krylov反復空間で残差を最小化するので「反復部分空間で直接に逆をとる残差最小化法（residual minimization method by direct inversion inthe iterative subspace）」、略して、RMM-DIISとして知られている。（省略）<br />
　時間のかかるステップはH&psi;の演算であり、一般にNbを基底のサイズとすれば、各固有ベクトル&psi;につきO(Nb<sup>2</sup>)の演算を必要とする行列演算である。しかし疎行列の演算に対しては、これは大きい基底の場合にはO(N<sub>b</sub>)まで減り、FFTを使えばO(N<sub>b</sub>*ln(N<sub>b</sub>))まで減る。<br />
　実際には、大きい問題では、多くのベクトルを記憶することはないので、この反復を再度進める前の数ステップのnに対する小さな行列のみを対角化している。電子状態計算におけるこの方法の運用は、WoodとZungerが初めて行い、<br />
続いて多くの研究者が種々の修正を加えて使用した。<br />
　DIIS法は部分空間サイズの行列の全要素を求めることが必要であるが、行列が小さく、その空間を張る全ベクトルが保存可能であれば効率が良い。これは2つの領域でKohn-Sham方程式を解くことで達成される。もし必要な固有状態の数が小さければ、RMM-DIISを使って即座に全状態が求められる。もし必要な固有状態の数が大きければ、問題をいくつかのエネルギー領域に分割でき、選んだエネルギーに最も近い固有値を持つ少数の状態を小さい行列方程式を解いて求めることができる。この場合には、固有状態を見逃したり、重複して数えたりしないように注意しなければならない。<br />
　共役勾配法に比べてこの方法が非常に優れているところは、他のベクトルとの直交性を明確に要請することなく、スペクトルの中央であってもどのような固有値でも求められることである。<br />
<br />
R. M. マーチンら「物質の電子状態（下）」丸善<br />
-----------------------------------------------------------------------<br />
■ 高速フーリエ変換（FFT）<br />
　逆格子空間で計算される第一原理計算コードにおいて、FFTが必要になるときとはどのようなときであろうか？<br />
　それは、逆格子空間での波動関数をフーリエ変換で実空間にし、それに有効ポテンシャルを掛け、その後に実空間から逆格子空間に戻すために逆フーリエ変換が用いられる。<br />
　こうすることによって、交換相関ポテンシャルで使われる電子密度を、実空間の電子密度&Sigma;｜&psi;i｜<sup>2</sup>で取り扱うことで計算を容易にしている。<br />
　逆格子空間でそれを行おうとすると無限大の集合を扱うことになり、厳密な取り扱いが出来なくなる。<br />
R. M. マーチンら「物質の電子状態（下）」丸善<br />
<br />
　一般に電子系の固有状態を求める際に、シュレーディンガー方程式の対角化を行えば電子数Nに対して、演算回数やメモリーの大きさがN<sup>3</sup>に比例して増大する。平面波基底を用いた第一原理計算では、波動関数を運動量空間で求め、これを高速フーリエ変換（FFT）により実空間に変換し、そこで電荷分布を求めて、それを運動量空間に逆フーリエ変換で戻すということを繰り返し、全体の計算を行う。高速フーリエ変換の計算では演算回数がM<sub>0</sub>N<sub>p</sub>log<sub>2</sub>N<sub>p</sub> &prop;N<sup>2</sup>*log<sub>2</sub>N (M<sub>0</sub>は占有軌道の数、N<sub>p</sub>は平面波基底の数）に比例する。実空間と逆格子空間を行き来するということは、効率のよい方で計算するということである。これでN<sup>3</sup>より演算回数は軽減されるが、Nを大きくするとなお急激に計算負荷が増大するのは避けられない。<br />
藤原毅夫『固体電子構造論』内田老鶴圃<br />
-----------------------------------------------------------------------<br />
■ 擬ポテンシャル<br />
<br />
◇ 転用可能性と硬さ<br />
「硬さ」という言葉には２通りの意味がある。<br />
　１つ目の意味は実空間での変化の尺度があり、それはFourier空間におけるポテンシャルの広がりで定量化される。一般に「硬い」ポテンシャルは局在した硬いイオン芯の性質を表しており、１つの物質から他の物質へ転用しやすい。ポテンシャルを「柔らかく」（すなわち、滑らかに）しようとすると転用性を悪くする傾向がある。しかし、正確で転用性があり、しかもFourier空間であまり広がらない、つまり、「最適化された」擬ポテンシャルを作るべく、現在相当な努力が払われている。<br />
　２つ目の意味は、系の環境の変化に対する応答を、擬ポテンシャルを使って適切に記述する能力の尺度である。ノルム保存は原子の電子状態がエネルギーの変化に対して正しい１次の微分を持つことを保証している。「硬さ」のこのひょうな意味はポテンシャルの変化に対する応答の忠実さの尺度である。ポテンシャルは球対称の摂動（電荷、状態、動径ポテンシャルの変化）に対して通常の球対称原子のコードを使ってテストすることができる。GoedeckerとMaschkeは内殻領域の電荷密度の応答を使って洞察力豊かな解析を行っている。これは密度が密度汎関数論の中心的な量であり、積分された密度はノルム保存の条件と深く係わっているので、当を得たことである。球対称ではない摂動を使ったテストでもまた、特に電界中の分極率に関する性能を確認している。<br />
<br />
◇ 最良の擬ポテンシャル<br />
　どのような元素に対しても唯一の最良の擬ポテンシャルというものは存在しない。あるのは沢山の「最良の選択」であって、それぞれは擬ポテンシャルを特定の使用に最適化したものである。<br />
　一般には、以下のような２つの競合する要素がある。<br />
・精度と転用性の良さを求める場合には、一般に小さな切断半径Rcとなり、「硬い」ポテンシャルを選ぶことになる。というのは、原子の近傍でできる限り波動関数を正確に記述したいからである。<br />
・擬ポテンシャルの滑らかさを重視すると、一般に大きい切断半径Rcとなり、「柔らかい」ポテンシャルを選ぶことになる。というのは、波動関数をできる限り少数の基底関数（例えば平面波）で記述したいからです。<br />
<br />
◇ ウルトラソフト擬ポテンシャル<br />
　擬ポテンシャルの１つの目標は、できる限り滑らかでしかも正確な擬波動関数を作ることである。<br />
　例えば、平面波の計算では、価電子関数がFourier成分で展開され、計算の負荷はその計算で必要なFourier成分の数のべきで増大する。従って滑らかさを最大にするということの１つの意味のある定義は、決められた精度で価電子の特性を記述するために必要なFourier空間の範囲を最小化するということである。<br />
「ノルム保存」擬ポテンシャルは、通常「滑らかさ」をある程度犠牲にして精度という目的を果たしている。これまでとは違う「ウルトラソフト擬ポテンシャル」と呼ばれる方法は、正確な計算という目標を、滑らかな関数と各イオン芯の周りの補助関数を使って問題を再表現するという変換によって達成している。この補助関数は密度が激しく変化する部分を表す。<br />
<br />
◇ 射影演算子補強波（PAW）法：全電子波動関数の使用<br />
　射影演算子補強波（PAW）法は、電子構造問題の解を求める一般的な方法であり、OPW法を再定式化して、全エネルギー、力、応力の計算の最新技術に適応させたものである。「ウルトラソフト」擬ポテンシャル法と同様に、これは射影演算子と補助局在関数を導入している。PAW法はまた全エネルギーに対する補助関数を含む汎関数を定義し、一般的な固有値方程式の解を効率良く求めるアルゴリズムの進歩を取り入れている。しかし、PAW法は、一般的なOPW表示と類似の形式で、全電子波動関数を保持しているという違いがある。全電子波動関数は核の近くで急激に変化するので、すべての積分は全空間に広がる滑らかな関数の積分と補強平面波（APW）法と同様にマフィンティン球における動径方向の積分で求められる局在した量の寄与とを組み合わせたものとして計算される。<br />
<br />
◇ OPW<br />
　価電子に対する内殻の影響を取り入れている。局在関数を上手に選べば、価電子状態に対する基底関数を滑らかな部分と局在部分に分けることができる。結晶中では滑らかな関数は平面波で表現するのが都合が良い。<br />
　内殻の状態は、分子や固体中でも原子におけるものと同じであると仮定できることも多く、これがOPW法の実際の計算における基礎になっている。<br />
　擬ポテンシャル変換の最大の利点は、擬ポテンシャルの形式的な特性と、同じ散乱特性が、違うポテンシャルからでも得られるという両方の事実を利用できることである。従って、擬ポテンシャルの一義性がないことを利用して、もとのポテンシャルより滑らかでかつ弱く選ぶことができる。たとえポテンシャルの演算子が簡単な局所ポテンシャルより複雑であったとしても、それが弱くて滑らか（すなわち、より少ないFourier成分で表現できる）であれば、論理的にも計算する上からも大変便利である。特に、波動関数は内殻の波動関数と直交していなければならないので、自由電子とは程遠いものであるにも関わらず、多くの物質で価電子バンドがほとんど自由電子に近いバンドになっているという見かけ上の矛盾<br />
を簡単に解くことができる。その理由は、バンドは弱いポテンシャルに関連する滑らかなほとんど自由電子に近い波動関するに対する永年方程式によって決まるためである。<br />
<br />
◇ 全電子波動関数の再構成<br />
　擬ポテンシャルを使った計算では、直接求められるのは擬波動関数のみである。しかし、重要な物理的性質、例えば、核磁気共鳴実験におけるKnightシフトや化学シフトなどを求めるためには全電子波動関数が必要である。これらのシフトは核の周囲の状況や価電子状態を知る非常に感度の高いプローブであるが、得られる情報は内殻状態の摂動の影響を大きく受ける。その他の実験、例えば内殻準位の光電子放出と光吸収の実験では、内殻状態が直接関わってくる。OPW法とPAW法では内殻の波動関数が求められる。ところで通常の擬ポテンシャル計算から内殻の波動関数を再現することは可能であろうか？ 答えは、ある近似の範囲内であれば可である。その手続きはPAW変換に密接に関係している。滑らかな擬関数を作るどのような「非経験的手法に対しても、分子や固体において滑らかな擬関数が計算されていれば、全電子波動関数を再構成する具体的な方法を定式化することができる。Mauriとその共同研究者たちはこのような再構成法を使って核の化学シフトを計算している。<br />
<br />
◇ 非局所Exc汎関数<br />
　Exc汎関数が、Hartree-Fockや厳密交換（EXX）のように本質的に非局所的な場合には価電子からの寄与の除去は複雑になる。一般に、非局所効果は全半径に及ぶので、擬波動関数が内殻半径の外では、ともの全電子問題の波動関数と同じになるように保つポテンシャルを作るのは不可能である。<br />
<br />
◇ 球対称境界条件<br />
　固体のいくつかの様相は原子やイオンに異なる球対称の境界条件を課すモデルでよく表現できる。その結果、価電子波動関数は原子のときよりさらに核の近くに集中するという傾向が分かっている。<br />
<br />
R. M. マーチンら「物質の電子状態（上）」丸善<br />
-----------------------------------------------------------------------<br />
■ １電子ポテンシャルの球対称近似とfull potential計算<br />
<br />
　各原子の周りのポテンシャルについては球対称性を仮定するのが広く用いられる方法である。各原子の近傍の球領域（原子球｛atomic sphere｝で1電子ポテンシャルは球対称である、という近似から出発することが多い。<br />
　エネルギーに関して高い精度が要求される場合や、任意の格子変形によるエネルギーの変化、格子振動スペクトル、電子系と原子系との相互作用の結果生じる変形（ヤーン・テラー変形）などの解析のためには、ポテンシャルや全電荷分布に対して特別の仮定を用いない計算（full potential計算）が重要になる。例えば、体積剛性率は体系に対する等方的な圧縮に対するエネルギーの上昇率であるから原子球内の電荷あるいはポテンシャルに対する球対称性の仮定は決して悪いものではない。一方、ズリ変形を考えると、まず電荷の球対称分布からの変形が起き、それによるイオンの電荷や他の電子電荷分布との間の相互作用の結果、全体としての電荷分布が平衡状態に達する。したがってズり変形による凝集エネルギーの変化を考える場合には、球対称製からのずれが本質的に重要である。<br />
<br />
藤原毅夫「固体電子構造論」内田老鶴圃<br />
-----------------------------------------------------------------------<br />
■ 線形化<br />
<br />
　波動関数をエネルギーで展開するこのような方法を線形化法と呼ぶ。<br />
　結晶のように周期性のある系では、固有値方程式を運動量空間に変換して解けばよい。<br />
　線形化マフィン・ティン軌道（LMTO）法はKKR法を線形化したということもできる。その他、APW法を線形化したLAPW法などがある。<br />
　LMTO法には様々な良い点と問題点があった。最も大きな問題は、重なった原子球(atomic sphere(AS))を用いること、またダイヤモンド構造のような空隙の多い系では空原子（empty sphere）という球を入れていかなくてはならないこと、またエネルギーに関する線形近似を使うためにエネルギーの精度が広い範囲に保障されないこと、であった。<br />
　第2世代LMTOがKKR法の立場で見ると、ASの境界で連続接続の条件がちょうど各ASから外に染み出した波動関数のtailがゼロになる条件と同等であり、これをtail cancellationの条件と呼んでいた（一言注意を加えておくと、tail calcellationの条件があるため、LMTO法をKKRの近似と捉える誤解があるが、これは限定的見方に過ぎる）。<br />
<br />
藤原毅夫「固体電子構造論」内田老鶴圃<br />
------------------------------------------------------------------------------<br />
※ JSTのWebラーニングプラザ <a href="http://weblearningplaza.jst.go.jp/"><font color="#0000ff">http://weblearningplaza.jst.go.jp/</font></a>&nbsp;はリンク先が無くなった。<br />
------------------------------------------------------------------------------