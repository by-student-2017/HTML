&nbsp; ここでは、Ubuntu 11.04 x86_64 (64 bit版)をインストールし、第一原理計算コードをセットアップするまでを解説する。（11.10はrshの設定が行い難いので研究に余裕があるときに調査する）<br />
※ 初期のIntel @ Parallel Studio 2011 SP1 ではWIEN2kの計算が途中でクラッシュするなどの事態が起こることが判明した。これはx86_64(64bit)版 Ubuntu 10.04, Ubuntu10.10だけでなくCentOS6でも確認できた。<br />
------------------------------------------------------------------------------<br />
PCの購入<br />
(※ Gigabitタイプ以上のネットワークカードが付けられると良い。オンボードでもGigabitになっていることもあるので、10Gigabit以上でなければ特にネットワークカードを購入することもない場合もある）<br />
(※ <a href="http://classic.chem.msu.su/gran/gamess/index.html">http://classic.chem.msu.su/gran/gamess/index.html</a>&nbsp;, <a href="http://www.wien2k.at/reg_user/benchmark/">http://www.wien2k.at/reg_user/benchmark/</a> で調査してみると良い）<br />
<br />
PCの構成（今回はTSUKUMOで購入。調達課の人にある程度のスペックを伝えたら、下記の構成で見積もりを送って来てくれた）<br />
※ SSDにOSを入れると、HDDは認識されていても使える状況になっていないことがある。注意して欲しい。外付けのHDDを購入して、USBで接続するのも手だろう。対処方法は「System」&rarr;「Administration」&rarr;「Disk Utility」にて、HDDを選択し、「Format Drive」を押す。ファイルのタイプはExt4で良いだろう。<br />
※ SSDは書き込み性能が低下することが知られている（■特集１　ＰＣ高速化全テクニック　Ｐａｒｔ１　タダから始める高速化 （日経WinPC, 2011/09号, 42～43ページ掲載））ため、計算で吐き出される結果はHDDに格納するようにすると良いだろう。<br />
※ WIEN2kの場合は、./userconfig_lapwの時に計算結果を格納するファイル先を指定するので、そこをHDDに指定すればよい。<br />
※ Linux OS や Intel Compiler のヴァージョンが変わることによるリスクを考えると、初学者の場合はSSDよりもHDDの方が良いかもしれない。まだまだSSDは高いので、インストールに手間取った（何度も書き込み・消去を繰り返した）私としてはHDDを選択する方が賢明だったかもしれない。<br />
1. OS: 無し<br />
&nbsp; （事務用｛Igorを用いた解析用のPC｝に転用するときにLANカードやメモリと一緒にOSを購入すれば足りる。理論計算ではLinux OS を用いるので必要無し）<br />
2. CPU: Intel Core i7-2600K<br />
&nbsp; （一番気を使う。日経のWinPCやベンチマークテストの結果などを元に選定すればよい）<br />
3. オプションCPUクーラー: Thermaltake製 ヒートパイプ式CPUクーラー<br />
4. マザーボード: Intel H67 Express チップセット Micro ATX マザーボード<br />
5. メモリ: DDR3-1333 DDR3 SDRAM 4GB &times; 2枚<br />
&nbsp; （4枚にして貰うの忘れた。後で同じメモリを2枚購入し、16GBになるように増設した）<br />
6. 追加ビデオカード: NVIDIA GeForce GTX 560 Ti / 1024 MB<br />
&nbsp; (MSI製 N560GTX-Ti Twin Frozr Ⅱ OC）　（GPUでの理論計算は対応ソフトが少ないので、今回も選定には気を使っていない）<br />
7. ハードディスク: SSD&nbsp;120GB MLC<br />
&nbsp; (intel製 510 Series / SATA 6 Gbps/ マウンタ必須）<br />
8. パーティション分割: パーティション分割無し<br />
9. 追加ハードディスク: 1TB 7200 rpm シリアルATA3 ハードディスク WD10EALX&nbsp;(SATA 6 Gbps)<br />
10. 光学ドライブ: DL対応DVDスーパーマルチ<br />
&nbsp; （LG電子製 GH24NS70 / 書き込みソフト付き / SATA接続）<br />
11. 3.5 ドライブベイ: 3.5インチベイ内蔵型カードリーダー（59in1 / CR-101）<br />
&nbsp; （使用しない。余計な機器が付いていると故障したときに対処に困るので余り嬉しくない）<br />
12. PCケース: eX.computerオリジナル MicroATXスリムタワーケースラック / EX1-7302T-S12F<br />
13. ケースオプション: 2.5インチSSD用マウンター / 3.5シャドウベイ用<br />
14. 電源ユニット: [80PLUS BRONS認証] Antec製 EA-650-GREEN （定格650W）<br />
&nbsp; （低消費電力ということで購入）<br />
15. 入力機器: 3RSET/YDKBUU02BK-M2055R<br />
------------------------------------------------------------------------------<br />
新たに購入した。備品として扱うには耐用年数や性能低下が心配だったので、10万円未満に収めた。<br />
1. OS: 無し<br />
（事務用｛Igorを用いた解析用のPC｝に転用するときにLANカードやメモリと一緒にOSを購入すれば足りる。理論計算ではLinux OS を用いるので必要無し）<br />
2. CPU: Intel Core i7-2700K<br />
（一番気を使う。日経のWinPCやベンチマークテストの結果などを元に選定すればよい）<br />
3. オプションCPUクーラー:&nbsp;ZALMAN製 ヒートパイプ式CPUクーラー<br />
4. マザーボード: Intel&nbsp;Z68 Express チップセット ATX マザーボード（ASUS製 P8Z68-V）<br />
5. メモリ: DDR3-1333 DDR3 SDRAM 4GB &times; 2枚 （SMD-4G68NG-13H）<br />
（他のPCでも使えるように同じメモリを2枚購入し、16GBになるように増設した。今回購入したボードでは、実は32GBまで搭載できるのではないかと思っているのだが、業者に聞く余裕が時間的に無かったので後で16GBにする。SMD-8G68HP-13H-D：メモリを購入する場合に、ノートPCの商品番号と間違えないように注意！）<br />
6. 追加ビデオカード: オンボードVGA（D-sub15/DVI-D/HDMI)<br />
（GPUでの理論計算は対応ソフトが少ないので、今回も選定には気を使っていない）<br />
7. ハードディスク: SSD 80GB MLC<br />
(intel製&nbsp;320 Series / SATA 6 Gbps/ マウンタ必須）<br />
8. パーティション分割: パーティション分割無し<br />
9. 追加ハードディスク: Western Digital 製 WD10EARX (1TB/SerialATAⅡ)<br />
10. 光学ドライブ: DL対応DVDスーパーマルチ<br />
（LG電子製 GH24NS70 / 書き込みソフト付き / SATA接続）<br />
11. 3.5 ドライブベイ: 3.5インチベイ内蔵型カードリーダー（59in1 / CR-101）<br />
（使用しない。余計な機器が付いていると故障したときに対処に困るので余り嬉しくない）<br />
12. PCケース: eX.computerオリジナル ATXスリムタワーケース / EX1/598TA/防塵フィルター搭載（上で購入したものよりも正面から見た幅は変わらないが、高さが25%増加、奥行きも25%増加しており、大きい印象を受けた。場所の問題はあるが、メモリの増設はし易い）<br />
13. ケースオプション: 2.5インチSSD用マウンター / 3.5シャドウベイ用<br />
14. 電源ユニット: [80PLUS BRONS認証] Topower製&nbsp;TOP-650D-B （定格650W）<br />
（低消費電力ということで購入）<br />
15. 入力機器: 無し（RealVNCの利用でマウスとキーボードは余っているので購入していない）<br />
※ CPUは上で購入したものよりも計算速度は速いはずなので、問題はSSDとHDDの性能がどうかが心配。しかし、10万円未満でこれだけの性能のPCが購入できる時代になったことに感謝。海外での労働者の賃金などの上昇で、円高の影響も薄れているとの話も聞くが、それでも円高の影響があるのだろうか？<br />
※ お上の方には、研究者が購入するPCを15～20万円程度まで消耗品扱いして頂けるようにして頂けると嬉しいです。3年程度すると陳腐化が激しいこの業界なので、購入したPCが10～20年の間、最新機器として扱えるというのであればよいのですが&hellip;&hellip;。大型計算機でも約4年に1度は設備を更新するというところもあるので、備品扱いする種類と金額をさらに合理的に細分化して頂けますと、緊急の場合に、研究結果をよりスムーズに進められるので嬉しいです。（現在はSSDやGPUがまだ高い&hellip;&hellip;。これが安くなれば&hellip;&hellip;）<br />
------------------------------------------------------------------------------<br />
並列計算のためのハブとケーブル<br />
1. Giga スイッチングハブ。BUFFALO製の5ポートタイプを購入してみた。最新鋭のLANカードでないと10G BASEにならないので、広く普及していて最速の1000Mbps（1G BASE）が対応可能なハブにした。<br />
2. LANケーブルはカテゴリー5e以後が良いとのこと。伝送帯域のHzが大きくノイズ対策が出来ている方が良さそうなので、Cat6a以後のものを選択。ここでは、奮発してCAT7を購入してみた。机の横にハブを置いて、PCを机の下や上に数台並べる場合には、ハブの位置を調節することでケーブルの長さが0.5mでも対処できたが、1m以上程度でも良かった気がした。<br />
------------------------------------------------------------------------------<br />
Ubuntu 11.04 のインストール<br />
1) google で 「riken linux」と入力して検索すると、下記のHPが得られる。<br />
&nbsp; <a href="http://ftp.riken.go.jp/Linux/">http://ftp.riken.go.jp/Linux/</a><br />
2) 「ubuntu-iso/」&rarr;「CDs-Ubuntu/」&rarr;「Ubuntu 11.04 (Natty Narwhal) 」&rarr;「ubuntu-11.04-desktop-amd64.iso」<br />
3) 「ubuntu-11.04-desktop-amd64.iso」をirvine1_3_0などでダウンロードする。<br />
4) Deep Burner (<a href="http://www.forest.impress.co.jp/lib/sys/hardcust/cddvdburn/deepburner.html">http://www.forest.impress.co.jp/lib/sys/hardcust/cddvdburn/deepburner.html</a>)などのISO形式で書き込みが可能なライティングソフトを用いて、ISO形式のOSインストールCDを作成する。<br />
------------------------------------------------------------------------------<br />
Ubuntu 11.04 の終了と再起動<br />
1) 「System」&rarr;「Shut Down...」<br />
2) 「Shut Down」を選択すれば終了。「Restart」を選択すれば再起動される。<br />
------------------------------------------------------------------------------<br />
Classic表示にしたい場合は下記のHPを参照。<br />
<a href="http://tattu1902.blog136.fc2.com/blog-entry-36.html">http://tattu1902.blog136.fc2.com/blog-entry-36.html</a><br />
------------------------------------------------------------------------------<br />
第一原理計算に必要なソフトのダウンロードⅠ（「Terminal」上）<br />
1) 「Applications」&rarr;「Accessories」&rarr;「Terminal」<br />
2) sudo apt-get install csh<br />
3) 以後、この「Terminal」で、下記のようにコマンドを入力していく。<br />
<br />
◆ gfortran の場合（業者様向け &amp; 学生様向け）<br />
1) sudo apt-get install gfortran<br />
<br />
◆ Intel Compiler をインストールする場合（学生様向け）<br />
1) sudo apt-get install g++ rpm ia32-libs<br />
2) <a href="http://packages.debian.org/stable/base/libstdc++5">http://packages.debian.org/stable/base/libstdc++5</a> から i386とamd64をダウンロード<br />
3) cd Downloads<br />
4) sudo dpkg -i libstdc++5_3.3.6-20_amd64.deb<br />
5) sudo dpkg&nbsp;-x libstdc++5_3.3.6-20_i386.deb ./<br />
6) cd /usr/lib<br />
7) sudo cp libstdc++.so.5.0.7 /usr/lib32<br />
8) cd /usr/lib32<br />
9) sudo ln -s libstdc++.so.5.0.7 libstdc++.so.5<br />
以下はDownloadsのpermissionが変わってしまって使えなくなるので、使用できるようにする方法。<br />
10) cd $home<br />
11) sudo chmod a+rw Downloads<br />
References: <a href="http://tech.ckme.co.jp/icc.shtml">http://tech.ckme.co.jp/icc.shtml</a><br />
直接命令によるパーミッションの設定: <a href="http://homepage3.nifty.com/nasunu-i/LinuxBeginner/Permission.htm">http://homepage3.nifty.com/nasunu-i/LinuxBeginner/Permission.htm</a><br />
現在調査中であるが、最新のIntel Compilerによりクラッシュや不具合が起こる可能性がある。ここでは十分に枯れた11.0をインストールする。<br />
※ 上手くダウンロードできない場合は、Download に錠前の様なマークが付いているかをチェックする。それが付いている場合は、上記の11)を行えばその記号を消せる。<br />
<br />
Compiler : l_cprof_p_11.0.084_intel64<br />
(Fortran : ifort, C : gcc )<br />
<br />
in /home/.bashrc,<br />
source /opt/intel/Compiler/11.0/084/bin/ifortvars.sh intel64<br />
source /opt/intel/Compiler/11.0/084/mkl/tools/environment/mklvarsem64t.sh intel64<br />
<br />
OpenMP<br />
1) tar -xvf WIEN2k_11.tar<br />
2) gunzip *.gz<br />
3) chmod +x ./expand_lapw<br />
4) ./expand_lapw<br />
5) ./siteconfig_lapw<br />
6) ヴァージョンに合わせてI, J, K, K1 を選択（ここでは12 のIを選択してみる）<br />
7) ifort, icc を入力<br />
8) Current settings:<br />
&nbsp; O Compiler options: -FR -mp1 -w -prec_div -pc80 -pad -align　-DINTEL_VML -traceback -axSSE4.2,SSE4.1,SSSE3,SSE3<br />
&nbsp; L Linker Flags: $(FOPT)　-L/opt/intel/Compiler/11.0/084/mkl/lib/em64t -pthread<br />
&nbsp; P Preprocessor flags &#39;-DParallel&#39;<br />
&nbsp; R R_LIB (LAPACK+BLAS): -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core -liomp5 -lpthread -openmp<br />
9) Shared Memory Architecture? (y/n): y<br />
10) Do you have MPI and Scalapack installed and......(y/n): n<br />
11)&nbsp;16GBしか搭載できないので、余裕を見て、NMATMAX=27000、NUME=2700とした。<br />
&nbsp; 計算式は以下の通り<br />
&nbsp; NMATMAX=&radic;(15 700 000 000 /10）/&radic;2=28017, NUME=NMATMAX/10=2800<br />
12) ./userconfig_lapw<br />
13) .bashrc を開いて、export OMP_NUM_THREADS= の後にスレッド数 を書き入れる。ここでは、export OMP_NUM_THREADS=4 とした。（あまり速度は上がらないが、後に export OMP_NUM_THREADS=8 とした）<br />
14) bash<br />
15) w2web<br />
<br />
（上記までは確認済み。以下は32bit版での記述。64bit版は準備中）<br />
------------------------------------------------------------------------------<br />
第一原理計算に必要なソフトのダウンロードⅡ（Compiler install）<br />
<br />
◆ Intel Compiler をインストールする場合（学生様向け）<br />
Intel Compiler<br />
1) google で 「Non-commercial Intel」と入力して検索すると、下記のHPが得られる。<br />
&nbsp;<a href="http://software.intel.com/en-us/articles/non-commercial-software-development/">http://software.intel.com/en-us/articles/non-commercial-software-development/</a><br />
2) Accept を押して、必要事項を記入する。<br />
3) Product for x86_64-bit development にチェックを入れて、Download Now を押す。（最新版で上手くいかない場合は、右下にあるversion の選択を 11.0 にすると良い）<br />
4) 必要事項を記入したときのメールアドレスに添付されている ライセンスファイルをダウンロードして、「Places」&rarr;「Home folder」の中に置く。<br />
5) 「Applications」&rarr;「System Tools」&rarr;「Terminal」 でコマンドを入力できるようにする<br />
6) tar zxvf と入力後、「Downloads」のフォルダを開いて、ダウンロードしたファイルをマウスで左クリックしながら「Terminal」 へ入れる。その後に、Enterを押す。<br />
7) 「Applications」&rarr;「System Tools」&rarr;「Terminal」<br />
8) cd と入力後、「parallel_studio_xe_2011...」のファイルを左クリックしながら「Terminal」 へ入れる。<br />
9) ./install.sh<br />
10) 「2. Install as current user to limit access to user level* 」を選択。<br />
11) 「Press &quot;Enter&quot; key to continue or &quot;q&quot; to quit: 」でEnterを入力。<br />
12) 「1. Skip prerequisites [default] 」を選択。<br />
13) 「space」 を押し続け、最後に 「accept」と入力してEnterを押す。<br />
14) 「3. I want to activate either remotely, or by using a license file, or by using a<br />
license manager」を選択。<br />
15) 「2. Use a license file」 を選択。<br />
16) 「Applications」&rarr;「System Tools」&rarr;「Terminal」 で新しく開いた「Terminal」の中に、ライセンスファイルを入れる。&#39; &#39;の中をコピーする。<br />
17) 前の「Terminal」に戻って、ペーストし、Enter を押す。<br />
18) 「Press &quot;Enter&quot; key to continue:」でEnterを押す。<br />
19) 「1. Start installation Now」を選択。<br />
20) 「Would you like to overwrite this directory? ( Yes/No ) [ Yes ] :」でEnterを押す。<br />
21) 「1. Skip prerequisites [default]」を選択。<br />
22) 「Please type a selection or press &quot;Enter&quot; to accept default choice [q]:」でqを押す。<br />
23) cd $home<br />
24) emaces .bashrc にて最後の行に下記を書き入れる（user_nameのところが人により異なる）。<br />
&nbsp; export PATH=$PATH:/opt/intel/vtune_amplifier_xe_2011<br />
&nbsp; export PATH=$PATH:/opt/intel/inspector_xe_2011<br />
&nbsp; source /opt/intel/bin/compilervars.sh intel64<br />
&nbsp; ※ version 11.0 などでは、左欄のコンパイラの設定の　Intel Fortran : を参考にすると良い。<br />
25) bash　にて変更を反映させる（再起動させてもよい）。<br />
26) ifort -v にてFortran　コンパイラの動作確認を兼ねてVersion情報を表示させる。<br />
27) icc -v にてC コンパイラの動作確認を兼ねてVersion情報を表示させる。<br />
<br />
------------------------------------------------------------------------------<br />
第一原理計算に必要なライブラリの設定Ⅰ（Parallel set up）<br />
◇ gfortran の場合（業者様向け &amp; 学生様向け）<br />
<br />
MPICH<br />
1) 「Applications」&rarr;「Ubuntu Software Center」で、右上にある検索の欄で、「MPICH」を入力して対応するソフトをインストール。<br />
または、sudo apt-get install を用いてインストール。（左欄のandLinuxを参照）<br />
<br />
MPICH2<br />
1) 「Applications」&rarr;「Ubuntu Software Center」で、右上にある検索の欄で、「MPICH2」を入力して対応するソフトをインストール。<br />
または、sudo apt-get install を用いてインストール。（左欄のandLinuxを参照）<br />
<br />
OpenMPI<br />
1) 「Applications」&rarr;「Ubuntu Software Center」で、右上にある検索の欄で、「OpenMPI」を入力して対応するソフトをインストール。<br />
または、sudo apt-get install を用いてインストール。（左欄のandLinuxを参照）<br />
<br />
LAM<br />
1) 「Applications」&rarr;「Ubuntu Software Center」で、右上にある検索の欄で、「LAM」を入力して対応するソフトをインストール。<br />
または、sudo apt-get install を用いてインストール。（左欄のandLinuxを参照）<br />
<br />
PVM<br />
1) 「Applications」&rarr;「Ubuntu Software Center」で、右上にある検索の欄で、「PVM」を入力して対応するソフトをインストール。<br />
または、sudo apt-get install を用いてインストール。（左欄のandLinuxを参照）<br />
<br />
◇ Intel Compiler をインストールする場合（学生様向け）<br />
MPICH<br />
1) googleで「mpich」と入力して検索する。下記のHPが得られる。<br />
&nbsp; <a href="http://www.mcs.anl.gov/research/projects/mpich2/">http://www.mcs.anl.gov/research/projects/mpich2/</a><br />
2) 「Downloads Page &gt;&gt;」に向かう。<br />
3) 一番下にあるMPICH-1をクリックして、ダウンロードする。<br />
4) tar zxvf と入力後、「Downloads」のフォルダを開いて、ダウンロードしたファイルをマウスで左クリックしながら「Terminal」 へ入れる。その後に、Enterを押す。<br />
5) cd と入力後、「Downloads」のフォルダを開いて、ダウンロードしたファイルをマウスで左クリックしながら「Terminal」 へ入れる。その後に、Enterを押す。<br />
6) ./configure -prefix=/usr/local/mpich -opt=-O2 -c++=icpc -cc=icc -fc=ifort -f90=ifort -f77=ifort --with-arch=LINUX<br />
7) make<br />
8) sudo make install<br />
9) 各コンパイルでのコマンドは下記のようになる。<br />
Fortran 77: /usr/local/mpich/bin/mpif77<br />
Fortran 90: /usr/local/mpich/bin/mpif90<br />
C : /usr/local/mpich/bin/mpicc<br />
※ /usr/local/ で上手くいかない場合は、/home/ユーザー名/などにしてみる。<br />
<br />
OpenMPI （インストール後は再起動すること！）<br />
1) googleで「openmpi」と入力して検索する。下記のHPが得られる。<br />
http://www.open-mpi.org/software/ompi/v1.4/<br />
2) openmpi-1.4.3.tar.gz をダウンロードする。<br />
3) tar zxvf openmpi-1.4.3.tar.gz<br />
4) cd openmpi-1.4.3<br />
5) ./configure -prefix=/usr/local/openmpi CXX=icpc CC=icc FC=ifort F90=ifort F77=ifort<br />
6) make<br />
7) sudo make all install<br />
8) 各コンパイルでのコマンドは下記のようになる。<br />
Fortran 77: /usr/local/openmpi/bin/mpif77<br />
Fortran 90: /usr/local/openmpi/bin/mpif90<br />
C : /usr/local/openmpi/bin/mpicc<br />
C++ : /usr/local/openmpi/bin/mpicxx<br />
※ /usr/local/ で上手くいかない場合は、/home/ユーザー名/などにしてみる。<br />
------------------------------------------------------------------------------<br />
並列計算を実行する前に必要なrshの設定<br />
1) 「Applications」&rarr;「Ubuntu Software Center」<br />
2) 右上にある検索の欄で、「rsh-server」を入力して対応するソフトを探す。<br />
3) 下側にインストールするソフトの候補が現れるので、それをクリックして現れる「Install」を押してインストールする。<br />
4) 右上にある検索の欄で、「rsh-client」「rsh-redone-client」を入力して、先と同様にインストールする。<br />
5) rpm -qa rsh-server, rpm -qa xinetd<br />
&nbsp; rsh-server, xinetdがインストールされていることを確認する<br />
6) sudo apt-get install sysv-rc-conf<br />
7)&nbsp;sudo sysv-rc-conf rsh on<br />
&nbsp; ブート時に rsh を自動的に起動するように設定する<br />
8)&nbsp;sudo sysv-rc-conf rlogin on<br />
&nbsp; ブート時にrloginを自動的に起動するように設定する<br />
9) /sbin/service xinetd restart<br />
&nbsp; ブート時にxinetd を自動的に起動するように設定する<br />
10) ホームディレクトリに .rhosts ファイルへ通信するマシン全てとlocalhost.localdomain を記述<br />
&nbsp; kwrite ~/.rhosts または　emacs ~/.rhosts<br />
&nbsp; localhost.localdomain<br />
&nbsp; localhost<br />
&nbsp; host1<br />
&nbsp; host2<br />
11) .rhosts のパーミッションを600にする。chmod 600 ~/.rhosts<br />
12) rsh の動作確認<br />
&nbsp; rsh localhost.localdomain hostname<br />
&nbsp; rsh localhost hostname<br />
上記の設定では、複数台のPCで動作しないので、下記のHPを参考にしながら、対策方法を探す。<br />
/etc/pam.d/rsh /etc/pam.d/rlogin の編集をまず試してみるか？<br />
もし、ファイアーウォールの設定を元に戻したければ、sudo ufw reset とすればよい。VNCは動作するようになる。<br />
参考HP :<br />
[1] <a href="http://mase.itc.nagoya-u.ac.jp/~hirano/pukiwiki/index.php?CentOS5%A4%C7rsh%A4%F2%CD%AD%B8%FA%A4%CB%A4%B9%A4%EB">http://mase.itc.nagoya-u.ac.jp/~hirano/pukiwiki/index.php?CentOS5%A4%C7rsh%A4%F2%CD%AD%B8%FA%A4%CB%A4%B9%A4%EB</a><br />
[2] <a href="https://forums.ubuntulinux.jp/viewtopic.php?id=12631">https://forums.ubuntulinux.jp/viewtopic.php?id=12631</a><br />
[3] <a href="https://wiki.ubuntulinux.jp/UbuntuTips/DedicatedServer/Ufw">https://wiki.ubuntulinux.jp/UbuntuTips/DedicatedServer/Ufw</a><br />
[4] <a href="http://static.s59.xrea.com/pukiwiki/index.php?Ubuntu%A4%C7%CE%CC%BB%D2%B2%BD%B3%D8%B7%D7%BB%BB%A4%F2%BB%CF%A4%E1%A4%EB(2">http://static.s59.xrea.com/pukiwiki/index.php?Ubuntu%A4%C7%CE%CC%BB%D2%B2%BD%B3%D8%B7%D7%BB%BB%A4%F2%BB%CF%A4%E1%A4%EB(2</a>)<br />
[5] <a href="http://www.proton.jp/main/unix/rsh.html">http://www.proton.jp/main/unix/rsh.html</a><br />
------------------------------------------------------------------------------<br />
hosts<br />
localhost.localdomain cpu=2<br />
localhost cpu=4<br />
host1<br />
host2<br />
------------------------------------------------------------------------------<br />
並列計算を実行する前に必要な .mpd.conf の設定<br />
ホームフォルダでの設定　（PWscfで必要）<br />
1) mpd &amp;<br />
2) cd $HOME<br />
3) touch .mpd.conf<br />
4) chmod 600 .mpd.conf<br />
5) emacs .mpd.conf で下記を書き入れる。*****はPCにより異なると思う。<br />
&nbsp;&nbsp; MPD_SECRETWORD=*****<br />
6) mpd &amp;<br />
------------------------------------------------------------------------------<br />
第一原理計算に必要なライブラリの設定Ⅱ（Library set up）<br />
◆ gfortran の場合（業者様向け &amp; 学生様向け）<br />
<br />
A) 「Applications」&rarr;「Ubuntu Software Center」で、右上にある検索の欄で、下記の項目を入力して対応するソフトをインストール。<br />
1) 「build-essential」<br />
2) 「libblas-dev」<br />
3) 「liblapack-dev」<br />
4) 「fftw2」<br />
5) 「fftw-dev」<br />
6) 「libfftw3-3」<br />
7) 「libfftw3-dev」<br />
<br />
◇ 並列化<br />
1) 「blacs」 ※ -test 付いたものはインストールしなくてよい<br />
2) 「scalapack」　※ -test 付いたものはインストールしなくてよい<br />
B) 「Applications」&rarr;「Accessories」&rarr;「Terminal」<br />
1) sudo apt-get install build-essential<br />
2) sudo apt-get install libblas-dev<br />
3) sudo apt-get install liblapack-dev<br />
4) sudo apt-get install fftw2<br />
5) sudo apt-get install fftw-dev<br />
6) sudo apt-get install libfftw3-3<br />
7) sudo apt-get install libfftw3-dev<br />
<br />
◇ 並列化<br />
1) sudo apt-get install libblacs-mpi1<br />
2) sudo apt-get install libblacs-mpi-dev<br />
3) sudo apt-get install libscalapack-mpi1<br />
4) sudo apt-get install libscalapack-mpi-dev<br />
<br />
PVM<br />
1) sudo apt-get install blacs1-pvm<br />
2) sudo apt-get install blacs-pvm-dev<br />
3) sudo apt-get install libscalapack-pvm1<br />
4) sudo apt-get install libscalapack-pvm-dev<br />
<br />
最速の設定を目指す場合はGotoBLASやATLASでScalapackを作成する<br />
<br />
FFT: 左欄の「ライブラリの設定」を参照<br />
BLACS: 左欄の「ライブラリの設定」を参照<br />
ScaLapack: 左欄の「ライブラリの設定」を参照<br />
<br />
◆ Intel Compiler をインストールする場合（学生様向け）<br />
◇ 並列化<br />
FFT: 左欄の「ライブラリの設定」を参照<br />
BLACS: 左欄の「ライブラリの設定」を参照<br />
ScaLapack: 左欄の「ライブラリの設定」を参照<br />
<br />
付録：MKL FFTW3（Phase のインストールマニュアルを参考）<br />
1) cd opt/intel/Compiler/11.0/084/mkl/interfaces/fftw3xf<br />
2) make libem64t<br />
3) ライブラリファイルのlibfftw3xf_intel.a は /opt/intel/Compiler/11.0/084/mkl/lib/em64t にある。<br />
※ 管理者権限が必要ないところにインストールすると上手く動作している。mkl を home にコピーしてコンパイルしてみるとよい。home に mkl をコピーした場合は、下記のようになる。<br />
fftw3 (fftw2についてもほぼ同様に行える）<br />
1) cd /home/mkl/interfaces/fftw3xf<br />
2) make libem64t<br />
2) cd /home/mkl/lib/em64t<br />
3) sudo mv libfftw3xf_intel.a /opt/intel/Compiler/11.0/084/mkl/lib/em64t<br />
以下、blas95 と lapack95 についても記述する。<br />
blas95<br />
1) cd /home/mkl/interfaces/blas95<br />
2) make libem64t<br />
2) cd /home/mkl/lib/em64t<br />
3) sudo mv libmkl_blas95.a /opt/intel/Compiler/11.0/084/mkl/lib/em64t<br />
4) sudo mv mkl95_blas.mod /opt/intel/Compiler/11.0/084/mkl/lib/em64t<br />
5) sudo mv mkl77_blas.mod /opt/intel/Compiler/11.0/084/mkl/lib/em64t<br />
lapack95<br />
1) cd /home/mkl/interfaces/lapack95<br />
2) make libem64t<br />
2) cd /home/mkl/lib/em64t<br />
3) sudo mv libmkl_lapack95.a /opt/intel/Compiler/11.0/084/mkl/lib/em64t<br />
4) sudo mv mkl95_lapack.mod /opt/intel/Compiler/11.0/084/mkl/lib/em64t<br />
5) sudo mv mkl77_lapack.mod /opt/intel/Compiler/11.0/084/mkl/lib/em64t<br />
6) sudo mv mkl77_lapack1.mod /opt/intel/Compiler/11.0/084/mkl/lib/em64t<br />
7) sudo mv mkl95_precision.mod /opt/intel/Compiler/11.0/084/mkl/lib/em64t<br />
<br />
<a href="http://tsubame.gsic.titech.ac.jp/docs/guides/tsubame2/html/programming.html">http://tsubame.gsic.titech.ac.jp/docs/guides/tsubame2/html/programming.html</a><br />
------------------------------------------------------------------------------<br />
並列計算を実行する前に必要なOpenMPに関する設定（Intel Compiler 利用の場合）<br />
◆ OpenMPを使用する場合は .bashrc へ下記の入力が必要<br />
export OMP_NUM_THREADS=8 （スレッド数を入力。左記の例では8スレッド）<br />
export OMP_STACKSIZE=12M （Intel側からの推奨。動作しない場合は値を変えてみる）<br />
※ 上記は再調査中。<br />
------------------------------------------------------------------------------<br />
※ ABINIT や PWscf などは 再度コンパイルする前に、 make clean を行う必要がある。<br />
------------------------------------------------------------------------------<br />
第一原理計算のセットアップ PWscf<br />
( 最新版を確認したが、expresso-4.3.2 では&nbsp;--with-internal-fftw が無いので除く。エラーが出る場合は FFT_LIBS のオプションを用いてライブラリの場所を指定する)<br />
◆ gfortran の場合（業者様向け &amp; 学生様向け）<br />
大規模計算用（調査中）<br />
1) tar zxvf expresso-4.3.2.tar.gz<br />
2) cd expresso-4.3.2<br />
3) export CXX=&quot;g++ -m64&quot;<br />
&nbsp;&nbsp;&nbsp; export CC=&quot;gcc -m64&quot;<br />
&nbsp;&nbsp;&nbsp; export FC=&quot;gfortran -m64&quot;<br />
&nbsp;&nbsp;&nbsp; export F77=&quot;gfortran -m64&quot;<br />
&nbsp;&nbsp;&nbsp; export F90=&quot;gfortran -m64&quot;<br />
4) ./configure CXX=g++ CC=gcc FC=gfortran F77=gfortran F90=gfortran --with-internal-blas --with-internal-lapack FFT_LIBS=&quot;-L/usr/lib -lfftw3&quot;<br />
5) make all<br />
<br />
◇ 並列化<br />
MPICH2 version 1.2.1<br />
1) tar zxvf expresso-4.3.2.tar.gz<br />
2) cd expresso-4.3.2<br />
3) ./configure MPIF90=/usr/local/openmpi/bin/mpif90 CXX=g++ CC=gcc FC=gfortran F77=gfortran F90=gfortran BLAS_LIBS=&quot;-L/usr/lib -lblas&quot; LAPACK_LIBS=&quot;-L/usr/lib -llapack&quot; FFT_LIBS=&quot;-L/usr/lib -lfftw3&quot;<br />
4) make all<br />
実行方法<br />
mpirun -machinefile /home/*/hosts -np 2 /home/*/espresso-4.3.2/bin/pw.x &lt;atom.in&gt; atom.out にて計算が成功する。<br />
<br />
◇ 並列化<br />
OpenMP（調査中）<br />
1) tar zxvf expresso-4.3.2.tar.gz<br />
2) cd expresso-4.3.2<br />
3) ./configure CXX=g++ CC=gcc FC=gfortran F77=gfortran F90=gfortran FFLAGS=&quot;-O3 -g -em64&quot;&nbsp; CFLAGS=&quot;-O3 -em64&quot; --enable-openmp --with-internal-blas --with-internal-lapack --with-internal-fftw<br />
4) make all<br />
実行方法<br />
/usr/lib/openmpi/bin/mpirun -machinefile /home/*/hosts -np 2 /home/*/espresso-4.3.2/bin/pw.x &lt;atom.in&gt; atom.out<br />
<br />
◇ 並列化<br />
OpenMPI<br />
1) tar zxvf expresso-4.3.2.tar.gz<br />
2) cd expresso-4.3.2<br />
3) ./configure MPIF90=/usr/local/openmpi/bin/mpif90 CXX=g++ CC=gcc FC=gfortran F77=gfortran F90=gfortran BLAS_LIBS=&quot;-L/usr/lib -lblas&quot; LAPACK_LIBS=&quot;-L/usr/lib -llapack&quot; FFT_LIBS=&quot;-L/usr/lib -lfftw3&quot;<br />
4) make all<br />
実行方法<br />
/usr/lib/openmpi/bin/mpirun -machinefile /home/*/hosts -np 2 /home/*/espresso-4.3.2/bin/pw.x &lt;atom.in&gt; atom.out<br />
<br />
◆ Intel Compiler をインストールする場合（学生様向け）<br />
◇ 並列化<br />
OpenMP（初心者向け用メモ）<br />
0) sudo apt-get install liblapack-dev<br />
&nbsp;&nbsp;&nbsp;&nbsp;sudo apt-get install fftw-dev<br />
1) tar zxvf expresso-4.3.2.tar.gz<br />
2) cd expresso-4.3.2<br />
3) ./configure CXX=g++ CC=gcc FC=ifort F77=ifort F90=ifort --enable-openmp --with-internal-blas --with-internal-lapack FFT_LIBS=&quot;-L/usr/lib -lfftw&quot; FFLAGS=&quot;-O2 -assume byterecl -g -traceback -par-report0 -vec-report0 -axSSE4.2,SSE4.1,SSSE3,SSE3 -mcmodel=large -i-dynamic -no-ipo&quot;<br />
4) make all<br />
実行方法<br />
/home/*/espresso-4.3.2/bin/pw.x &lt;atom.in&gt; atom.out にて計算が成功する。<br />
※ mpi に関するエラーが出る場合は、MPI_LIBS=&quot; &quot; とすると良い。<br />
<br />
OpenMP（初級者向け用メモ）<br />
1) tar zxvf expresso-4.3.2.tar.gz<br />
2) cd expresso-4.3.2<br />
3) ./configure CXX=icpc CC=icc FC=ifort F77=ifort F90=ifort --enable-openmp BLAS_LIBS=&quot;-L/opt/intel/Compiler/11.0/084/mkl/lib/em64t&nbsp;-lmkl_intel_lp64&nbsp;-lmkl_intel_thread -lmkl_core -lifcore -lguide -lpthread -lsvml&quot; LAPACK_LIBS=&quot;-lmkl_lapack&quot; --with-internal-fftw FFLAGS=&quot;-O2 -assume byterecl -g -traceback -par-report0 -vec-report0 -axSSE4.2,SSE4.1,SSSE3,SSE3 -mcmodel=large -i-dynamic&nbsp;-no-ipo&quot;<br />
4) make all<br />
実行方法<br />
/home/*/espresso-4.3.2/bin/pw.x &lt;atom.in&gt; atom.out にて計算が成功する。<br />
※ mpi に関するエラーが出る場合は、MPI_LIBS=&quot; &quot; とすると良い。<br />
<br />
OpenMP（中級者向け用メモ）<br />
1) tar zxvf expresso-4.3.2.tar.gz<br />
2) cd expresso-4.3.2<br />
3) ./configure CXX=icpc CC=icc FC=ifort F77=ifort F90=ifort --enable-openmp BLAS_LIBS=&quot;-L/opt/intel/Compiler/11.0/084/mkl/lib/em64t -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core -lifcore -lguide -lpthread -lsvml&quot; LAPACK_LIBS=&quot;-lmkl_lapack&quot;&nbsp;FFT_LIBS=&quot;-L/usr/local/lib -lfftw3&quot;&nbsp;FFLAGS=&quot;-O2 -assume byterecl -g -traceback -par-report0 -vec-report0 -axSSE4.2,SSE4.1,SSSE3,SSE3 -mcmodel=large&nbsp;-i-dynamic&nbsp;-no-ipo&quot;<br />
4) make all<br />
実行方法<br />
/home/*/espresso-4.3.2/bin/pw.x &lt;atom.in&gt; atom.out にて計算が成功する。<br />
※ mpi に関するエラーが出る場合は、MPI_LIBS=&quot; &quot; とすると良い。<br />
<br />
OpenMP（上級者向け用メモ: icc + ifort）<br />
1) tar zxvf expresso-4.3.2.tar.gz<br />
2) cd expresso-4.3.2<br />
3) ./configure CXX=icpc CC=icc FC=ifort F77=ifort F90=ifort --enable-openmp BLAS_LIBS=&quot;-lmkl_blas95&nbsp;-lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core -lifcore -lguide -lpthread -lsvml&quot; LAPACK_LIBS=&quot;-lmkl_lapack95&quot; FFT_LIBS=&quot;-lfftw3xf_intel&quot; FFLAGS=&quot;-O2 -assume byterecl -g -traceback -par-report0 -vec-report0 -axSSE4.2,SSE4.1,SSSE3,SSE3 -mcmodel=large&nbsp;-i-dynamic&nbsp;-no-ipo&quot;<br />
4) make all<br />
実行方法<br />
/home/*/espresso-4.3.2/bin/pw.x &lt;atom.in&gt; atom.out にて計算が成功する。<br />
※ mpi に関するエラーが出る場合は、MPI_LIBS=&quot; &quot; とすると良い。<br />
Reference: <a href="http://nitrogen14.blog51.fc2.com/blog-entry-36.html">http://nitrogen14.blog51.fc2.com/blog-entry-36.html</a><br />
<br />
OpenMP（上級者向け用メモ: gcc + ifort）<br />
1) tar zxvf expresso-4.3.2.tar.gz<br />
2) cd expresso-4.3.2<br />
3) ./configure CXX=g++ CC=gcc FC=ifort F77=ifort F90=ifort --enable-openmp BLAS_LIBS=&quot;-lmkl_blas95 -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core -lifcore -lguide -lpthread -lsvml&quot; LAPACK_LIBS=&quot;-lmkl_lapack95&quot; FFT_LIBS=&quot;-lfftw3xf_intel&quot; FFLAGS=&quot;-O2 -assume byterecl -g -traceback -par-report0 -vec-report0 -axSSE4.2,SSE4.1,SSSE3,SSE3 -mcmodel=large -i-dynamic -no-ipo&quot; CFLAGS=&quot;-O3 -em64&quot;<br />
4) make all<br />
実行方法<br />
/home/*/espresso-4.3.2/bin/pw.x &lt;atom.in&gt; atom.out にて計算が成功する。<br />
※ mpi に関するエラーが出る場合は、MPI_LIBS=&quot; &quot; とすると良い。<br />
Reference: http://nitrogen14.blog51.fc2.com/blog-entry-36.html<br />
<br />
◇ 並列化<br />
OpenMPI<br />
1) tar zxvf expresso-4.3.2.tar.gz<br />
2) cd expresso-4.3.2<br />
3) ./configure MPIF90=/usr/local/openmpi/bin/mpif90 CXX=g++ CC=gcc FC=ifort F77=ifort F90=ifort --with-internal-blas --with-internal-lapack --with-internal-fftw<br />
4) make all<br />
実行方法<br />
/usr/local/openmpi/bin/mpirun -machinefile /home/*/hosts -np 2 /home/*/espresso-4.3.2/bin/pw.x &lt;atom.in&gt; atom.out<br />
<br />
◇ 並列化<br />
OpenMPI<br />
1) tar zxvf expresso-4.3.2.tar.gz<br />
2) cd expresso-4.3.2<br />
3) ./configure MPIF90=/usr/local/openmpi/bin/mpif90 CXX=g++ CC=gcc FC=ifort F77=ifort F90=ifort --with-internal-blas --with-internal-lapack FFT_LIBS=&quot;-L/usr/local/lib -lfftw3 -lfftw3_mpi -lfftw3_threads&quot; FFLAGS=&quot;-O2 -assume byterecl -g -traceback -par-report0 -vec-report0 -axSSE4.2,SSE4.1,SSSE3,SSE3 -mcmodel=large -i-dynamic -no-ipo&quot; CFLAGS=&quot;-O3 -m64&quot;<br />
4) make all<br />
実行方法<br />
/usr/local/openmpi/bin/mpirun -machinefile /home/*/hosts -np 2 /home/*/espresso-4.3.2/bin/pw.x &lt;atom.in&gt; atom.out<br />
<br />
◇ 並列化<br />
OpenMPI　＋ OpenMP<br />
1) tar zxvf expresso-4.3.2.tar.gz<br />
2) cd expresso-4.3.2<br />
3) ./configure MPIF90=mpif90 CXX=g++ CC=gcc FC=ifort F77=ifort F90=ifort --enable-openmp --with-internal-blas --with-internal-lapack FFT_LIBS=&quot;-L/usr/local/lib -lfftw3 -lfftw3_mpi -lfftw3_threads -lfftw3_omp&quot; FFLAGS=&quot;-O2 -assume byterecl -g -traceback -par-report0 -vec-report0 -axSSE4.2,SSE4.1,SSSE3,SSE3 -mcmodel=large -i-dynamic -no-ipo&quot; CFLAGS=&quot;-O3 -m64&quot;<br />
4) make all<br />
実行方法<br />
/usr/local/openmpi/bin/mpirun -machinefile /home/*/hosts -np 2 /home/*/espresso-4.3.2/bin/pw.x &lt;atom.in&gt; atom.out<br />
<br />
◇ 並列化<br />
OpenMPI ＋ OpenMP + MKL<br />
1) tar zxvf expresso-4.3.2.tar.gz<br />
2) cd expresso-4.3.2<br />
3) ./configure MPIF90=mpif90 CXX=g++ CC=gcc FC=ifort F77=ifort F90=ifort --enable-openmp BLAS_LIBS=&quot;-L/opt/intel/Compiler/11.0/084/mkl/lib/em64t -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core -lifcore -lguide -lpthread -lsvml&quot; LAPACK_LIBS=&quot;-lmkl_lapack&quot; FFT_LIBS=&quot;-L/usr/local/lib -lfftw3 -lfftw3_mpi -lfftw3_threads -lfftw3_omp&quot; FFLAGS=&quot;-O2 -assume byterecl -g -traceback -par-report0 -vec-report0 -axSSE4.2,SSE4.1,SSSE3,SSE3 -mcmodel=large -i-dynamic -no-ipo&quot; CFLAGS=&quot;-O3 -m64&quot;<br />
4) make all<br />
※ この条件で check-pw.x.j を走らせると、551.5 s　(Core i7-2600K) となった。Reference が 851.06 なので約1.5倍の速度。<br />
実行方法<br />
1) export OMP_NUM_THREADS=2 を .bashrc に書き入れる。<br />
2)&nbsp;/usr/local/openmpi/bin/mpirun -machinefile /home/*/hosts -np&nbsp;4 /home/*/espresso-4.3.2/bin/pw.x &lt;atom.in&gt; atom.out<br />
以上で、4 CPU * 2 threads = 8 processor cores の動作となる。<br />
<br />
<a href="http://users.aims.ac.za/~sandro/files/tutorial_para.pdf">http://users.aims.ac.za/~sandro/files/tutorial_para.pdf</a><br />
<a href="http://www.hpcadvisorycouncil.com/pdf/ESPRESSO_Best_Practices.pdf">http://www.hpcadvisorycouncil.com/pdf/ESPRESSO_Best_Practices.pdf</a><br />
<a href="http://conquer-ur-computer.blogspot.jp/2010/12/install-quantum-espresso-in-ubuntu.html">http://conquer-ur-computer.blogspot.jp/2010/12/install-quantum-espresso-in-ubuntu.html</a>&nbsp;<br />
------------------------------------------------------------------------------<br />
第一原理計算のセットアップ CPMD<br />
◆ gfortran の場合（業者様向け &amp; 学生様向け）<br />
◇ 並列化<br />
<br />
CPMD setup<br />
1) download CPMD : http://cpmd.org/<br />
2) tar zxvf cpmd-v3_15_1.tgz<br />
3) cd CPMD<br />
4) CONFIGUREの中から適した環境のファイル名を探す<br />
&nbsp; ./mkconfig.sh LINUX-i686-FEDORA-MPI &gt; Makefile<br />
&nbsp; Makefile において<br />
&nbsp; LFLAGS=&#39;-L/usr/lib/ -llapack -lblas -lfftw&#39;<br />
&nbsp; CC = /usr/local/openmpi/bin/mpicc<br />
&nbsp; FC = /usr/local/openmpi/bin/mpif77<br />
&nbsp; LD = /usr/local/openmpi/bin/mpif77<br />
&nbsp; CPPFLAGS = -D__Linux -D__PGI -D__GNU -DFFT_FFTW -DPARALLEL -DMYRINET<br />
&nbsp; mpifcc を /usr/local/openmpi/bin/mpicc へ<br />
&nbsp; mpif77 を /usr/local/openmpi/bin/mpif90 へ<br />
5) make<br />
References<br />
[1] <a href="https://extras.csc.fi/chem/courses/cpmd/terminal-intro.pdf">https://extras.csc.fi/chem/courses/cpmd/terminal-intro.pdf</a><br />
<br />
◆ Intel Compiler をインストールする場合（学生様向け）<br />
◇ 並列化<br />
CPMD setup<br />
1) download CPMD : http://cpmd.org/<br />
2) tar zxvf cpmd-v3_15_1.tgz<br />
3) cd CPMD<br />
4) CONFIGUREの中から適した環境のファイル名を探す<br />
5) ./mkconfig.sh PC-IFC-MPI &gt; Makefile<br />
&nbsp; Makefile において<br />
&nbsp; FFLAGS で -axM -tpp6 を削除<br />
&nbsp; LFLAGS = -L/home/*/intel/*/mkl/lib/ia32 -lmkl_blas95 -lmkl_lapack95 -lmkl_intel -lmkl_intel_thread -lmkl_core -lifcore -lguide -lpthread -lsvml -L/usr/lib -lfftw -lfftw_mpi<br />
mpif77 を /usr/local/openmpi/bin/mpif90 へ<br />
5) make<br />
References<br />
[1] <a href="https://extras.csc.fi/chem/courses/cpmd/terminal-intro.pdf">https://extras.csc.fi/chem/courses/cpmd/terminal-intro.pdf</a><br />
<br />
------------------------------------------------------------------------------<br />
第一原理計算のセットアップ ABINIT<br />
◆ gfortran の場合（業者様向け &amp; 学生様向け）<br />
◇ 並列化<br />
MPICH2<br />
1) tar zxvf abinit-6.8.1.tar.gz<br />
2) cd abinit-6.8.1<br />
3) ./configure CC=gcc FC=mpif90 --enable-gw-cutoff --enable-gw-dpc --enable-gw-optimal --enable-gw-wrapper --enable-vdwxc --enable-mpi LDFLAGS=-L/usr/lib LIBS=&quot;-llapack -lblas -lfftw3&quot; --with-trio-flavor=&quot;none&quot; --with-dft-flavor=&quot;none&quot;<br />
4) make multi multi_nprocs=2<br />
5) make install<br />
6) mpirun -machinefile /home/*/hosts -np 2 abinit &lt;case.files&gt; case.log<br />
<br />
◆ gfortran の場合（業者様向け &amp; 学生様向け）<br />
◇ 並列化<br />
OpenMPI<br />
1) tar zxvf abinit-6.12.3.tar.gz<br />
2) cd abinit-6.12.3<br />
3) ./configure --enable-gw-cutoff --enable-gw-dpc --enable-gw-optimal --enable-gw-wrapper --enable-vdwxc --enable-mpi CC=gcc FC=/usr/bin/mpif90.openmpi LDFLAGS=&quot;-L/usr/lib&quot; LIBS=&quot;-llapack -lblas&quot; --enable-64bit-flags --enable-bse-unpacked --with-atompaw-bins<br />
4) make multi multi_nprocs=2<br />
5) sudo make install<br />
6) /usr/bin/mpirun.openmpi -machinefile /home/*/hosts -np&nbsp;4 abinit &lt;case.files&gt; case.log<br />
<br />
◇ 並列化<br />
OpenMPI<br />
1) tar zxvf abinit-6.8.1.tar.gz<br />
2) cd abinit-6.8.1<br />
3) ./configure --enable-gw-cutoff --enable-gw-dpc --enable-gw-optimal --enable-gw-wrapper --enable-vdwxc --enable-mpi CC=icc FC=/usr/lib/openmpi/bin/mpif90 LDFLAGS=&quot;-L/usr/lib&quot; LIBS=&quot;-llapack -lblas&quot; --with-trio-flavor=&quot;none&quot; --with-trio-flavor=&quot;none&quot; --with-dft-flavor=&quot;none&quot;<br />
4) make multi multi_nprocs=2<br />
5) make install<br />
6) /usr/lib/openmpi/bin/mpirun -machinefile /home/*/hosts -np 2 abinit &lt;case.files&gt; case.log<br />
<br />
◆ Intel Compiler をインストールする場合（学生様向け）<br />
◇ 並列化<br />
OpenMPI<br />
1) tar zxvf abinit-6.8.1.tar.gz<br />
2) cd abinit-6.8.1<br />
3) ./configure --enable-gw-cutoff --enable-gw-dpc --enable-gw-optimal --enable-gw-wrapper --enable-vdwxc --enable-mpi CC=icc FC=/usr/local/openmpi/bin/mpif90 LDFLAGS=&quot;-L/home/*/intel/*/mkl/lib/em64t&quot; LIBS=&quot;-lmkl_intel -lmkl_sequential -lmkl_core -lpthread&quot; --with-trio-flavor=&quot;none&quot; --with-dft-flavor=&quot;none&quot; --prefix=/home/user_name/abinit-6.8.1<br />
4) make multi multi_nprocs=2<br />
5) make install<br />
6) /usr/local/openmpi/bin/mpirun -machinefile /home/*/hosts -np 2 /home/*/abinit-6.8.1/bin/abinit &lt;case.files&gt; case.log<br />
<br />
Abinit Band Structure maker<br />
1) cd /home/*/abinit-6.8.1/util/users<br />
2) python AbinitBandStructureMaker.py case.out<br />
3) python AbinitBandStructureMaker.py case.out.dbs<br />
4) xmgrace case.out.dbs.agr<br />
※ manual : /home/*/abinit-6.8.1/doc/users<br />
<br />
EXC （準備中）<br />
OpenMPI<br />
1) tar zxvf<br />
2) cd<br />
3) ./configure F90=mpif90 F90FLAGS=&quot;-O2&quot; CC=gcc --with-fftw3=&quot;/usr/lib/libfftw3.a&quot; --with-blas=&quot;/usr/lib/libblas.a&quot; --with-lapack=&quot;/usr/lib/liblapack.a&quot;<br />
4) make<br />
5) make tests<br />
6) make install<br />
<br />
DP （準備中）<br />
OpenMPI<br />
1) tar zxvf<br />
2) cd<br />
3) ./configure<br />
4) make<br />
5) make tests<br />
6) make install<br />
<br />
BigDFT （準備中）<br />
OpenMPI<br />
1) tar zxvf /home/*/Downloads/bigdft-1.5.2.tar.gz<br />
2) cd bigdft-1.5.2<br />
◆ gfortranの場合　（gfortran でBLAS, LAPACKをコンパイルすることが必要)<br />
3) ./configure CXX=g++ CC=gcc F77=gfortran FC=mpif90.openmpi FCFLAGS=&quot;-fbounds-check -O2 -Wall&quot; --with-ext-linalg=&quot;-llapack -lblas&quot; --with-ext-linalg-path=&quot;-L/usr/lib&quot; --with-libabinit-path=&quot;/home/*/abinit-6.8.1/lib&quot;<br />
◆ Intel Fortran Compilerの場合<br />
3) ./configure CXX=icpc CC=icc F77=ifort FC=/usr/local/openmpi/bin/mpif90 FCFLAGS=&quot;-O2&quot; --with-ext-linalg=&quot;-lmkl_intel -lmkl_sequential -lmkl_core -lpthread&quot; --with-ext-linalg-path=&quot;-L/home/*/intel/*/mkl/lib/ia32&quot; --with-libabinit-path=&quot;/home/*/abinit-6.8.1/lib&quot;<br />
4) make<br />
5) cd tests<br />
6) export run_parallel=&#39;mpirun -np 2&#39;<br />
7) make check<br />
8) cd ..<br />
9) sudo make install<br />
※ --with-libabinit-path=&quot;/home/*/abinit-6.8.1/lib&quot; は無い方が良いかもしれない。<br />
<br />
BigDFT （version 1.6.0）<br />
OpenMPI<br />
1) tar zxvf /home/*/Downloads/bigdft-1.6.0.tar.gz<br />
2) cd bigdft-1.5.2<br />
◆ gfortranの場合1<br />
3) ./configure&nbsp;CC=gcc&nbsp;CXX=g++&nbsp;F77=gfortran FC=mpif90.openmpi CFLAGS=&quot;-g -O2 -m64&quot; CXXFLAGS=&quot;-g -O2 -m64&quot; FCFLAGS=&quot;-g -O2 -m64&quot; FFLAGS=&quot;-g -O2 -m64&quot; --enable-minima-hopping --enable-dgemmsy<br />
◆ gfortranの場合2<br />
3) ./configure CC=&quot;gcc -m64&quot;&nbsp;CXX=&quot;g++ -m64&quot;&nbsp;F77=&quot;gfortran-m64&quot; FC=&quot;mpif90.openmpi -m64&quot; --enable-minima-hopping --enable-dgemmsy<br />
4) make<br />
5) cd tests<br />
6) export run_parallel=&#39;mpirun -np 2&#39;<br />
7) make check<br />
8) cd ..<br />
9) sudo make install<br />
※ --with-libabinit-path=&quot;/home/*/abinit-6.8.1/lib&quot; は無い方が良いかもしれない。<br />
------------------------------------------------------------------------------<br />
第一原理計算のセットアップ Yambo<br />
◆ gfortran の場合（業者様向け &amp; 学生様向け）<br />
（NetCDF無しの場合）　（*はユーザー名にして下さい）<br />
(/home/centos5/PWscfでexpresso-4.3.2を解凍した場合)<br />
1) tar zxvf yambo-3.2.4-rev.17.tar.gz<br />
2) cd yambo-3.2.4-r.855<br />
3) ./configure F77=gfortran FC=gfortran F90=gfortran MPIF=/usr/local/openmpi/bin/mpif90 MPICC=/usr/local/openmpi/bin/mpicc --with-iotk=&#39;/home/*/espresso-4.3.2/iotk&#39; --with-p2y=4.0<br />
4) make yambo interfaces ypp<br />
5) [X] PW (4.0) supportかを確認する。<br />
<br />
◆ Intel Compiler をインストールする場合（学生様向け）<br />
（NetCDF無しの場合）（*はユーザー名にして下さい）<br />
(/home/centos5/PWscfでexpresso-4.3.2を解凍した場合)<br />
1) tar zxvf yambo-3.2.4-rev.17.tar.gz<br />
2) cd yambo-3.2.4-r.855<br />
3) ./configure F77=ifort FC=ifort F90=ifort MPIF=/usr/local/openmpi/bin/mpif90 MPICC=/usr/local/openmpi/bin/mpicc --with-iotk=&#39;/home/*/espresso-4.3.2/iotk&#39; --with-p2y=4.0<br />
4) make yambo interfaces ypp<br />
5) [X] PW (4.0) supportかを確認する。<br />
<br />
------------------------------------------------------------------------------<br />
第一原理計算のセットアップ SPRKKR<br />
◆ gfortran の場合（業者様向け &amp; 学生様向け）<br />
<br />
◇ 並列化<br />
OpenMPI （下記で試したが、エラーが出る。コード自体を書き換えないと修正が無理のように思えた）<br />
1) tar zxvf PUB*<br />
2) 並列化のソフトによって下記のようにmake.incを書き換える<br />
&nbsp; LIB = -L/usr/local/lib -lblas -llapack -lpthread<br />
&nbsp; INCLUDE = -I/usr/local/openmpi/include<br />
&nbsp; FFLAGS = -O3<br />
&nbsp; FC = /usr/local/openmpi/bin/mpif90 -c $(FFLAGS) $(INCLUDE)<br />
&nbsp; LINK = /usr/local/openmpi/bin/mpif90 $(FFLAGS) $(INCLUDE)<br />
3) make scfmpi　（並列化しない場合は、make scf)<br />
&nbsp; 上記の作業で binary が作成される。PCが 4 core の場合は下記となる<br />
&nbsp; mpirun -np 4 kkrscf5.4MPI INPUT&gt;OUTPUT<br />
4) この他にもプログラムを作成することができる<br />
a) make all<br />
&nbsp; gen, scf, embgen, embscf が作成される<br />
b) make allmpi<br />
&nbsp; scfmpi, embscfmpi, specmpi が作成される<br />
c) Makefile を見ると一応下記のコマンドがある<br />
&nbsp; make genmpi, make embscfmpi, make chi,<br />
&nbsp; make opm, make opmmpi, make spec<br />
5) 再度コンパイルする場合には、make clean を用いる<br />
<a href="http://linux.die.net/man/1/gfortran">http://linux.die.net/man/1/gfortran</a><br />
<br />
<br />
◆ Intel Compiler をインストールする場合（学生様向け）<br />
◇ 並列化<br />
OpenMPI の場合<br />
1) tar zxvf PUB*<br />
2) 並列化のソフトによって下記のようにmake.incを書き換える<br />
&nbsp; LIB = -L/home/*/intel/*/mkl/lib/ia32 -lmkl_intel -lmkl_sequential -lmkl_core -lpthread<br />
&nbsp; INCLUDE = -I/usr/local/openmpi/include<br />
&nbsp; FC = /usr/local/openmpi/bin/mpif90 -c $(FFLAGS) $(INCLUDE)<br />
&nbsp; LINK = /usr/local/openmpi/bin/mpif90 $(FFLAGS) $(INCLUDE)<br />
3) make scfmpi　（並列化しない場合は、make scf)<br />
&nbsp; 上記の作業で binary が作成される。PCが 4 core の場合は下記となる<br />
&nbsp; mpirun -np 4 kkrscf5.4MPI INPUT&gt;OUTPUT<br />
4) この他にもプログラムを作成することができる<br />
a) make all<br />
&nbsp; gen, scf, embgen, embscf が作成される<br />
b) make allmpi<br />
&nbsp; scfmpi, embscfmpi, specmpi が作成される<br />
c) Makefile を見ると一応下記のコマンドがある<br />
&nbsp; make genmpi, make embscfmpi, make chi,&nbsp;<br />
&nbsp; make opm, make opmmpi, make spec<br />
5) 再度コンパイルする場合には、make clean, make reset を用いる<br />
よく分からなければ、再度コンパイルする前に make clean を入力しておけばよい。<br />
<br />
◇ 並列化<br />
OpenMPI +Scalapack の場合<br />
1) tar zxvf PUB*<br />
2) 並列化のソフトによって下記のようにmake.incを書き換える<br />
&nbsp; LIB = -L/home/centos6/intel/composerxe-2011.4.191/mkl/lib/ia32 -lmkl_intel -lmkl_scalapack_core -lmkl_blacs_openmpi -lmkl_solver -lmkl_sequential -lmkl_core -lmkl_cdft_core -lpthread<br />
&nbsp; INCLUDE = -I/usr/local/openmpi/include<br />
&nbsp; FC = /usr/local/openmpi/bin/mpif90 -c $(FFLAGS) $(INCLUDE)<br />
&nbsp; LINK = /usr/local/openmpi/bin/mpif90 $(FFLAGS) $(INCLUDE)<br />
3) make scfmpi　（並列化しない場合は、make scf)<br />
&nbsp; 上記の作業で binary が作成される。PCが 4 core の場合は下記となる<br />
&nbsp; mpirun -np 4 kkrscf5.4MPI INPUT&gt;OUTPUT<br />
4) この他にもプログラムを作成することができる<br />
a) make all<br />
&nbsp; gen, scf, embgen, embscf が作成される<br />
b) make allmpi<br />
&nbsp; scfmpi, embscfmpi, specmpi が作成される<br />
c) Makefile を見ると一応下記のコマンドがある<br />
&nbsp; make genmpi, make embscfmpi, make chi,<br />
&nbsp; make opm, make opmmpi, make spec<br />
5) 再度コンパイルする場合には、make clean, make reset を用いる<br />
よく分からなければ、再度コンパイルする前に make clean を入力しておけばよい。<br />
参考文献：<a href="http://ebert.cup.uni-muenchen.de/index.php?option=com_remository&amp;Itemid=4&amp;func=startdown&amp;id=155&amp;lang=de">http://ebert.cup.uni-muenchen.de/index.php?option=com_remository&amp;Itemid=4&amp;func=startdown&amp;id=155&amp;lang=de</a><br />
<br />
------------------------------------------------------------------------------<br />
第一原理計算のセットアップ WIEN2k<br />
◆ gfortran の場合（業者様向け &amp; 学生様向け）<br />
◇ 並列化<br />
1) tar -xvf WIEN2k_11.tar<br />
2) gunzip *.gz<br />
3) chmod +x ./expand_lapw<br />
4) ./expand_lapw<br />
5) ./siteconfig_lapw<br />
6) V gfortran + gotolib を選択<br />
7) gfortran, gcc を入力<br />
8)&nbsp;oを押して、-ffree-form -O2 -m64 -ffree-line-length-none<br />
&nbsp; r を押して、-llapack_lapw -lblas_lapw -lblas -llapack<br />
&nbsp; l を押して、$(FOPT) -L../SRC_lib<br />
9) shared Memory Architecture? (y/n): y<br />
10) ./userconfig_lapw<br />
11) bash<br />
12) w2web<br />
<br />
◆ gfortran + Intel MKLの場合（業者様向け &amp; 学生様向け）<br />
◇ 並列化<br />
OpenMPI<br />
1) tar -xvf WIEN2k_11.tar<br />
2) gunzip *.gz<br />
3) chmod +x ./expand_lapw<br />
4) ./expand_lapw<br />
5) ./siteconfig_lapw<br />
6) V gfortran + gotolib を選択<br />
7) gfortran, gcc を入力<br />
8) O specify compiler options, BLAS and LAPACK<br />
&nbsp; O Compiler options: -ffree-form -O2 -m64 -ffree-line-length-none<br />
&nbsp; L Linker Flags: $(FOPT) -L$(MKLROOT)/lib/$(MKL_TARGET_ARCH) -pthread<br />
&nbsp; P Preprocessor flags &#39;-DParallel&#39;<br />
&nbsp; R R_LIB (LAPACK+BLAS): -lmkl_intel_lp64 -lmkl_lapack95_lp64 -lmkl_blas95_lp64 -lmkl_core -lmkl_sequential -lmkl_gf<br />
9) shared Memory Architecture? (y/n): y<br />
10) Do you have MPI and Scalapack installed and......(y/n): y<br />
&nbsp; Your compiler: /usr/lib/openmpi/bin/mpif90<br />
&nbsp; RP RP_LIB(SCALAPACK+PBLAS): -lmkl_scalapack_core -lmkl_solver -lmkl_blacs_openmpi -L/usr/lib -lfftw_mpi -lfftw $(R_LIBS)<br />
&nbsp; FP FPOPT(par.comp.options): -ffree-form -O2<br />
&nbsp; MP MPIRUN commando: mpirun -np _NP_ -machinefile _HOSTS_ _EXEC_<br />
11) ./userconfig_lapw<br />
12) bash<br />
13) w2web<br />
<br />
◆ Intel Compiler をインストールする場合（学生様向け）<br />
◇ 並列化<br />
OpenMP<br />
1) tar -xvf WIEN2k_11.tar<br />
2) gunzip *.gz<br />
3) chmod +x ./expand_lapw<br />
4) ./expand_lapw<br />
5) ./siteconfig_lapw<br />
6) ヴァージョンに合わせてI, J, K, K1 を選択（ここでは12 のIを選択してみる）<br />
7) ifort, icc を入力<br />
8) Current settings:<br />
&nbsp; O Compiler options: -FR -mp1 -w -prec_div -pc80 -pad -ip -DINTEL_VML -traceback&nbsp;-axSSE4.2,SSE4.1,SSSE3,SSE3<br />
&nbsp; L Linker Flags: $(FOPT) -L$(MKLROOT)/lib/$(MKL_TARGET_ARCH) -pthread<br />
&nbsp; P Preprocessor flags &#39;-DParallel&#39;<br />
&nbsp; R R_LIB (LAPACK+BLAS): -lmkl_lapack95_lp64 -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core -openmp -lpthread<br />
9) Shared Memory Architecture? (y/n): y<br />
10) Do you have MPI and Scalapack installed and......(y/n): n<br />
11) ./userconfig_lapw<br />
12) .bashrc を開いて、export OMP_NUM_THREADS= の後にスレッド数 を書き入れる。ここでは、export OMP_NUM_THREADS=4 とした。<br />
13) bash<br />
14) w2web<br />
参考HP : <a href="http://xinhuolin.web.officelive.com/Wien2kinUbuntu.aspx">http://xinhuolin.web.officelive.com/Wien2kinUbuntu.aspx</a><br />
参考文献 : <a href="http://www.ghfecher.de/Fecher_CompileIntel.pdf">http://www.ghfecher.de/Fecher_CompileIntel.pdf</a><br />
<br />
<br />
◇ 並列化<br />
OpenMPI<br />
1) tar -xvf WIEN2k_11.tar<br />
2) gunzip *.gz<br />
3) chmod +x ./expand_lapw<br />
4) ./expand_lapw<br />
5) ./siteconfig_lapw<br />
6) ヴァージョンに合わせてI, J, K, K1 を選択（ここでは 12 のIを選択する）<br />
7) ifort, icc を入力<br />
8) Current settings:<br />
&nbsp; O Compiler options: -FR -mp1 -w -prec_div -pc80 -pad -ip -DINTEL_VML -traceback<br />
&nbsp; L Linker Flags: $(FOPT) $(FOPT) -L$(MKLROOT)/lib/$(MKL_TARGET_ARCH) -pthread<br />
&nbsp; P Preprocessor flags &#39;-DParallel&#39;<br />
&nbsp; R R_LIB (LAPACK+BLAS): -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core -openmp -lpthread<br />
9) Shared Memory Architecture? (y/n): y<br />
10) Do you have MPI and Scalapack installed and......(y/n): y<br />
&nbsp; Your compiler: /usr/local/openmpi/bin/mpif90<br />
&nbsp; RP RP_LIB(SCALAPACK+PBLAS): -lmkl_scalapack_core -lmkl_solver -lmkl_blacs_openmpi -L/usr/local/lib -lfftw_mpi -lfftw $(R_LIBS)<br />
&nbsp; FP FPOPT(par.comp.options): $(FOPT) -FR -mp1 -w -prec_div -pc80 -pad -ip -DINTEL_VML -traceback<br />
11) ./userconfig_lapw<br />
12) bash<br />
13) w2web<br />
<br />
BoltzTraP<br />
1) tar xvf BoltzTraP_1.20.tar.bz2<br />
2) cd boltztrap-1.2.0<br />
3) cd src<br />
4) 解凍されたファイルで、src と書かれたファイルを開く<br />
5) Makefileを書き換える<br />
A) gfortran<br />
&nbsp; a) Netlib<br />
&nbsp;&nbsp;&nbsp; LDFLAGS = -L/usr/lib<br />
&nbsp;&nbsp;&nbsp; LIBS = -llapack -lblas<br />
&nbsp; b) ATLAS<br />
&nbsp;&nbsp;&nbsp; LDFLAGS = -L/usr/local/atlas/lib<br />
&nbsp;&nbsp;&nbsp; LIBS = -llapack_netlib_atlas -lblas_atlas -latlas<br />
&nbsp; c) GotoBLAS<br />
&nbsp;&nbsp;&nbsp; LDFLAGS = -L/usr/local/lib<br />
&nbsp;&nbsp;&nbsp; LIBS = -lgoto2 -lpthread<br />
B) Intel compiler　(調査中)<br />
&nbsp; FC = ifort<br />
&nbsp; FOPT = -FR -mp1 -w -prec_div -pc80 -pad -ip -DINTEL_VML<br />
&nbsp; LDFLAGS = $(FOPT) -L/home/*/intel/mkl/lib/ia32 -pthread -i-static<br />
&nbsp; LIBS = -lmkl_intel -lmkl_sequential -lmkl_core -lpthread<br />
6) make<br />
------------------------------------------------------------------------------<br />
第一原理計算のセットアップ exciting　（FLAPW）<br />
<br />
◆ gfortran の場合（業者様向け &amp; 学生様向け）<br />
◇ 並列化<br />
1) tar zxvf exciting.helium.2010.12.17.gz<br />
2) cd exciting<br />
3) make<br />
4) 5 gfortran を選択<br />
&nbsp; Enter the number of the platform that suites your system best: 5<br />
5) Build MPI binary ? yes<br />
&nbsp; Select the mechanism to include MPI interface variables<br />
&nbsp; 1 use MPI module (f90 interfaces) recommended if available<br />
&nbsp; にて 1 を入力<br />
6) Build SMP lib binary (yes/No) yes<br />
&nbsp; bin の中には、excitingmpi, excitingser が生成されている。<br />
<br />
◆ Intel Compiler をインストールする場合（学生様向け）<br />
◇ 並列化<br />
------------------------------------------------------------------------------<br />
第一原理計算のセットアップ CASINO<br />
◆ gfortran の場合（業者様向け &amp; 学生様向け）<br />
◇ 並列化<br />
CASINO（CASINO_v2.6_standard.tar.tar）<br />
1) tar zxvf CASINO*<br />
2) cd CASINO<br />
3) .bashrc にて下記を加える。QMC_ARCH ではREADME_ARCHから選択する。<br />
&nbsp; CASINO/arch/make.inc の中にも対応する名称が.inc付きで書かれている。<br />
&nbsp; export QMC_ARCH=&quot;linuxpc-gcc-parallel&quot;<br />
&nbsp; export PATH=$PATH:$HOME/CASINO/bin_qmc<br />
4) bash<br />
5) make<br />
<br />
◆ Intel Compiler をインストールする場合（学生様向け）<br />
◇ 並列化<br />
CASINO（CASINO_v2.6_standard.tar.tar）<br />
1) tar zxvf CASINO*<br />
2) cd CASINO<br />
3) .bashrc にて下記を加える。QMC_ARCH ではREADME_ARCHから選択する。<br />
&nbsp; CASINO/arch/make.inc の中にも対応する名称が.inc付きで書かれている。<br />
&nbsp; export QMC_ARCH=&quot;linuxpc-ifort-parallel&quot;<br />
&nbsp; export PATH=$PATH:$HOME/CASINO/bin_qmc<br />
4) bash<br />
5) make<br />
------------------------------------------------------------------------------<br />
ubuntuの利用には下記参考文献が役に立つかもしれない（未調査）。<br />
<a href="http://xenolith.image.coocan.jp/ubuntu_linux.html">http://xenolith.image.coocan.jp/ubuntu_linux.html</a><br />
------------------------------------------------------------------------------<br />
<br />
------------------------------------------------------------------------------<br />
<br />
ubuntu 11.10 でのセットアップ<br />
※　計算時にエラーが出る。ubuntu 11.10 か SSD か Compiler によるものなのかは不明。<br />
------------------------------------------------------------------------------<br />
1. index of /linux: <a href="http://ftp.riken.jp/Linux/">http://ftp.riken.jp/Linux/</a> （理研のHPよりOSをiso形式でダウンロード）<br />
2.&nbsp;「ubuntu-iso」&rarr;「ubuntu-iso」 &rarr;「CDs-Ubuntu/」&rarr;「11.10/」&rarr;「ubuntu-11.10-beta2-desktop-amd64.iso」をダウンロードしてCDに焼く<br />
------------------------------------------------------------------------------<br />
sudo apt-get install csh<br />
sudo apt-get install g++<br />
sudo apt-get install libstdc++5<br />
sudo apt-get install kwrite<br />
sudo apt-get install emacs<br />
sudo apt-get install gnuplot<br />
sudo apt-get install rpm<br />
------------------------------------------------------------------------------<br />
Intel Compiler の導入<br />
1. tar zxvf parallel_studio_xe_2011_sp1_intel64_tgz<br />
2. cd parallel_studio_xe_2011_sp1_intel64<br />
3. Enterを入力<br />
4. sudo ./install.sh<br />
5. 「1. skip prerequisites」 で Enterを入力<br />
6. spaceを入力し続けた後、accept を入力<br />
7. 「3. I want to activate either remotely, or by ........」の3を入力<br />
8. 「2. Use a license file」の2を入力<br />
9. license file の 絶対パス を入力(New Terminal で新しいTerminal を開いて、ライセンスファイルをそこに入れると絶対パスが分かる。&#39; &#39; の間に記されている絶対パスをコピー&amp;ペーストすればよい)<br />
10. この後は最後まで Enter を入力し続ければよい。<br />
------------------------------------------------------------------------------<br />
環境設定<br />
1. New Terminal で新しいターミナルを開く<br />
2. sudo kwrite ./bashrc<br />
3. ./bashrcで下記を書き込んでSAVEする<br />
&nbsp; source /opt/intel/bin/compilervars.sh intel64<br />
4. bash<br />
5. which ifort や which icc で参照場所、ifort -v や icc -v でversion情報が出れば成功<br />
------------------------------------------------------------------------------<br />
WIEN2kのセットアップ<br />
◆ Intel Compiler をインストールする場合（学生様向け）<br />
◇ 並列化<br />
OpenMP<br />
<br />
0) Create New Folder で新しいファイル（例えば WIEN2k_11 など）を作成し、WIEN2k_11.tar<br />
をその中にコピーし、新しいTerminalを開いて、cd WIEN2k_11 とする。<br />
1) tar -xvf WIEN2k_11.tar<br />
2) gunzip *.gz<br />
3) chmod +x ./expand_lapw<br />
4) ./expand_lapw<br />
5) ./siteconfig_lapw<br />
6) ヴァージョンに合わせてI, J, K, K1 を選択（ここでは12 のIを選択してみる）<br />
7) ifort, icc を入力<br />
8) Current settings:<br />
&nbsp; O Compiler options: -FR -mp1 -w -prec_div -pc80 -pad -ip -DINTEL_VML -traceback -axSSE4.2,SSE4.1,SSSE3,SSE3<br />
&nbsp; L Linker Flags: $(FOPT) -L$(MKLROOT)/lib/$(MKL_TARGET_ARCH) -pthread<br />
&nbsp; P Preprocessor flags &#39;-DParallel&#39;<br />
&nbsp; R R_LIB (LAPACK+BLAS): -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core -liomp5 -lpthread<br />
9) Shared Memory Architecture? (y/n): n<br />
&nbsp; この後には、rsh を選択してみた。<br />
10) Do you have MPI and Scalapack installed and......(y/n): n<br />
11) ./userconfig_lapw<br />
12) bash<br />
13) w2web<br />
※ ./userconfig_lapwの後、.bashrc を開いて、export OMP_NUM_THREADS= の後にスレッドの数 を書き入れる。ここでは消費電力との兼ね合いから最も効率的であると考えられる4スレッドでの並列計算とするため export OMP_NUM_THREADS=4 とした。<br />
参考HP : <a href="http://xinhuolin.web.officelive.com/Wien2kinUbuntu.aspx">http://xinhuolin.web.officelive.com/Wien2kinUbuntu.aspx</a><br />
参考文献 : <a href="http://www.ghfecher.de/Fecher_CompileIntel.pdf">http://www.ghfecher.de/Fecher_CompileIntel.pdf</a><br />
※ Dでの配列の大きさ設定には注意すること。OpenMP並列でもMPIと同様に、スレッド数で割った配列の大きさとすることが必要となる。<br />
※ 16GBしか搭載できないので、余裕を見て、NMATMAX=27000、NUME=2700とした。しかし、4スレッドで挑戦したところ、エラーが出たので、NMATMAX=28000/4=7000、NUME=7000/10=700 とした。これでもエラーが出た。原因調査中。<br />
計算式は以下の通り<br />
NMATMAX=&radic;(15 700 000 000 /10）/&radic;2=28017, NUME=NMATMAX/10=2800<br />
※ <a href="http://www.ghfecher.de/Fecher_CompileIntel.pdf">http://www.ghfecher.de/Fecher_CompileIntel.pdf</a>&nbsp;を見てSIGSEGV error の対処方法を調査中。<br />
※ 何回か試してもOpenMPが上手くいかない。<br />
------------------------------------------------------------------------------