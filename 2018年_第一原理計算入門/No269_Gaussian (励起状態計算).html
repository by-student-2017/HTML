------------------------------------------------------------------------------<br />
■ 励起状態 [2]<br />
　励起状態は、安定でかつより高いエネルギーを持った分子系の電子配置のことである。例えば、試料を紫外線や可視線分光器の線源で照射すると、このような状態が生成される。励起状態は、光化学や電子分光学などを含めて、化学の多くの領域に関係している。<br />
<br />
□&nbsp;励起状態の最適化と振動数<br />
　励起状態における系の構造最適化と振動数計算も、GaussianのCI-Singlesを使えば可能である。<br />
<br />
□&nbsp;励起状態の理論研究における重要な点<br />
・ 予測された値は、十分に高精度の実験結果と比較する必要がある。許容される遷移（0より大きな振動子強度）は、標準の一光子運光学データと比較する。しかし、禁制の遷移は多重光子実験と比較すべきである。系の励起状態の完全なキャラクタリゼーションを行なう前に、両方のタイプとも考慮する必要がある。<br />
・ 計算値と実測値を比べる時は、それぞれの励起状態の対称性を用いる必要がある。理論的な励起状態の順序が実験のそれと一致するとは限らない。Gaussianによると、ほとんどの場合、各励起状態の対称性を決定することができる。希にできない場合（ベンゼンがそうである）があるが、そのような場合は、遷移波動関数の係数と励起に関与している分子軌道とを自分で調べることによって決定することができる。<br />
------------------------------------------------------------------------------<br />
■&nbsp;励起状態計算法 [1]<br />
　Gaussianプログラムでは、以前からCIS, TD-HF, TD-DFTまた半経験的なZINDO法などによって励起状態の計算が可能であった。またGaussian 03ではCIS(D)、およびSAC/SAC-CIなどの励起状態計算法が新しく導入された。&nbsp;<br />
<br />
◇ SAC/SAC-CI法による励起状態計算<br />
　SAC-CI法ではあらかじめ計算する励起状態の対称性（既約表現）とそれぞれに属する励起状態の数を指定しておく必要がある。<br />
　さらにベンゼンのような分子の対称性がD6hのように、2次元以上の既約表現（E表現）などをもつ場合はあらかじめ1次元表現しか含まない低い対称性に置き直す必要がある。どのような対称性が、どのように置き換わるかはSAC-CI-GUIDE_050706.pdfのpp.27-29の対応表を参照のこと。<br />
------------------------------------------------------------------------------<br />
■ ベンゼンでの計算時間と結果の比較<br />
　SAC-CI: 3 hours 53 minutes 6.6 seconds. = 13986.6 sec<br />
　TDDFT: 0 hours 50 minutes 13.4 seconds. = 3013.4 sec<br />
　TDHFI: 0 hours 4 minutes 2.3 seconds. = 242.3 sec<br />
　CIS: 0 hours 8 minutes 17.1 seconds. = 497.1 sec<br />
　CIS(D): 0 hours 26 minutes 49.4 seconds. = 1609.4 sec<br />
※ SAC-CI法は、いずれの励起状態でも励起エネルギーが0.5 eV程度のエラーで一致している。CIS(D)もそれに近い結果を与える<br />
※ CIS(D)による計算結果は実測値とのずれがほぼ一定しており、適当にスケーリングすることで高精度の予測ができる可能性がある<br />
※ TDDFT(B3LYP)法は、上記の手法の中でもっとも再現性がよい。どのような場合でも良好な結果を与えるとは限らないことが知られている（例えば、ベンゼンでは三重項状態）<br />
※ TDDFT（B3LYP/6-31+G(d)）は&pi;共役系の広がりが大きくHOMO-LUMOギャップが小さい分子に対しては正しい結果を与えない。これは、DFTでは長距離相互作用を十分に取り入れられていないこと、1電子励起のみを扱っていることに起因すると考えられている。例えば、ヘキサセンでは三重項エネルギーが本来正の値であるべきものが負の値として出力されることが知られている。こういった場合には、CIS/6-31+G(d)など他の手法を用いて比較検討する必要がある<br />
------------------------------------------------------------------------------<br />
■&nbsp;入力ファイルの記述例 [1]<br />
<br />
□ TD-DFTの入力ファイル<br />
-----<br />
%chk=g03.chk<br />
#p TD (NStates=求める励起状態の数, スピン多重度） b3lyp/6-31+g(d) Density=SCF<br />
guess=read geom=checkpoint IOP(9/40=4)<br />
<br />
コメント<br />
<br />
0 1<br />
元素記号&nbsp;原子の座標（x, y, z）<br />
-----<br />
・ Density=SCFはポピュレーション解析を行う。基底状態のSCF densityを用いた値だけを与える<br />
・ IOP(9/40=N)とすると、軌道の係数が10-Nより大きい項が出力される。defaultではN=1<br />
<br />
□ CIS(D)<br />
-----<br />
%chk=g03.chk<br />
#p&nbsp;cis (d, NStates=求める励起状態の数）/6-31+g(d) Density guess=read<br />
geom=checkpoint IOP(9/40=4)<br />
<br />
コメント<br />
<br />
0 1<br />
元素記号 原子の座標（x, y, z）<br />
-----<br />
・ CISと異なり、Directオプションが使えない。このため、大きなディスクスペースが必要であり、Windows版では扱える分子の大きさがかなり制限される<br />
・ Densityはポピュレーション解析。励起状態のCI densityを求める<br />
<br />
□ ZINDO<br />
-----<br />
%chk=g03.chk<br />
#p&nbsp;ZINDO (d, NStates=求める励起状態の数, Window=(1,0)) guess=read geom=checkpoint<br />
IOP(9/40=4)<br />
<br />
コメント<br />
<br />
0 1<br />
元素記号 原子の座標（x, y, z）<br />
-----<br />
・ WindowはZINDO計算に用いる軌道の指定。この記述で全ての最外殻軌道を用いる。省いた場合は、HOMO-9からLUMO+9までの20軌道が用いられる。<br />
<br />
※ SAC-CIの入力ファイルについては文献[1]を参照ｊしてください<br />
-------------------------------------------------------------<br />
■ 出力ファイル[1,2]<br />
<br />
◇&nbsp;TD-DFTやCIS(D),&nbsp;ZINDOでの共通の出力部分（TD-HFやCISも同じ）<br />
&nbsp; Excited State 励起状態の番号： スピン多重度-対称　励起エネルギー　吸収波長　振動子強度<br />
　励起前の軌道 -&gt;&nbsp;励起後の軌道　励起状態を構成する分子軌道の係数（それぞれの励起に対する規格化された波動関数の係数）<br />
（※ ただし、CIS(D)はCIS計算結果の後に、補正した励起エネルギーと吸収波長が出力される）<br />
<br />
　上記の「対称」の部分で「?Sym」は、この状態について、その対称が決定できないことを示す。これは自分で決めなければならない。励起状態での分子の対称性は、軌道の配置が基底状態のものに対してどのように変化するかに関係している。群論より、全体の対称性は各軌道の対称性の積の関数であること、また不対電子の軌道のみが励起状態の対称性を決めるのに重要であることがわかっている（対を成している電子の軌道は、全対称である）。<br />
　個々の励起状態の対称性を決めるための近道として、全対称表現の表示から異なるものへ移るような励起を見つける。ベンゼンの点群に対しては、この全対称表現は、A<sub>1g&deg;</sub>励起状態のアウトプットにおけるpopulation解析のところの分子軌道のリストとともに、波動関数の係数の部分も一緒に用いる。<br />
　ここで重要なのは、遷移リストの中でA<sub>1g</sub>軌道を探すことである。励起する空軌道の対称性が、励起状態での対称性を与えてくれる。文献[2]の場合、軌道7がA1gの対称性を持ち、最初の励起状態についての最初のリストは、<br />
　7 -&gt; 35 ...<br />
軌道35を調べると、その対称性はB<sub>2u</sub>であり、この対称性をこの励起状態へ帰属する。この遷移の係数は非常に小さく、係数の範囲を大きく取るインプットのキーワードがなぜ必要なのか、ここでよくわかると思う。この遷移に対して軌道変化の特定な形を決めようとすると、この遷移における最大の波動関数係数で示されている、一番大きな成分の分子軌道を調べる必要がある。この場合、適切な遷移は、<br />
　20 -&gt; 22 ...<br />
これらの二つの軌道は、E<sub>1g</sub>とE<sub>2u</sub>の対称性をもつ。<br />
　標準配向から、分子面はXY面であることがわかる。両方の軌道ともp<sub>z</sub>成分だけで成っているので、これらは&pi;軌道である。よって、この励起状態は&pi; -&gt; &pi;<sup>*</sup>遷移に相当する。<br />
※ 基底状態SCF計算が終了した時点で出力ファイルに書き出される Occupied / Virtual 軌道の一覧から、軌道の対称性を読み取る。例えば、下記の部分が見つかる<br />
-----<br />
Making orbital integer symmetry assignments:<br />
Orbital Symmetries:<br />
&nbsp; Occupied (A1G) ...<br />
&nbsp; Virtual (E2U) ...<br />
-----<br />
　点群の掛け算表から励起状態の対称性を求める。励起状態を構成する遷移のうち、初状態と終状態の対称性がわかっていて、1価表現（A, Bなどを含むもの）で表される軌道から構成されるものを探す<br />
<br />
※ 論文などには、規格化された波動関数の係数ではなく、下記の式で得られる値を%として書いているものもある。<br />
　規格化された波動関数の係数 * 規格化された波動関数の係数 * 2 * 100 [%]<br />
　最後の2は、スピンのupとdownに由来する<br />
　GaussSumでも計算できる？<br />
参考文献: <a href="https://www.researchgate.net/post/How_to_calculate_the_contribution_of_the_electronic_transitions_from_a_theoretical_UV-Vis_spectrum_computed_by_TD-DFT_method_in_Gaussian">https://www.researchgate.net/post/How_to_calculate_the_contribution_of_the_electronic_transitions_from_a_theoretical_UV-Vis_spectrum_computed_by_TD-DFT_method_in_Gaussian</a>&nbsp;（&larr; URLではなくgoogleの検索でそのまま調べるとよい）<br />
<br />
◇ SAC-CI<br />
　excitation energy (au) = X.XXXX (eV) = X.XXXX<br />
　励起前の軌道 -&gt; 励起後の軌道 励起状態を構成する分子軌道の係数（それぞれの励起に対する波動関数の係数）<br />
<br />
　SECI(CIS)計算の結果。CISキーワードでの計算結果と基本的に同じ。CISキーワードでは配置の係数は0.5に規格化されているのに対して、ここでは1.0に規格化されている。<br />
------------------------------------------------------------------------------<br />
■ Q&amp;A [1]<br />
<br />
◇ SAC-CI<br />
<br />
Q1. 対称性の順番はどうしたらわかるのか<br />
A1. 通常の指標表とは異なっている場合があるので、一度小さい計算をして調べておいたほうがよい<br />
<br />
Q2. 最低一重項励起状態のみを計算するにはどうすればよいか<br />
A2. sac-ci(Singlet)と指定すれば、一重項のみを計算する。またnosymmを併用すれば対称性を無視するので、SAC基底状態とSAC-CI法で最低励起状態のみを計算する<br />
<br />
Q3. 対称性を指定すれば、計算時間を短くできるか<br />
A3. かなり短くできる。対称性が選べないときは、たとえば全部（1, 1, ,1 ,1, ...）と指定しておけば、少なくとも最低励起状態は拾える。また対称性がわからないときでも、nosymmでの計算は原理的には可能。しかし状態数を20などに指定した場合、計算の次元が大きくなるので実際に計算が可能かどうかはわからない<br />
<br />
Q4. 一重項（singlet）以外は、どのような計算が可能か<br />
A4. 三重項（triplet)、イオン化した二重項（doublet）などの計算が可能<br />
<br />
Q5. 二重項（doublet)の場合は、イオン化した状態をもとに計算するのか<br />
A5. 閉殻の一重項（singlet）状態からのイオン化として計算される。また閉殻の一重項（singlet）状態からの計算以外に、二重項（doublet）のROHF解を出発点にする方法も選べる<br />
<br />
Q6. Coupled-Cluster法で励起状態を求めるプログラムは他にあるのか<br />
A6. DALTON 2.0という北欧のグループの開発したプログラムができる。またフロリダ大学のBartlettからのACESIIなどができるとのことである<br />
<br />
SAC/SAC-CIについては、京都大学旧中辻研究室のホームページ<br />
<a href="http://www.sbchem.kyoto-u.ac.jp/nakatsuji-lab/">http://www.sbchem.kyoto-u.ac.jp/nakatsuji-lab/</a>　<br />
において、Gaussianのマニュアルに載っていないキーワードもすべて掲載されている。FAQも非常に有用である。<br />
<br />
◇ CIS(D)に関して<br />
<br />
Q1. CIS(D)法はどのくらい時間がかかるのか<br />
A1. 一つの励起状態で、基底状態におけるMP2法以上の時間がかかる。下から何個の励起状態を求めるかを選べるが、その個数倍の計算時間がかかる<br />
<br />
Q2. CIS(D)法で遷移モーメントが計算できないというのはマニュアルに記載されているのか<br />
A2. マニュアルには何も書かれていないが、これもSAC/SAC-CIと同じくGaussian 03で新しく導入されたものなので、入っていないと考えられる<br />
<br />
Q3. CIS(D)が停止する<br />
A3. &quot;Total=&quot;の値が負になっている場合は、作業ファイルの容量が不足している。Windows版の場合、Scratchフォルダ内のDefault.rouファイル中でMaxDisk=1 GBなどと指定し、作業ファイルのサイズを増やす。文献の環境では、ナフタセン、ピレン程度の分子までしか計算できていない。<br />
<br />
◇ その他<br />
<br />
Q1. SCFが収束しない<br />
A1. &pi;共役系が広がった分子や遷移金属錯体、開殻分子のSCFを行う場合、とくにdiffuse関数を含む基底を用いるとSCFが収束しないことがしばしばある。以下のような方法をとれば、ほとんどの場合SCFを収束させることができる。<br />
i) より小さい基底を用いて予備計算を行い、guess=read で checkpoint ファイルから結果を読み込ませる<br />
ii) SCF=(Fermi, NoIncFock) のオプションを付ける。ディフォルトよりもややSCFサイクルが増えるが、振動して収束しない場合に有効<br />
iii) SCF=(QC) のオプションを用いる。時間はディフォルトの数倍を要するが、もっとも確実に収束する<br />
<br />
Q2. 構造最適化が収束しない<br />
A2.<br />
i) 正しい構造よりも高い対称性で最適化を行っている可能性がある場合、NoSymキーワードを指定する。電荷分布・力の分布の対称性が最適化を行っている対称性と大きく異なっている場合、あるいは振動計算で大きな虚の振動数をもつモードが得られる場合は対称性を誤っている可能性が高い<br />
ii) opt=CalcFCのオプションを用いる<br />
<br />
Q3. 構造最適化が停止する（対称性が変化する場合）<br />
A3. 最終段階まで対称性を考慮しない最適化を行うか、対称性が確保されたopt=z-matrixで最適化を行う<br />
<br />
Q4. 励起状態計算が始まらない<br />
A4. Densityキーワードの指定を誤っていると、Gaussian 03 W の場合は計算初期にエラーメッセージを出して停止する。ZINDO は Density キーワードを指定できない。TDでは、Density=SCF以外を受け付けない<br />
------------------------------------------------------------------------------<br />
■ 分子構造の最適化<br />
<br />
a. 対称性を考慮した最適化のための入力<br />
　GaussView, CS Chem3Dなどのモデリングソフトを用いて作成した分子構造をもとに構造最適化しても、分子のあるべき対称性が得られないことがしばしば起こる。また、構造最適化の途中で分子の対称性が変ると、Gaussianの場合はエラーが出て停止する。<br />
　Z-マトリックスを用いて、考えられる対称性をもった初期構造を指定すればこれらの問題は回避できるが、ある程度の熟練を要する。下記の例に示すような入力ファイルを作成することにより、適切な対称性をもった最適化構造を得ることができる。<br />
-----<br />
%chk=g03.chk<br />
#p opt b3lyp/3-21G NoSymm<br />
<br />
コメント<br />
<br />
0 1<br />
元素記号 原子の座標（x, y, z）<br />
<br />
--Link1--<br />
%chk=g03.chk<br />
#p opt=tight b3lyp/3-21G Int=UltraFine guess=read<br />
geom=checkpoint NoSymm<br />
<br />
コメント<br />
<br />
0 1<br />
<br />
--Link1--<br />
%chk=g03.chk<br />
#p opt=tight b3lyp/6-31G(d) geom=checkpoint<br />
guess=read symmetry=loose<br />
<br />
コメント<br />
<br />
0 1<br />
-----<br />
入力は大きく三つの部分からなり(最初--Lin1--の前までがi)、最初の--Link1--から二つ目の--Link1--までがii), 二つ目の--Link1--から最後までがiii)となる)、それぞれ以下の計算が行われる。<br />
<br />
i) 対称性を考慮しない予備最適化<br />
　小さい基底関数を用い、NoSymmキーワードを用いて対称性を考慮しないSCFと構造最適化を行う。初期構造は低対称でよい。この段階で最適化構造に近い結果が得られるが、構造最適化の収束判定基準が甘いため、通常はより低い対称性の構造が得られる<br />
ii) 対称性を考慮しない精密最適化<br />
　i)で得られた構造を、geom=checkpoint で読み込む。これをもとに、Opt=Tightでより厳しい収束判定基準で構造最適化を行う。Opt=GDIIS としてもよい。Opt=Tightで密度汎関数法を用いる場合、計算精度を保証するため Int=UltraFine を指定する必要がある。構造最適化中に対称性が変化してエラーが生じないように、NoSymmを指定する<br />
iii) 対称性を考慮した構造最適化<br />
　ii)で得られた構造をもとに、Gaussianに対称性を判定させて最終的な構造最適化を行う。ii)の構造が対称構造からわずかに歪んでいる場合があるため、Symmetry=Looseで初期構造の対称性判定基準を緩やかにする。<br />
　この入力を作成する上で、以下の点について注意が必要である。<br />
・ 初期構造のひずみが大きすぎると、部分的な最適化構造しか得られないことがある。例えば、シクロヘキサンのアキシャル水素を残して初期構造とすると、水素が分子平面に垂直に位置し、炭素間の一重結合と二重結合が交代したD3d構造が得られる<br />
・ 対称性の異なるいくつかの最適化構造が考えられる場合、それぞれの構造に近い初期構造から出発する必要がある<br />
<br />
b. Z-マトリックスによる構造最適化<br />
・ opt=z-matrixを指定し、最適化に際して変数の値が変っても対称性が影響されないようにZ-マトリックスを構成する<br />
・ X0やX1とすることで、ダミー原子を用いて、目的の対称性をもつ構造を保存したりする方法もある<br />
・ 原子は&quot;元素記号+数字&quot;で指定する。名前が重複してもエラーなしで読み込まれることがあるので注意する<br />
・ Z-マトリックス中で結合角を0&deg;または180&deg;と設定することはできない。もし指定した場合は、エラーメッセージを表示してプログラムが停止する<br />
------------------------------------------------------------------------------<br />
■ 参考文献<br />
[1] 堀憲次「Gaussianプログラムによる量子化学計算マニュアル」新化学発展協会<br />
[2] 「電子構造論による化学の探求 第二版」 ガウシアン社<br />
[3] 「電子構造論による化学の探求 第三版」 ガウシアン社<br />
------------------------------------------------------------------------------